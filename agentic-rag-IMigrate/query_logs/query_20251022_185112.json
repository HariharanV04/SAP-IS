{
  "timestamp": "20251022_185112",
  "job_id": null,
  "iflow_name": "IFlow_dc087db1",
  "original_markdown": "# Create Salesforce Opportunities from Stripe Subscriptions Integration\r\n\r\n## Table of Contents\r\n- [API Overview](#api-overview)\r\n- [Endpoints](#endpoints)\r\n- [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n  - [Process Flow Overview](#process-flow-overview)\r\n  - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n- [Boomi Transformations Explained](#boomi-transformations-explained)\r\n- [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n  - [Component Mapping](#component-mapping)\r\n  - [Integration Flow Visualization](#integration-flow-visualization)\r\n  - [Configuration Details](#configuration-details)\r\n- [Environment Configuration](#environment-configuration)\r\n- [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration automatically creates Salesforce Opportunities when Stripe subscription events occur. The integration is designed to provide seamless synchronization between Stripe's subscription management system and Salesforce's opportunity tracking system.\r\n\r\n**Base URL Pattern:** Webhook-based integration receiving Stripe subscription events via HTTP listener\r\n\r\n**Authentication:** \r\n- Stripe webhook authentication\r\n- Salesforce OAuth authentication\r\n\r\n**Purpose:** Transform Stripe subscription completion events into Salesforce Opportunity records for sales tracking and revenue management\r\n\r\n**Response Format:** JSON responses from Salesforce API with success/error status\r\n\r\n## Endpoints\r\n\r\n### Stripe Webhook Receiver\r\n- **HTTP Method:** POST\r\n- **Path:** `/stripe/subscription/webhook`\r\n- **Purpose:** Receive subscription completion events from Stripe webhook\r\n- **Request Headers:**\r\n  - `Content-Type: application/json`\r\n  - `Stripe-Signature: [webhook signature]`\r\n- **Request Body:** Stripe subscription event payload in JSON format\r\n- **Response Format:** HTTP status codes (200 for success, error codes for failures)\r\n- **Error Handling:** Exception subprocess for webhook processing errors\r\n\r\n### Salesforce Opportunity Creation\r\n- **HTTP Method:** POST\r\n- **Path:** `/services/data/v[version]/sobjects/Opportunity`\r\n- **Purpose:** Create new Opportunity records in Salesforce\r\n- **Authentication:** OAuth Bearer token\r\n- **Request Body:** Salesforce Opportunity XML structure\r\n- **Response Format:** Salesforce API response with created record ID\r\n- **Error Handling:** Salesforce-specific error codes and messages\r\n\r\n## Current Boomi Flow Logic\r\n\r\n### Process Flow Overview\r\n\r\nThis Boomi process implements a webhook-driven integration pattern that:\r\n1. Listens for Stripe subscription completion events via HTTP webhook\r\n2. Extracts subscription and customer information from the event payload\r\n3. Calculates dynamic properties including customer name, subscription details, and close date\r\n4. Transforms the JSON webhook data into Salesforce Opportunity XML format\r\n5. Creates the new Opportunity record in Salesforce\r\n6. Handles errors through exception processing\r\n\r\nThe integration ensures real-time synchronization between Stripe subscriptions and Salesforce opportunities, enabling sales teams to track subscription-based revenue immediately when customers complete their subscriptions.\r\n\r\n### Step-by-Step Flow Description\r\n\r\n---\r\n\r\n#### **Step 1: Start Event (shape1)**\r\n\r\n**Component Type:** Start Event\r\n\r\n**Purpose:** HTTP webhook listener that receives Stripe subscription completion events\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** HTTP Listener (Inbound webhook)\r\n- **Operation:** Listen for incoming POST requests from Stripe\r\n- **Input Profile:** JSON payload structure from Stripe subscription events\r\n- **Trigger Conditions:** Stripe subscription.completed webhook events\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook JSON payload containing subscription and customer data\r\n- **Processing:** HTTP request validation and initial payload processing\r\n- **Output:** Parsed webhook data ready for property extraction and transformation\r\n\r\n---\r\n\r\n#### **Step 2: Document Properties (shape6)**\r\n\r\n**Component Type:** Document Properties\r\n\r\n**Purpose:** Set dynamic properties for customer name, subscription details, Salesforce description, and close date calculation\r\n\r\n**Configuration Details:**\r\n\r\n- **Dynamic Properties:** 4 dynamic document properties configured\r\n  - Dynamic Document Property - DDP_CustomerName: Process property: Dynamic Document Property - DDP_CustomerName\r\n  - Dynamic Document Property - DDP_Subscription: Process property: Dynamic Document Property - DDP_Subscription  \r\n  - Dynamic Document Property - DDP_SalesforceDescription: Process property: Dynamic Document Property - DDP_SalesforceDescription\r\n  - Dynamic Document Property - DDP_CloseDate: Process property: Dynamic Document Property - DDP_CloseDate\r\n- **Calculations:** Extract customer information, subscription details, and calculate opportunity close date\r\n- **Parameter Mappings:** Source value configurations from incoming Stripe webhook payload\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook JSON data\r\n- **Processing:** Property calculations and data enhancement for Salesforce opportunity creation\r\n- **Output:** Enhanced data with calculated properties for customer name, subscription info, description, and close date\r\n\r\n---\r\n\r\n#### **Step 3: Transform/Map Component (shape4)**\r\n\r\n**Component Type:** Map/Transform\r\n\r\n**Purpose:** Transform Stripe subscription JSON data into Salesforce Opportunity XML format\r\n\r\n**Configuration Details:**\r\n\r\n- **Input Profile:** Subscription Completed JSON structure\r\n- **Output Profile:** SF Opportunity CREATE Request XML structure\r\n- **Transformation Logic:** JSON to XML conversion with field mapping and property injection\r\n- **Function Steps:** DocumentPropertyGet functions for dynamic property retrieval\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook JSON with dynamic properties\r\n- **Processing:** Field mapping from Stripe subscription fields to Salesforce Opportunity fields using dynamic properties\r\n- **Output:** Salesforce-compatible Opportunity XML ready for API submission\r\n\r\n---\r\n\r\n#### **Step 4: Connector Action (shape3)**\r\n\r\n**Component Type:** Salesforce Connector\r\n\r\n**Purpose:** Create new Opportunity record in Salesforce using the transformed XML data\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** Salesforce\r\n- **Operation:** Create\r\n- **Target Object:** Opportunity\r\n- **Authentication:** OAuth authentication to Salesforce org\r\n- **Error Handling:** Salesforce API error responses managed through exception handling\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce Opportunity XML from transformation step\r\n- **Processing:** HTTP POST to Salesforce API for Opportunity creation\r\n- **Output:** Salesforce API response with created Opportunity ID and status\r\n\r\n---\r\n\r\n#### **Step 5: End Event (shape5)**\r\n\r\n**Component Type:** End Event\r\n\r\n**Purpose:** Process completion for successful Opportunity creation\r\n\r\n**Configuration Details:**\r\n\r\n- **Completion Type:** Success completion\r\n- **Final Actions:** Process completion logging\r\n- **Continuation Settings:** Process stops after successful completion\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce API success response\r\n- **Processing:** Process completion actions and logging\r\n- **Output:** Integration completion status and success confirmation\r\n\r\n## Boomi Transformations Explained\r\n\r\n### Subscription Completed JSON to SF Opportunity CREATE Request XML\r\n\r\n**Input Profile:** Subscription Completed JSON structure containing Stripe webhook event data\r\n**Output Profile:** SF Opportunity CREATE Request XML structure compatible with Salesforce API\r\n\r\n**Transformation Functions:**\r\n\r\n1. **Get Document Property (ProcessProperty)** - DDP_SalesforceDescription\r\n   - **Purpose:** Retrieve dynamically calculated Salesforce description\r\n   - **Output:** Description field value for Opportunity record\r\n\r\n2. **Get Document Property (ProcessProperty)** - DDP_CustomerName  \r\n   - **Purpose:** Retrieve extracted customer name from Stripe data\r\n   - **Output:** Name field value for Opportunity record\r\n\r\n3. **Get Document Property (ProcessProperty)** - DDP_CloseDate\r\n   - **Purpose:** Retrieve calculated close date for the opportunity\r\n   - **Output:** CloseDate field value for Opportunity record\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| Function Output (DDP_SalesforceDescription) | Opportunity/Description | String | Maps calculated description to Salesforce Opportunity description field |\r\n| Function Output (DDP_CustomerName) | Opportunity/Name | String | Maps extracted customer name to Salesforce Opportunity name field |\r\n| Function Output (DDP_CloseDate) | Opportunity/CloseDate | Date | Maps calculated close date to Salesforce Opportunity close date field |\r\n\r\n**Mapping Configuration Details:**\r\n- **3** → **Opportunity/Description** (profile): Function output from DDP_SalesforceDescription property\r\n- **3** → **Opportunity/Name** (profile): Function output from DDP_CustomerName property  \r\n- **3** → **Opportunity/CloseDate** (profile): Function output from DDP_CloseDate property\r\n\r\nThe transformation uses DocumentPropertyGet functions to inject the calculated dynamic properties into the appropriate Salesforce Opportunity XML fields, ensuring proper data mapping from Stripe subscription events to Salesforce opportunity records.\r\n\r\n## SAP Integration Suite Implementation\r\n\r\n### Component Mapping\r\n\r\n#### Main Process Component Mapping\r\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\r\n|-----------------|----------------------------------|---------|\r\n| Start Event (shape1) - HTTP Listener | HTTPS Adapter (Sender) | Receive Stripe webhook events via HTTP POST |\r\n| Document Properties (shape6) | Content Modifier (Set Properties) | Calculate and set dynamic properties for customer name, subscription details, description, and close date |\r\n| Map Transform (shape4) | Message Mapping | Transform JSON webhook data to Salesforce Opportunity XML format |\r\n| Salesforce Connector (shape3) - Create Operation | Salesforce Adapter or HTTPS Adapter (Receiver) | Create Opportunity records in Salesforce using REST API |\r\n| End Event (shape5) | End Message Event | Complete successful processing |\r\n\r\n### Integration Flow Visualization\r\n\r\n```mermaid\r\nflowchart TD\r\n    %% Define node styles for SAP Integration Suite components\r\n    classDef httpAdapter fill:#87CEEB,stroke:#333,stroke-width:2px\r\n    classDef contentModifier fill:#98FB98,stroke:#333,stroke-width:2px\r\n    classDef mapping fill:#DDA0DD,stroke:#333,stroke-width:2px\r\n    classDef adapter fill:#FFD700,stroke:#333,stroke-width:2px\r\n    classDef event fill:#C0C0C0,stroke:#333,stroke-width:2px\r\n    classDef errorHandler fill:#FFA07A,stroke:#333,stroke-width:2px\r\n\r\n    %% Main Integration Flow\r\n    Start((\"Start Message Event\")):::event --> StripeWebhook[\"HTTPS Adapter: Stripe Webhook Receiver\"]:::httpAdapter\r\n    StripeWebhook --> SetDynamicProps[\"Content Modifier: Set Dynamic Properties\"]:::contentModifier\r\n    SetDynamicProps --> TransformData[\"Message Mapping: JSON to XML Transform\"]:::mapping\r\n    TransformData --> SalesforceCreate[\"Salesforce Adapter: Create Opportunity\"]:::adapter\r\n    SalesforceCreate --> End((\"End Message Event\")):::event\r\n\r\n    %% Dynamic Properties Detail\r\n    subgraph DynamicProperties[\"Dynamic Properties Calculation\"]\r\n        ExtractCustomer[\"Extract: Customer Name from Stripe Data\"]:::contentModifier\r\n        ExtractSubscription[\"Extract: Subscription Details\"]:::contentModifier\r\n        BuildDescription[\"Build: Salesforce Description\"]:::contentModifier\r\n        CalcCloseDate[\"Calculate: Opportunity Close Date\"]:::contentModifier\r\n    end\r\n\r\n    SetDynamicProps -.-> DynamicProperties\r\n\r\n    %% Error Handling Path (if present)\r\n    StripeWebhook -->|\"Webhook Error\"| ErrorHandler[(\"Exception Subprocess\")]:::errorHandler\r\n    TransformData -->|\"Transform Error\"| ErrorHandler\r\n    SalesforceCreate -->|\"Salesforce Error\"| ErrorHandler\r\n    ErrorHandler --> LogError[\"Write to Log: Error Details\"]:::contentModifier\r\n    LogError --> ErrorEnd((\"Error End Event\")):::event\r\n\r\n    %% Apply styling\r\n    class Start,End,ErrorEnd event\r\n    class StripeWebhook httpAdapter\r\n    class SetDynamicProps,ExtractCustomer,ExtractSubscription,BuildDescription,CalcCloseDate,LogError contentModifier\r\n    class TransformData mapping\r\n    class SalesforceCreate adapter\r\n    class ErrorHandler errorHandler\r\n```\r\n\r\n### Configuration Details\r\n\r\n#### HTTPS Adapter (Stripe Webhook Receiver)\r\n- **Address:** `/stripe/subscription/webhook`\r\n- **Method:** POST\r\n- **Authentication:** None (webhook signature validation in script)\r\n- **Content Type:** application/json\r\n- **Message Protocol:** HTTPS\r\n- **Connection Timeout:** 30 seconds\r\n\r\n#### Content Modifier (Dynamic Properties)\r\n- **DDP_CustomerName:** Extract customer name from Stripe subscription data\r\n- **DDP_Subscription:** Extract subscription details and plan information\r\n- **DDP_SalesforceDescription:** Concatenate customer and subscription info for opportunity description\r\n- **DDP_CloseDate:** Calculate opportunity close date (typically subscription start date + billing period)\r\n\r\n#### Message Mapping Configuration\r\n- **Source Message Type:** Stripe Subscription JSON Schema\r\n- **Target Message Type:** Salesforce Opportunity XML Schema\r\n- **Mapping Functions:** Property injection for dynamic fields\r\n- **Field Mappings:**\r\n  - Description ← DDP_SalesforceDescription property\r\n  - Name ← DDP_CustomerName property  \r\n  - CloseDate ← DDP_CloseDate property\r\n\r\n#### Salesforce Adapter Configuration\r\n- **Operation:** CREATE\r\n- **Object:** Opportunity\r\n- **Authentication:** OAuth 2.0\r\n- **API Version:** Latest available\r\n- **Connection Pool Size:** 10\r\n- **Timeout:** 60 seconds\r\n\r\n## Environment Configuration\r\n\r\n### Required Configuration Parameters\r\n- **Stripe Webhook Endpoint:** Public-facing URL for receiving webhook events\r\n- **Stripe Webhook Secret:** For signature validation and security\r\n- **Salesforce OAuth Credentials:** Client ID, Client Secret, Username, Password, Security Token\r\n- **Salesforce Org URL:** Target Salesforce instance URL\r\n\r\n### Environment Variables\r\n| Variable | Description | Example Value |\r\n|----------|-------------|---------------|\r\n| `STRIPE_WEBHOOK_SECRET` | Secret key for webhook signature validation | `whsec_1234567890abcdef` |\r\n| `SALESFORCE_CLIENT_ID` | OAuth client ID for Salesforce connection | `3MVG9_client_id_example` |\r\n| `SALESFORCE_CLIENT_SECRET` | OAuth client secret for Salesforce connection | `1234567890123456789` |\r\n| `SALESFORCE_USERNAME` | Salesforce user account for API access | `integration@company.com` |\r\n| `SALESFORCE_PASSWORD` | Password for Salesforce user account | `password123` |\r\n| `SALESFORCE_SECURITY_TOKEN` | Security token for API access | `abcdefghijklmnopqrstuvwx` |\r\n| `SALESFORCE_INSTANCE_URL` | Target Salesforce instance URL | `https://company.salesforce.com` |\r\n\r\n### Dependencies\r\n- **Stripe Webhook Configuration:** Webhook must be configured in Stripe dashboard to send subscription.completed events\r\n- **Salesforce API Access:** User account must have appropriate permissions to create Opportunity records\r\n- **Network Connectivity:** Outbound HTTPS access to Salesforce API endpoints\r\n- **SSL Certificates:** Valid SSL certificates for secure communications\r\n\r\n### Security Settings\r\n- **HTTPS Encryption:** All communications encrypted with TLS 1.2+\r\n- **OAuth Authentication:** Secure token-based authentication to Salesforce\r\n- **Webhook Signature Validation:** Verify incoming webhook authenticity\r\n- **API Rate Limiting:** Respect Salesforce API rate limits\r\n\r\n### Deployment Considerations\r\n- **High Availability:** Deploy with redundancy for webhook availability\r\n- **Scalability:** Configure appropriate connection pools for high-volume scenarios  \r\n- **Monitoring:** Implement logging and alerting for integration failures\r\n- **Error Recovery:** Configure retry logic for transient failures\r\n\r\n## API Reference\r\n\r\n### Stripe Webhook Events\r\n\r\n#### subscription.completed Event\r\n**HTTP Method:** POST  \r\n**Content-Type:** application/json\r\n\r\n**Request Headers:**\r\n| Header | Required | Description |\r\n|--------|----------|-------------|\r\n| `Stripe-Signature` | Yes | Webhook signature for verification |\r\n| `Content-Type` | Yes | Must be `application/json` |\r\n\r\n**Request Body Schema:**\r\n```json\r\n{\r\n  \"id\": \"evt_subscription_completed\",\r\n  \"object\": \"event\",\r\n  \"data\": {\r\n    \"object\": {\r\n      \"id\": \"sub_subscription_id\",\r\n      \"customer\": \"cus_customer_id\",\r\n      \"plan\": {\r\n        \"id\": \"plan_id\",\r\n        \"name\": \"Plan Name\"\r\n      },\r\n      \"current_period_start\": 1640995200,\r\n      \"current_period_end\": 1643673600\r\n    }\r\n  },\r\n  \"type\": \"subscription.completed\"\r\n}\r\n```\r\n\r\n### Salesforce Opportunity API\r\n\r\n#### Create Opportunity\r\n**HTTP Method:** POST  \r\n**Endpoint:** `/services/data/v58.0/sobjects/Opportunity`\r\n\r\n**Authentication:** OAuth Bearer Token\r\n\r\n**Request Body Schema:**\r\n```xml\r\n<Opportunity>\r\n    <Name>Customer Subscription Opportunity</Name>\r\n    <Description>Subscription details and customer information</Description>\r\n    <CloseDate>2024-12-31</CloseDate>\r\n    <StageName>Prospecting</StageName>\r\n</Opportunity>\r\n```\r\n\r\n**Response Format:**\r\n```json\r\n{\r\n  \"id\": \"006XXXXXXXXXXXXXXX\",\r\n  \"success\": true,\r\n  \"errors\": []\r\n}\r\n```\r\n\r\n**Error Codes:**\r\n| Code | Description | Resolution |\r\n|------|-------------|------------|\r\n| 400 | Bad Request - Invalid field values | Validate field mappings and data types |\r\n| 401 | Unauthorized - Invalid OAuth token | Refresh authentication token |\r\n| 403 | Forbidden - Insufficient permissions | Verify user permissions for Opportunity creation |\r\n| 500 | Internal Server Error - Salesforce issue | Retry with exponential backoff |\r\n\r\n**Rate Limiting:** \r\n- Standard Salesforce API limits apply\r\n- Recommend implementing retry logic with exponential backoff\r\n- Monitor API usage through Salesforce Setup → API Usage",
  "markdown_length": 18054,
  "constructed_query": "Create a complete SAP iFlow integration package named 'IFlow_dc087db1' with the following requirements from the documentation:\n\n# Create Salesforce Opportunities from Stripe Subscriptions Integration\r\n\r\n## Table of Contents\r\n- [API Overview](#api-overview)\r\n- [Endpoints](#endpoints)\r\n- [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n  - [Process Flow Overview](#process-flow-overview)\r\n  - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n- [Boomi Transformations Explained](#boomi-transformations-explained)\r\n- [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n  - [Component Mapping](#component-mapping)\r\n  - [Integration Flow Visualization](#integration-flow-visualization)\r\n  - [Configuration Details](#configuration-details)\r\n- [Environment Configuration](#environment-configuration)\r\n- [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration automatically creates Salesforce Opportunities when Stripe subscription events occur. The integration is designed to provide seamless synchronization between Stripe's subscription management system and Salesforce's opportunity tracking system.\r\n\r\n**Base URL Pattern:** Webhook-based integration receiving Stripe subscription events via HTTP listener\r\n\r\n**Authentication:** \r\n- Stripe webhook authentication\r\n- Salesforce OAuth authentication\r\n\r\n**Purpose:** Transform Stripe subscription completion events into Salesforce Opportunity records for sales tracking and revenue management\r\n\r\n**Response Format:** JSON responses from Salesforce API with success/error status\r\n\r\n## Endpoints\r\n\r\n### Stripe Webhook Receiver\r\n- **HTTP Method:** POST\r\n- **Path:** `/stripe/subscription/webhook`\r\n- **Purpose:** Receive subscription completion events from Stripe webhook\r\n- **Request Headers:**\r\n  - `Content-Type: application/json`\r\n  - `Stripe-Signature: [webhook signature]`\r\n- **Request Body:** Stripe subscription event payload in JSON format\r\n- **Response Format:** HTTP status codes (200 for success, error codes for failures)\r\n- **Error Handling:** Exception subprocess for webhook processing errors\r\n\r\n### Salesfo\n\nGenerate a production-ready iFlow with proper:\n1. Start and End events\n2. Required adapters and connectors\n3. Content modifiers and processing steps\n4. Proper sequence flows\n5. Error handling\n6. SAP Integration Suite compliance\n",
  "query_length": 2358,
  "markdown_truncated_at": 2000,
  "api_endpoint": "/api/generate-iflow-from-markdown",
  "request_time": "2025-10-22T18:51:12.756937"
}