{
  "timestamp": "20251016_180512",
  "job_id": "94fff5b4-c7f6-4229-b0ed-f0f936d34701",
  "iflow_name": "BoomiFlow_4c7628e4",
  "original_markdown": "# Stripe to Salesforce Opportunity Creation Integration\n\n## Table of Contents\n\n1. [API Overview](#api-overview)\n2. [Endpoints](#endpoints)\n3. [Current Boomi Flow Logic](#current-boomi-flow-logic)\n   - [Process Flow Overview](#process-flow-overview)\n   - [Step-by-Step Flow Description](#step-by-step-flow-description)\n     - [Step 1: Start Event (shape1)](#step-1-start-event-shape1)\n     - [Step 2: Document Properties (shape6)](#step-2-document-properties-shape6)\n     - [Step 3: Transform/Map Components (shape4)](#step-3-transformmap-components-shape4)\n     - [Step 4: Connector Actions (shape3)](#step-4-connector-actions-shape3)\n     - [Step 5: End Events (shape5)](#step-5-end-events-shape5)\n4. [Boomi Transformations Explained](#boomi-transformations-explained)\n5. [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\n   - [Component Mapping](#component-mapping)\n   - [Integration Flow Visualization](#integration-flow-visualization)\n   - [Configuration Details](#configuration-details)\n6. [Environment Configuration](#environment-configuration)\n7. [API Reference](#api-reference)\n\n## API Overview\n\nThis integration provides automated creation of Salesforce Opportunities based on Stripe subscription completion events. The API serves as a bridge between Stripe's webhook notifications and Salesforce's Opportunity creation process, enabling real-time synchronization of subscription data into sales opportunities for tracking and management.\n\n**Base URL Pattern:** This integration operates as a webhook receiver, processing inbound HTTP requests from Stripe\n**Authentication:** Webhook authentication via Stripe webhook signing\n**Rate Limiting:** Dependent on Stripe webhook delivery patterns and Salesforce API limits\n**Response Format:** JSON responses for webhook acknowledgment\n\n## Endpoints\n\n### Webhook Receiver Endpoint\n- **HTTP Method:** POST\n- **Path:** `/stripe/subscription/webhook`\n- **Purpose:** Receives Stripe subscription completion webhook notifications and processes them for Salesforce opportunity creation\n\n**Request Headers:**\n- `Content-Type`: application/json\n- `Stripe-Signature`: Webhook signature for authentication\n\n**Request Body Structure:**\n```json\n{\n  \"id\": \"evt_subscription_complete\",\n  \"object\": \"event\",\n  \"type\": \"customer.subscription.created\",\n  \"data\": {\n    \"object\": {\n      \"id\": \"sub_subscription_id\",\n      \"customer\": \"cus_customer_id\",\n      \"status\": \"active\",\n      \"current_period_start\": 1234567890,\n      \"current_period_end\": 1234567890\n    }\n  }\n}\n```\n\n**Response Format:**\n- **Success (200):** `{\"status\": \"processed\", \"opportunity_id\": \"006XXXXXXXXXX\"}`\n- **Error (400):** `{\"error\": \"Invalid webhook signature\"}`\n- **Error (500):** `{\"error\": \"Salesforce integration failed\"}`\n\n## Current Boomi Flow Logic\n\n### Process Flow Overview\n\nThis Boomi integration processes Stripe subscription webhook events to automatically create corresponding Salesforce Opportunities. The process includes:\n\n1. **Webhook Reception:** Receives incoming Stripe subscription completion events via HTTP listener\n2. **Dynamic Property Calculation:** Extracts and calculates customer information, subscription details, and opportunity metadata\n3. **Data Transformation:** Maps Stripe subscription data to Salesforce Opportunity object structure\n4. **Salesforce Integration:** Creates new Opportunity records in Salesforce with derived business data\n5. **Response Handling:** Returns success confirmation to Stripe webhook delivery system\n\n### Step-by-Step Flow Description\n\n---\n\n#### **Step 1: Start Event (shape1)**\n\n**Component Type:** Start Event\n\n**Purpose:** Initiates the integration process when Stripe subscription webhook events are received\n\n**Configuration Details:**\n\n- **Connector Type:** HTTP Listener/Web Services Server\n- **Operation:** Listen for incoming webhook POST requests\n- **Input Profile:** JSON webhook payload from Stripe\n- **Trigger Conditions:** Stripe subscription completion events\n\n**Data Flow:**\n\n- **Input:** Stripe webhook JSON payload containing subscription and customer data\n- **Processing:** Validates webhook signature and parses incoming subscription event data\n- **Output:** Parsed subscription event data ready for property calculation and transformation\n\n---\n\n#### **Step 2: Document Properties (shape6)**\n\n**Component Type:** Document Properties - Set Dynamic Properties\n\n**Purpose:** Extracts and calculates dynamic properties from the Stripe webhook data for use in Salesforce opportunity creation\n\n**Configuration Details:**\n\n- **Dynamic Properties:** 4 dynamic document properties configured\n  - Dynamic Document Property - DDP_CustomerName: Process property: Dynamic Document Property - DDP_CustomerName\n  - Dynamic Document Property - DDP_Subscription: Process property: Dynamic Document Property - DDP_Subscription  \n  - Dynamic Document Property - DDP_SalesforceDescription: Process property: Dynamic Document Property - DDP_SalesforceDescription\n  - Additional property configurations for opportunity metadata\n\n**Data Flow:**\n\n- **Input:** Stripe webhook JSON payload with subscription and customer information\n- **Processing:** Extracts customer name, subscription details, calculates Salesforce-specific descriptions and metadata\n- **Output:** Enhanced data payload with calculated dynamic properties ready for transformation\n\n---\n\n#### **Step 3: Transform/Map Components (shape4)**\n\n**Component Type:** Map/Transform - Subscription Completed JSON to SF Opportunity CREATE Request XML\n\n**Purpose:** Transforms Stripe subscription JSON data into Salesforce Opportunity XML format for creation request\n\n**Configuration Details:**\n\n- **Input Profile:** Stripe Subscription JSON format\n- **Output Profile:** Salesforce Opportunity CREATE Request XML\n- **Transformation Logic:** Maps subscription data to opportunity fields with business rule application\n- **Function Steps:** DocumentPropertyGet functions for dynamic property retrieval\n\n**Field Mappings:**\n\n| Source Field | Target Field | Data Type | Business Purpose |\n|--------------|--------------|-----------|------------------|\n| Function Output (DDP_SalesforceDescription) | Opportunity/Description | String | Maps calculated description to Salesforce opportunity description field |\n| Function Output (DDP_CustomerName) | Opportunity/Name | String | Maps customer name to Salesforce opportunity name for identification |\n| Function Output (DDP_CloseDate) | Opportunity/CloseDate | Date | Maps calculated close date to Salesforce opportunity close date |\n\n**Transformation Functions:**\n\n**Get Document Property (ProcessProperty) - DDP_SalesforceDescription**\n- **Purpose:** Retrieves calculated Salesforce description from dynamic properties\n- **Output:** Formatted description string for opportunity record\n\n**Get Document Property (ProcessProperty) - DDP_CustomerName**  \n- **Purpose:** Retrieves customer name from dynamic properties\n- **Output:** Customer name string for opportunity naming\n\n**Get Document Property (ProcessProperty) - DDP_CloseDate**\n- **Purpose:** Retrieves calculated close date from dynamic properties  \n- **Output:** Date value for opportunity close date field\n\n**Data Flow:**\n\n- **Input:** Stripe subscription JSON with dynamic properties\n- **Processing:** Field-by-field transformation applying business rules and data type conversions\n- **Output:** Salesforce Opportunity XML ready for API submission\n\n---\n\n#### **Step 4: Connector Actions (shape3)**\n\n**Component Type:** Salesforce Connector - SF Opportunity CREATE Operation\n\n**Purpose:** Creates new Opportunity records in Salesforce using the transformed subscription data\n\n**Configuration Details:**\n\n- **Connector Type:** Salesforce\n- **Operation:** Create\n- **Target Object:** Opportunity\n- **Authentication:** OAuth or Username/Password authentication to Salesforce\n- **Error Handling:** Standard Salesforce API error responses\n\n**Data Flow:**\n\n- **Input:** Salesforce Opportunity XML with all required fields populated\n- **Processing:** Executes Salesforce API create operation for Opportunity object\n- **Output:** Salesforce response with created Opportunity ID and success status\n\n---\n\n#### **Step 5: End Events (shape5)**\n\n**Component Type:** End Event\n\n**Purpose:** Completes the integration process and returns success response to Stripe webhook\n\n**Configuration Details:**\n\n- **Completion Type:** Successful process completion\n- **Final Actions:** Returns HTTP response to acknowledge webhook processing\n- **Continuation Settings:** Process terminates after successful completion\n\n**Data Flow:**\n\n- **Input:** Salesforce creation response with opportunity details\n- **Processing:** Formats success response for webhook acknowledgment\n- **Output:** HTTP 200 response confirming successful opportunity creation\n\n---\n\n## Boomi Transformations Explained\n\n### Subscription Completed JSON to SF Opportunity CREATE Request XML\n\nThis transformation converts incoming Stripe subscription webhook data into the XML format required by Salesforce's Opportunity creation API.\n\n**Input Profile:** Stripe Subscription Webhook JSON\n- Contains subscription event data including customer information, subscription details, and pricing\n- Includes event metadata such as timestamps and event identifiers\n- May contain nested customer and product information\n\n**Output Profile:** Salesforce Opportunity XML\n- Structured XML format matching Salesforce API requirements for Opportunity object\n- Contains required fields: Name, Description, CloseDate\n- Formatted for SOAP API consumption by Salesforce connector\n\n**Transformation Process:**\n\n1. **Dynamic Property Retrieval:** Uses DocumentPropertyGet functions to access calculated properties\n2. **Field Assignment:** Maps function outputs to specific Opportunity XML elements\n3. **Data Type Conversion:** Ensures proper formatting for Salesforce field requirements\n4. **XML Structure Creation:** Builds properly formatted XML for Salesforce API consumption\n\n**Function Steps Used:**\n\n- **DocumentPropertyGet(DDP_SalesforceDescription):** Retrieves calculated opportunity description\n- **DocumentPropertyGet(DDP_CustomerName):** Retrieves customer name for opportunity naming\n- **DocumentPropertyGet(DDP_CloseDate):** Retrieves calculated opportunity close date\n\n**Default Values and Constants:**\n- No static default values are configured; all fields are populated from dynamic properties\n- XML structure follows Salesforce API schema requirements\n\n## SAP Integration Suite Implementation\n\n### Component Mapping\n\n#### Main Process Component Mapping\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\n|-----------------|----------------------------------|---------|\n| Start Event (shape1) | Start Message Event with HTTPS Adapter | Receives Stripe webhook HTTP requests |\n| Document Properties (shape6) | Content Modifier - Set Properties | Calculates dynamic properties from webhook data |\n| Transform/Map (shape4) | Message Mapping - JSON to XML | Transforms Stripe data to Salesforce format |\n| Salesforce Connector (shape3) | Request Reply with Salesforce Adapter | Creates Salesforce Opportunity records |\n| End Event (shape5) | End Message Event | Completes integration flow |\n\n### Integration Flow Visualization\n\n```mermaid\nflowchart TD\n    %% Define node styles for SAP Integration Suite components\n    classDef httpAdapter fill:#87CEEB,stroke:#333,stroke-width:2px\n    classDef contentModifier fill:#98FB98,stroke:#333,stroke-width:2px\n    classDef mapping fill:#DDA0DD,stroke:#333,stroke-width:2px\n    classDef adapter fill:#FFD700,stroke:#333,stroke-width:2px\n    classDef event fill:#C0C0C0,stroke:#333,stroke-width:2px\n\n    %% Main Integration Flow\n    Start((\"Start Event\")):::event --> StripeWebhook[\"HTTPS Adapter: Stripe Webhook Receiver\"]:::httpAdapter\n    StripeWebhook --> SetDynamicProps[\"Content Modifier: Set Dynamic Properties\"]:::contentModifier\n    SetDynamicProps --> TransformData[\"Message Mapping: JSON to XML Transformation\"]:::mapping\n    TransformData --> SalesforceCreate[\"Salesforce Adapter: Create Opportunity\"]:::adapter\n    SalesforceCreate --> End((\"End Event\")):::event\n\n    %% Dynamic Properties Detail\n    subgraph DynamicProperties[\"Dynamic Properties Calculation\"]\n        ExtractCustomer[\"Extract Customer Name from Webhook\"]:::contentModifier\n        ExtractSubscription[\"Extract Subscription Details\"]:::contentModifier\n        CalcDescription[\"Calculate Salesforce Description\"]:::contentModifier\n        CalcCloseDate[\"Calculate Opportunity Close Date\"]:::contentModifier\n    end\n\n    SetDynamicProps --> DynamicProperties\n    DynamicProperties --> TransformData\n```\n\n### Configuration Details\n\n**HTTPS Adapter Configuration (Webhook Receiver):**\n- Address: `/stripe/subscription/webhook`\n- Authentication: Basic Authentication or API Key\n- HTTP Method: POST\n- Content Type: application/json\n\n**Content Modifier Configuration (Dynamic Properties):**\n- Property 1: DDP_CustomerName - Extract from webhook payload\n- Property 2: DDP_Subscription - Extract subscription details\n- Property 3: DDP_SalesforceDescription - Calculate description text\n- Property 4: DDP_CloseDate - Calculate close date based on subscription\n\n**Message Mapping Configuration:**\n- Source: Stripe Webhook JSON Schema\n- Target: Salesforce Opportunity XML Schema\n- Mapping Rules: Function-based mapping using dynamic properties\n\n**Salesforce Adapter Configuration:**\n- Connection: Salesforce Production/Sandbox\n- Object: Opportunity\n- Operation: Create\n- Authentication: OAuth 2.0 or Username/Password\n\n## Environment Configuration\n\n**Required Configuration Parameters:**\n- Stripe Webhook Endpoint URL\n- Stripe Webhook Secret for signature validation\n- Salesforce Connection credentials (Username, Password, Security Token)\n- Salesforce API Version (e.g., v58.0)\n\n**Environment Variables:**\n- `STRIPE_WEBHOOK_SECRET`: Webhook signing secret for authentication\n- `SALESFORCE_USERNAME`: Salesforce integration user account\n- `SALESFORCE_PASSWORD`: Salesforce integration user password\n- `SALESFORCE_SECURITY_TOKEN`: Salesforce security token for API access\n- `SALESFORCE_ENDPOINT`: Salesforce instance URL (e.g., https://yourinstance.salesforce.com)\n\n**External System Dependencies:**\n- Stripe webhook delivery system for event notifications\n- Salesforce API for opportunity creation\n- Network connectivity to both Stripe and Salesforce cloud services\n\n**Security Settings:**\n- TLS 1.2+ for all external communications\n- Webhook signature validation for Stripe events\n- OAuth or secure authentication for Salesforce API access\n\n**Deployment Considerations:**\n- Deploy to cloud runtime for high availability\n- Configure appropriate memory allocation for JSON/XML processing\n- Set up monitoring for webhook delivery failures\n- Implement error handling for Salesforce API limits\n\n**Required Resources:**\n- Memory: 2GB minimum for JSON/XML transformation\n- CPU: 2 cores for concurrent webhook processing\n- Network: Reliable internet connectivity for cloud API access\n- Storage: Minimal temporary storage for message processing\n\n## API Reference\n\n### Webhook Processing Endpoint\n\n**POST** `/stripe/subscription/webhook`\n\nProcesses Stripe subscription completion webhooks and creates corresponding Salesforce opportunities.\n\n#### Request Headers\n| Header | Type | Required | Description |\n|--------|------|----------|-------------|\n| `Content-Type` | String | Yes | Must be `application/json` |\n| `Stripe-Signature` | String | Yes | Webhook signature for authentication |\n\n#### Request Body Schema\n```json\n{\n  \"id\": \"string\",\n  \"object\": \"event\",\n  \"type\": \"customer.subscription.created\",\n  \"data\": {\n    \"object\": {\n      \"id\": \"string\",\n      \"customer\": \"string\", \n      \"status\": \"string\",\n      \"current_period_start\": \"number\",\n      \"current_period_end\": \"number\"\n    }\n  }\n}\n```\n\n#### Response Codes\n| Code | Description | Response Body |\n|------|-------------|---------------|\n| 200 | Success | `{\"status\": \"processed\", \"opportunity_id\": \"string\"}` |\n| 400 | Bad Request | `{\"error\": \"Invalid webhook signature\"}` |\n| 422 | Validation Error | `{\"error\": \"Missing required subscription data\"}` |\n| 500 | Server Error | `{\"error\": \"Salesforce integration failed\"}` |\n\n#### Authentication\n- **Type:** Webhook Signature Validation\n- **Header:** `Stripe-Signature`\n- **Method:** HMAC SHA256 verification using webhook secret\n\n#### Rate Limiting\n- Depends on Stripe webhook delivery frequency\n- Salesforce API limits: 15,000 calls per 24 hours (varies by license)\n- Recommended: Implement queuing for high-volume scenarios\n\n#### Error Handling\n- Invalid signatures result in 400 responses\n- Salesforce API failures result in 500 responses with retry logic\n- Webhook delivery failures are handled by Stripe's retry mechanism",
  "markdown_length": 16747,
  "constructed_query": "Create a complete SAP iFlow integration package named 'BoomiFlow_4c7628e4' with the following requirements from the documentation:\n\n# Stripe to Salesforce Opportunity Creation Integration\n\n## Table of Contents\n\n1. [API Overview](#api-overview)\n2. [Endpoints](#endpoints)\n3. [Current Boomi Flow Logic](#current-boomi-flow-logic)\n   - [Process Flow Overview](#process-flow-overview)\n   - [Step-by-Step Flow Description](#step-by-step-flow-description)\n     - [Step 1: Start Event (shape1)](#step-1-start-event-shape1)\n     - [Step 2: Document Properties (shape6)](#step-2-document-properties-shape6)\n     - [Step 3: Transform/Map Components (shape4)](#step-3-transformmap-components-shape4)\n     - [Step 4: Connector Actions (shape3)](#step-4-connector-actions-shape3)\n     - [Step 5: End Events (shape5)](#step-5-end-events-shape5)\n4. [Boomi Transformations Explained](#boomi-transformations-explained)\n5. [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\n   - [Component Mapping](#component-mapping)\n   - [Integration Flow Visualization](#integration-flow-visualization)\n   - [Configuration Details](#configuration-details)\n6. [Environment Configuration](#environment-configuration)\n7. [API Reference](#api-reference)\n\n## API Overview\n\nThis integration provides automated creation of Salesforce Opportunities based on Stripe subscription completion events. The API serves as a bridge between Stripe's webhook notifications and Salesforce's Opportunity creation process, enabling real-time synchronization of subscription data into sales opportunities for tracking and management.\n\n**Base URL Pattern:** This integration operates as a webhook receiver, processing inbound HTTP requests from Stripe\n**Authentication:** Webhook authentication via Stripe webhook signing\n**Rate Limiting:** Dependent on Stripe webhook delivery patterns and Salesforce API limits\n**Response Format:** JSON responses for webhook acknowledgment\n\n## Endpoints\n\n### Webhook Receiver Endpoint\n- **HTTP Method:** POST\n- **Path:** `/stripe/subscription/webhook`\n- **Purpose:** Receives Stripe subscription completion webhook notifica\n\nGenerate a production-ready iFlow with proper:\n1. Start and End events\n2. Required adapters and connectors\n3. Content modifiers and processing steps\n4. Proper sequence flows\n5. Error handling\n6. SAP Integration Suite compliance\n",
  "query_length": 2362,
  "markdown_truncated_at": 2000,
  "api_endpoint": "/api/generate-iflow-from-markdown",
  "request_time": "2025-10-16T18:05:12.166945"
}