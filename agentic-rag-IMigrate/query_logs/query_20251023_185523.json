{
  "timestamp": "20251023_185523",
  "job_id": null,
  "iflow_name": "IFlow_30f0abe2",
  "original_markdown": "# Salesforce to SAP Customer Integration API\r\n\r\n## Table of Contents\r\n\r\n- [API Overview](#api-overview)\r\n- [Endpoints](#endpoints)\r\n- [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n  - [Process Flow Overview](#process-flow-overview)\r\n  - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n- [Boomi Transformations Explained](#boomi-transformations-explained)\r\n- [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n  - [Component Mapping](#component-mapping)\r\n  - [Integration Flow Visualization](#integration-flow-visualization)\r\n  - [Configuration Details](#configuration-details)\r\n- [Environment Configuration](#environment-configuration)\r\n- [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration enables bi-directional synchronization between Salesforce accounts and SAP customer master data. The API facilitates the creation of new customers in SAP when new accounts are created in Salesforce, and updates the Salesforce account with the generated SAP customer number for reference.\r\n\r\n**Business Purpose:**\r\n- Automatically create SAP customers when new Salesforce accounts are created\r\n- Maintain data consistency between Salesforce CRM and SAP ERP systems\r\n- Enable seamless order-to-cash processes by ensuring customer data exists in both systems\r\n- Provide audit trail with SAP customer numbers stored in Salesforce\r\n\r\n**Base URL/Endpoint Pattern:**\r\n- Salesforce REST API: `https://<instance>.salesforce.com/services/data/v<version>/`\r\n- SAP BAPI Endpoint: `https://<sap-host>:<port>/sap/opu/odata/iwbep/gwsample_basic/`\r\n\r\n**Authentication Mechanisms:**\r\n- Salesforce: OAuth 2.0 or Session ID authentication\r\n- SAP: Basic Authentication or Certificate-based authentication\r\n\r\n**Rate Limiting:**\r\n- Salesforce: Standard API limits apply based on license type\r\n- SAP: Depends on SAP system configuration and licensing\r\n\r\n**General Response Format:**\r\n- Salesforce: JSON format\r\n- SAP BAPI: XML format (converted to JSON by Boomi)\r\n\r\n## Endpoints\r\n\r\n### Salesforce Account Query Endpoint\r\n\r\n**HTTP Method:** GET\r\n**Full Path:** `/services/data/v52.0/query`\r\n\r\n**Purpose:** Retrieve Salesforce account records based on creation date criteria\r\n\r\n**Request Parameters:**\r\n- **Query Parameters:**\r\n  - `q` (String, Required): SOQL query string for account retrieval\r\n  - Example: `SELECT Id, Name, BillingStreet, BillingCity, BillingState, BillingPostalCode, BillingCountry FROM Account WHERE CreatedDate >= TODAY`\r\n\r\n**Response Format:**\r\n- Status Code 200: Successful query execution\r\n- Content-Type: application/json\r\n\r\n**Example Response:**\r\n```json\r\n{\r\n  \"totalSize\": 1,\r\n  \"done\": true,\r\n  \"records\": [\r\n    {\r\n      \"Id\": \"001XX000003DHP0\",\r\n      \"Name\": \"Sample Account\",\r\n      \"BillingStreet\": \"123 Main St\",\r\n      \"BillingCity\": \"San Francisco\",\r\n      \"BillingState\": \"CA\",\r\n      \"BillingPostalCode\": \"94105\",\r\n      \"BillingCountry\": \"USA\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n### SAP Customer Creation Endpoint\r\n\r\n**HTTP Method:** POST\r\n**Full Path:** `/sap/opu/odata/iwbep/gwsample_basic/BAPI_CUSTOMER_CREATEFROMDATA1`\r\n\r\n**Purpose:** Create new customer master data in SAP system\r\n\r\n**Request Body Structure:**\r\n```json\r\n{\r\n  \"IMPORT\": {\r\n    \"I_PI_COMPANYDATA\": {\r\n      \"NAME\": \"Company Name\",\r\n      \"STREET\": \"Street Address\",\r\n      \"CITY\": \"City\",\r\n      \"REGION\": \"State/Region\",\r\n      \"POSTL_COD1\": \"Postal Code\",\r\n      \"COUNTRY\": \"Country Code\"\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n**Response Format:**\r\n- Status Code 200: Successful customer creation\r\n- Content-Type: application/json\r\n\r\n**Example Response:**\r\n```json\r\n{\r\n  \"E_CUSTOMERNO\": \"0000100001\",\r\n  \"RETURN\": {\r\n    \"TYPE\": \"S\",\r\n    \"MESSAGE\": \"Customer created successfully\"\r\n  }\r\n}\r\n```\r\n\r\n### Salesforce Account Update Endpoint\r\n\r\n**HTTP Method:** PATCH\r\n**Full Path:** `/services/data/v52.0/sobjects/Account/{AccountId}`\r\n\r\n**Purpose:** Update Salesforce account with SAP customer number\r\n\r\n**Request Body Structure:**\r\n```json\r\n{\r\n  \"Description\": \"SAP customer #:0000100001\",\r\n  \"Name\": \"Updated Account Name\"\r\n}\r\n```\r\n\r\n**Response Format:**\r\n- Status Code 204: Successful update (no content returned)\r\n- Status Code 200: Successful update with response body\r\n\r\n## Current Boomi Flow Logic\r\n\r\n### Process Flow Overview\r\n\r\nThis Boomi integration implements a real-time synchronization pattern that:\r\n\r\n1. **Triggers on Account Creation**: Listens for new Salesforce account records created today\r\n2. **Validates New Accounts**: Determines if the account requires SAP customer creation\r\n3. **Creates SAP Customer**: Transforms Salesforce account data to SAP customer format and creates the customer\r\n4. **Updates Salesforce**: Returns the SAP customer number and updates the original Salesforce account\r\n5. **Handles Existing Customers**: Provides appropriate messaging for accounts that already have SAP customer numbers\r\n\r\nThe process uses dynamic document properties to maintain account context throughout the integration flow and implements decision logic to prevent duplicate customer creation.\r\n\r\n### Step-by-Step Flow Description\r\n\r\n---\r\n\r\n#### **Step 1: Start Event (shape1)**\r\n\r\n**Component Type:** Start Event\r\n\r\n**Purpose:** Initiates the integration process to listen for Salesforce account data\r\n\r\n**Configuration Details:**\r\n- **Connector Type:** SF Account Opp QUERY by Created Date (generic)\r\n- **Operation:** Query operation to retrieve today's account records\r\n- **Input Profile:** Salesforce Account query response format\r\n- **Trigger Conditions:** Scheduled or manual execution to process new accounts\r\n\r\n**Data Flow:**\r\n- **Input:** Salesforce query trigger\r\n- **Processing:** Executes SOQL query to retrieve account records\r\n- **Output:** Salesforce account records in XML format\r\n\r\n---\r\n\r\n#### **Step 2: Document Properties - Set SF Account ID and SF Account Name (shape9)**\r\n\r\n**Component Type:** Document Properties\r\n\r\n**Purpose:** Capture Salesforce account identification data for use throughout the integration process\r\n\r\n**Configuration Details:**\r\n- **Dynamic Properties:** \r\n  - Dynamic Document Property - DDP_SF_Account_ID: Process property: Dynamic Document Property - DDP_SF_Account_ID\r\n  - Dynamic Document Property - DDP_SF_Account_Name: Process property: Dynamic Document Property - DDP_SF_Account_Name\r\n- **HTTP Calls:** None in this component\r\n- **Calculations:** Direct property assignment from incoming account data\r\n- **Parameter Mappings:** Account ID and Name extracted from Salesforce response\r\n\r\n**Data Flow:**\r\n- **Input:** Salesforce account query response\r\n- **Processing:** Extract and store Account ID and Name as dynamic properties\r\n- **Output:** Enhanced data context with stored account identifiers\r\n\r\n---\r\n\r\n#### **Step 3: Transform - SF Account QUERY Response XML to SAP BAPI Request JSON (shape2)**\r\n\r\n**Component Type:** Map/Transform\r\n\r\n**Purpose:** Transform Salesforce account data into SAP BAPI_CUSTOMER_CREATEFROMDATA1 function request format\r\n\r\n**Configuration Details:**\r\n- **Input Profile:** Salesforce Account query response XML format\r\n- **Output Profile:** SAP BAPI_CUSTOMER_CREATEFROMDATA1 function request JSON format\r\n- **Transformation Logic:** Maps Salesforce billing address fields to SAP customer master data fields\r\n- **Function Steps:** Direct field mapping with data type conversion\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| Name | IMPORT/Object/I_PI_COMPANYDATA/Object/NAME | String | Maps Salesforce account name to SAP customer company name |\r\n| BillingStreet | IMPORT/Object/I_PI_COMPANYDATA/Object/STREET | String | Maps billing address street to customer address |\r\n| BillingCity | IMPORT/Object/I_PI_COMPANYDATA/Object/CITY | String | Maps billing city to customer city |\r\n| BillingState | IMPORT/Object/I_PI_COMPANYDATA/Object/REGION | String | Maps billing state to customer region |\r\n| BillingPostalCode | IMPORT/Object/I_PI_COMPANYDATA/Object/POSTL_COD1 | String | Maps billing postal code to customer postal code |\r\n| BillingCountry | IMPORT/Object/I_PI_COMPANYDATA/Object/COUNTRY | String | Maps billing country to customer country |\r\n\r\n**Data Flow:**\r\n- **Input:** Salesforce account data in XML format\r\n- **Processing:** Field-by-field transformation from Salesforce to SAP format\r\n- **Output:** SAP BAPI function request in JSON format\r\n\r\n---\r\n\r\n#### **Step 4: SAP Customer Creation (shape3)**\r\n\r\n**Component Type:** Boomi Create Customer Function (generic)\r\n\r\n**Purpose:** Execute SAP BAPI function to create new customer master data\r\n\r\n**Configuration Details:**\r\n- **Connector Type:** generic (SAP BAPI connector)\r\n- **Operation:** BAPI_CUSTOMER_CREATEFROMDATA1 function call\r\n- **Target Object:** SAP Customer Master Data\r\n- **Authentication:** SAP system authentication (basic or certificate)\r\n- **Error Handling:** BAPI return message processing\r\n\r\n**Data Flow:**\r\n- **Input:** SAP BAPI function request with customer data\r\n- **Processing:** Execute customer creation function in SAP system\r\n- **Output:** SAP customer number and BAPI return messages\r\n\r\n---\r\n\r\n#### **Step 5: Transform - SAP Response to Salesforce Update Request (shape10)**\r\n\r\n**Component Type:** Map/Transform\r\n\r\n**Purpose:** Transform SAP BAPI response into Salesforce account update request format\r\n\r\n**Configuration Details:**\r\n- **Input Profile:** SAP BAPI_CUSTOMER_CREATEFROMDATA1 response JSON format\r\n- **Output Profile:** Salesforce Account update request XML format\r\n- **Transformation Logic:** Extract customer number and format for Salesforce update\r\n- **Function Steps:** Custom function to append \"SAP customer #:\" prefix and document property retrieval\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| E_CUSTOMERNO | Account/Description | String | Maps SAP customer number to Salesforce account description with prefix |\r\n| DDP_SF_Account_ID | Account/Id | String | Retrieved from document property for account identification |\r\n| DDP_SF_Account_Name | Account/Name | String | Retrieved from document property for account name |\r\n\r\n**Transformation Functions:**\r\n- **Append \"SAP customer #:\" and value from field**: Custom function to format customer number\r\n- **Get Document Property**: Retrieval of stored account ID and name\r\n\r\n**Data Flow:**\r\n- **Input:** SAP BAPI response with customer number\r\n- **Processing:** Format customer number and retrieve stored account properties\r\n- **Output:** Salesforce account update request with SAP customer number\r\n\r\n---\r\n\r\n#### **Step 6: Decision Point - Is it a new account? (shape25)**\r\n\r\n**Component Type:** Decision\r\n\r\n**Purpose:** Determine if the account requires customer creation or if customer already exists\r\n\r\n**Configuration Details:**\r\n- **Decision Criteria:** notequals comparison logic\r\n- **Branch Logic:** Routes to customer creation or information message based on account status\r\n- **Routing Rules:** New accounts proceed to Salesforce update, existing accounts route to information message\r\n\r\n**Data Flow:**\r\n- **Input:** Processed account data with customer information\r\n- **Processing:** Evaluate account status and customer existence\r\n- **Output:** Route to appropriate processing path\r\n\r\n---\r\n\r\n#### **Step 7: Salesforce Account Update (shape5)**\r\n\r\n**Component Type:** SF Account UPDATE Description with SAP Customer Number\r\n\r\n**Purpose:** Update the original Salesforce account with the generated SAP customer number\r\n\r\n**Configuration Details:**\r\n- **Connector Type:** salesforce\r\n- **Operation:** update\r\n- **Target Object:** Account\r\n- **Authentication:** Salesforce OAuth or session authentication\r\n- **Error Handling:** Salesforce API error response handling\r\n\r\n**Data Flow:**\r\n- **Input:** Salesforce account update request with SAP customer number\r\n- **Processing:** Execute account update operation in Salesforce\r\n- **Output:** Updated account record confirmation\r\n\r\n---\r\n\r\n#### **Step 8: Process Completion (shape4)**\r\n\r\n**Component Type:** End Event\r\n\r\n**Purpose:** Complete successful customer creation and account update process\r\n\r\n**Configuration Details:**\r\n- **Completion Type:** Success completion for new customer creation path\r\n- **Final Actions:** Process completion logging\r\n- **Continuation Settings:** Process stops after successful completion\r\n\r\n**Data Flow:**\r\n- **Input:** Confirmation of successful Salesforce account update\r\n- **Processing:** Log successful completion\r\n- **Output:** Process success status\r\n\r\n---\r\n\r\n#### **Step 9: Information Message - Account Already Exists (shape21)**\r\n\r\n**Component Type:** Information Message\r\n\r\n**Purpose:** Provide notification when account already has an associated SAP customer\r\n\r\n**Configuration Details:**\r\n- **Message Type:** Information notification\r\n- **Message Content:** \"Account already exists\"\r\n- **Routing:** Alternative path for existing customers\r\n\r\n**Data Flow:**\r\n- **Input:** Account data for existing customer\r\n- **Processing:** Generate information message\r\n- **Output:** Information notification\r\n\r\n---\r\n\r\n#### **Step 10: Alternative Process Completion (shape22)**\r\n\r\n**Component Type:** End Event\r\n\r\n**Purpose:** Complete process for accounts that already have SAP customer numbers\r\n\r\n**Configuration Details:**\r\n- **Completion Type:** Information completion for existing customer path\r\n- **Final Actions:** Log information message completion\r\n- **Continuation Settings:** Process stops after information message\r\n\r\n**Data Flow:**\r\n- **Input:** Information message about existing account\r\n- **Processing:** Log information completion\r\n- **Output:** Process completion status with information message\r\n\r\n## Boomi Transformations Explained\r\n\r\n### Map SF Account to Boomi for SAP account\r\n\r\n**Purpose:** This transformation converts Salesforce account billing information into the SAP customer master data format required by the BAPI_CUSTOMER_CREATEFROMDATA1 function.\r\n\r\n**Input Profile:** Salesforce Account query response containing standard account fields\r\n- Name: Company/account name\r\n- BillingStreet: Billing address street\r\n- BillingCity: Billing address city  \r\n- BillingState: Billing state/province\r\n- BillingPostalCode: Billing postal/ZIP code\r\n- BillingCountry: Billing country\r\n\r\n**Output Profile:** SAP BAPI_CUSTOMER_CREATEFROMDATA1 function import structure\r\n- NAME: Customer company name\r\n- STREET: Customer street address\r\n- CITY: Customer city\r\n- REGION: Customer state/region\r\n- POSTL_COD1: Customer postal code\r\n- COUNTRY: Customer country code\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| Name | IMPORT/I_PI_COMPANYDATA/NAME | String | Maps Salesforce account name to SAP customer company name |\r\n| BillingStreet | IMPORT/I_PI_COMPANYDATA/STREET | String | Maps billing address street to customer address |\r\n| BillingCity | IMPORT/I_PI_COMPANYDATA/CITY | String | Maps billing city to customer city |\r\n| BillingState | IMPORT/I_PI_COMPANYDATA/REGION | String | Maps billing state to customer region |\r\n| BillingPostalCode | IMPORT/I_PI_COMPANYDATA/POSTL_COD1 | String | Maps billing postal code to customer postal code |\r\n| BillingCountry | IMPORT/I_PI_COMPANYDATA/COUNTRY | String | Maps billing country to customer country |\r\n\r\n**Transformation Logic:**\r\n- Direct field-to-field mapping with no data manipulation required\r\n- All fields are string data types with standard format\r\n- Billing address components are mapped to corresponding SAP customer address fields\r\n\r\n### Map SAP account number to SF\r\n\r\n**Purpose:** This transformation processes the SAP BAPI response to update the original Salesforce account with the newly generated customer number and account details.\r\n\r\n**Input Profile:** SAP BAPI_CUSTOMER_CREATEFROMDATA1 response structure\r\n- E_CUSTOMERNO: Generated SAP customer number\r\n- RETURN: BAPI return messages and status\r\n\r\n**Output Profile:** Salesforce Account update request structure\r\n- Id: Salesforce account ID for update operation\r\n- Description: Account description with SAP customer number\r\n- Name: Account name for verification\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| E_CUSTOMERNO | Account/Description | String | Maps SAP customer number to Salesforce description field with formatting |\r\n| DDP_SF_Account_ID | Account/Id | String | Uses stored document property for account identification |\r\n| DDP_SF_Account_Name | Account/Name | String | Uses stored document property for account name verification |\r\n\r\n**Transformation Functions:**\r\n\r\n**Append \"SAP customer #:\" and value from field (Custom Function)**\r\n- **Input Parameters:** \r\n  - input: E_CUSTOMERNO field value\r\n- **Output Parameters:**\r\n  - output: Formatted string with \"SAP customer #:\" prefix\r\n- **Purpose:** Format the SAP customer number with descriptive prefix for Salesforce display\r\n\r\n**Get Document Property (ProcessProperty Functions)**\r\n- **DDP_SF_Account_ID:** Retrieves the stored Salesforce account ID\r\n- **DDP_SF_Account_Name:** Retrieves the stored Salesforce account name\r\n- **Purpose:** Access account context information captured earlier in the process\r\n\r\n**Transformation Logic:**\r\n- SAP customer number is formatted with \"SAP customer #:\" prefix for clear identification\r\n- Document properties are retrieved to maintain account context throughout the process\r\n- Update request is structured for Salesforce PATCH operation\r\n\r\n## SAP Integration Suite Implementation\r\n\r\n### Component Mapping\r\n\r\n#### Main Process Component Mapping\r\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\r\n|-----------------|----------------------------------|---------|\r\n| Start Event (shape1) | Start Message Event | Initiates the integration process for Salesforce account processing |\r\n| Document Properties (shape9) | Content Modifier (Set Properties) | Sets dynamic properties for SF Account ID and Name |\r\n| Map Transform (shape2) | Message Mapping | Transforms SF Account data to SAP BAPI request format |\r\n| Connector Action (shape3) | Request Reply with HTTPS Adapter | Executes SAP BAPI customer creation function |\r\n| Map Transform (shape10) | Message Mapping | Transforms SAP response to Salesforce update request |\r\n| Decision (shape25) | Router (Exclusive Gateway) | Routes based on whether account is new or existing |\r\n| Connector Action (shape5) | Request Reply with Salesforce Adapter | Updates Salesforce account with SAP customer number |\r\n| Information Message (shape21) | Content Modifier | Provides information message for existing accounts |\r\n| End Events (shape4, shape22) | End Message Events | Completes process for different paths |\r\n\r\n#### Data Transformation Component Mapping\r\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\r\n|-----------------|----------------------------------|---------|\r\n| SF Account to SAP Mapping | Message Mapping | Maps Salesforce account fields to SAP customer master data |\r\n| SAP Response to SF Mapping | Message Mapping | Maps SAP customer number back to Salesforce account update |\r\n| Custom Functions | Groovy Script | Implements custom business logic for data formatting |\r\n| Document Property Get | Content Modifier Variables | Retrieves stored process context information |\r\n\r\n#### Connector Component Mapping  \r\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\r\n|-----------------|----------------------------------|---------|\r\n| SF Account Query (generic) | HTTPS Adapter (Sender) | Queries Salesforce for account records |\r\n| SAP Customer Function (generic) | HTTPS Adapter (Receiver) | Calls SAP BAPI for customer creation |\r\n| SF Account Update (salesforce) | Salesforce Adapter (Receiver) | Updates Salesforce account records |\r\n\r\n### Integration Flow Visualization\r\n\r\n## Salesforce to SAP Customer Integration Flow\r\n\r\nThis diagram represents the complete integration flow from Salesforce account query through SAP customer creation and back to Salesforce account update, including the decision logic for handling existing customers.\r\n\r\n```mermaid\r\nflowchart TD\r\n%% Define node styles for SAP Integration Suite components\r\nclassDef httpAdapter fill:#87CEEB,stroke:#333,stroke-width:2px\r\nclassDef contentModifier fill:#98FB98,stroke:#333,stroke-width:2px\r\nclassDef mapping fill:#DDA0DD,stroke:#333,stroke-width:2px\r\nclassDef adapter fill:#FFD700,stroke:#333,stroke-width:2px\r\nclassDef event fill:#C0C0C0,stroke:#333,stroke-width:2px\r\nclassDef router fill:#FFA500,stroke:#333,stroke-width:2px\r\n\r\n%% Main Integration Flow\r\nStart((\"Start Message Event\")):::event --> SFQuery[\"HTTPS Adapter: SF Account Query by Created Date\"]:::httpAdapter\r\nSFQuery --> SetProperties[\"Content Modifier: Set SF Account ID and Name\"]:::contentModifier\r\nSetProperties --> TransformToSAP[\"Message Mapping: SF Account to SAP BAPI Request\"]:::mapping\r\nTransformToSAP --> SAPCreate[\"HTTPS Adapter: SAP BAPI Customer Creation\"]:::httpAdapter\r\nSAPCreate --> TransformToSF[\"Message Mapping: SAP Response to SF Update Request\"]:::mapping\r\nTransformToSF --> NewAccountDecision{\"Router: Is it a new account?\"}:::router\r\n\r\n%% Decision Paths\r\nNewAccountDecision -->|\"New Account\"| SFUpdate[\"Salesforce Adapter: Update Account with SAP Customer Number\"]:::adapter\r\nNewAccountDecision -->|\"Existing Account\"| InfoMessage[\"Content Modifier: Account Already Exists Message\"]:::contentModifier\r\n\r\n%% Completion Paths\r\nSFUpdate --> SuccessEnd((\"End Message Event - Success\")):::event\r\nInfoMessage --> InfoEnd((\"End Message Event - Information\")):::event\r\n\r\n%% Apply styling\r\nclass Start,SuccessEnd,InfoEnd event\r\nclass SFQuery,SAPCreate httpAdapter\r\nclass SetProperties,InfoMessage contentModifier\r\nclass TransformToSAP,TransformToSF mapping\r\nclass SFUpdate adapter\r\nclass NewAccountDecision router\r\n```\r\n\r\n### Configuration Details\r\n\r\n#### Start Message Event Configuration\r\n- **Event Type:** Timer-based or HTTP trigger\r\n- **Schedule:** Configurable interval for account processing\r\n- **Input Format:** Salesforce query response XML/JSON\r\n- **Error Handling:** Exception subprocess for connection failures\r\n\r\n#### Content Modifier - Set Properties Configuration\r\n**Dynamic Properties:**\r\n- **DDP_SF_Account_ID:** `${xpath.evaluate('//*[local-name()=\"Id\"]', message)}`\r\n- **DDP_SF_Account_Name:** `${xpath.evaluate('//*[local-name()=\"Name\"]', message)}`\r\n\r\n**Required Parameters:**\r\n- Message body preservation: Enabled\r\n- Property scope: Process level\r\n- Data type: String for both properties\r\n\r\n#### Message Mapping - SF to SAP Configuration\r\n**Input Schema:** Salesforce Account query response\r\n**Output Schema:** SAP BAPI_CUSTOMER_CREATEFROMDATA1 request\r\n\r\n**Field Mappings:**\r\n- Name → I_PI_COMPANYDATA/NAME\r\n- BillingStreet → I_PI_COMPANYDATA/STREET  \r\n- BillingCity → I_PI_COMPANYDATA/CITY\r\n- BillingState → I_PI_COMPANYDATA/REGION\r\n- BillingPostalCode → I_PI_COMPANYDATA/POSTL_COD1\r\n- BillingCountry → I_PI_COMPANYDATA/COUNTRY\r\n\r\n#### HTTPS Adapter - SAP BAPI Configuration\r\n**Connection Details:**\r\n- **Host:** SAP application server hostname\r\n- **Port:** SAP HTTP/HTTPS port (typically 8000 or 443)\r\n- **Path:** `/sap/opu/odata/iwbep/gwsample_basic/BAPI_CUSTOMER_CREATEFROMDATA1`\r\n- **Method:** POST\r\n- **Authentication:** Basic Authentication or Certificate\r\n- **Content-Type:** application/json\r\n- **Accept:** application/json\r\n\r\n**Required Parameters:**\r\n- Connection timeout: 30 seconds\r\n- Read timeout: 60 seconds\r\n- Retry attempts: 3\r\n- SSL verification: Enabled (for HTTPS)\r\n\r\n#### Message Mapping - SAP to SF Configuration\r\n**Input Schema:** SAP BAPI response\r\n**Output Schema:** Salesforce Account update request\r\n\r\n**Field Mappings:**\r\n- E_CUSTOMERNO → Description (with \"SAP customer #:\" prefix)\r\n- ${property.DDP_SF_Account_ID} → Id\r\n- ${property.DDP_SF_Account_Name} → Name\r\n\r\n**Custom Functions:**\r\n- String concatenation for customer number formatting\r\n- Property retrieval for account context\r\n\r\n#### Router Configuration\r\n**Condition Logic:**\r\n- Route condition: Evaluate if account already has SAP customer number\r\n- Default route: New account processing\r\n- Exception route: Existing account information message\r\n\r\n#### Salesforce Adapter Configuration\r\n**Connection Details:**\r\n- **Salesforce Instance:** Production or Sandbox URL\r\n- **API Version:** v52.0 or latest supported\r\n- **Authentication:** OAuth 2.0 with refresh token\r\n- **Object:** Account\r\n- **Operation:** Update\r\n\r\n**Required Parameters:**\r\n- Connection pooling: Enabled\r\n- Timeout settings: 30 seconds\r\n- Bulk processing: Disabled (single record update)\r\n- Field-level security: Respect field permissions\r\n\r\n## Environment Configuration\r\n\r\n### Important Configuration Parameters\r\n\r\n#### Salesforce Connection Configuration\r\n- **Instance URL:** `https://<instance>.salesforce.com`\r\n- **API Version:** `v52.0`\r\n- **OAuth Client ID:** `<client_id>`\r\n- **OAuth Client Secret:** `<client_secret>`\r\n- **Security Token:** `<security_token>`\r\n- **Username:** `<service_account_username>`\r\n- **Password:** `<service_account_password>`\r\n\r\n#### SAP System Connection Configuration\r\n- **SAP Host:** `<sap_application_server>`\r\n- **SAP Port:** `8000` (HTTP) or `443` (HTTPS)\r\n- **Client:** `<sap_client_number>`\r\n- **Username:** `<sap_username>`\r\n- **Password:** `<sap_password>`\r\n- **Language:** `EN`\r\n- **System ID:** `<sap_system_id>`\r\n\r\n### Environment Variables\r\n\r\n| Variable | Description | Example Value | Required |\r\n|----------|-------------|---------------|----------|\r\n| `SF_INSTANCE_URL` | Salesforce organization instance URL | `https://company.salesforce.com` | Yes |\r\n| `SF_USERNAME` | Salesforce service account username | `integration@company.com` | Yes |\r\n| `SF_PASSWORD` | Salesforce service account password | `<encrypted_password>` | Yes |\r\n| `SF_SECURITY_TOKEN` | Salesforce security token for API access | `<security_token>` | Yes |\r\n| `SF_CLIENT_ID` | Connected app client ID | `<oauth_client_id>` | Yes |\r\n| `SF_CLIENT_SECRET` | Connected app client secret | `<oauth_client_secret>` | Yes |\r\n| `SAP_HOST` | SAP application server hostname | `sap-prod.company.com` | Yes |\r\n| `SAP_PORT` | SAP system port number | `8000` | Yes |\r\n| `SAP_CLIENT` | SAP client number | `100` | Yes |\r\n| `SAP_USERNAME` | SAP service account username | `BOOMI_USER` | Yes |\r\n| `SAP_PASSWORD` | SAP service account password | `<encrypted_password>` | Yes |\r\n| `SAP_LANGUAGE` | SAP logon language | `EN` | No |\r\n| `INTEGRATION_TIMEOUT` | Connection timeout in seconds | `30` | No |\r\n| `RETRY_ATTEMPTS` | Number of retry attempts for failures | `3` | No |\r\n\r\n### Dependencies on External Systems\r\n\r\n#### Salesforce Dependencies\r\n- **Salesforce API Access:** Requires API-enabled Salesforce license\r\n- **Connected App:** OAuth-enabled connected app for authentication\r\n- **User Permissions:** Service account with Account read/write permissions\r\n- **Custom Fields:** May require custom fields for SAP customer number storage\r\n- **API Limits:** Sufficient API call limits for expected volume\r\n\r\n#### SAP System Dependencies\r\n- **BAPI Availability:** BAPI_CUSTOMER_CREATEFROMDATA1 function must be enabled\r\n- **User Authorization:** SAP user with customer master data creation authorization\r\n- **Customer Number Range:** Configured number range for customer ID generation  \r\n- **Network Connectivity:** Network access to SAP application server\r\n- **RFC/HTTP Service:** Enabled RFC or HTTP service for external calls\r\n\r\n#### Network Dependencies\r\n- **Firewall Rules:** Outbound HTTPS access to Salesforce (port 443)\r\n- **SAP Network Access:** Access to SAP system on configured port\r\n- **SSL Certificates:** Valid SSL certificates for secure connections\r\n- **DNS Resolution:** Proper DNS resolution for external hostnames\r\n\r\n### Security Settings and Certificates\r\n\r\n#### Certificate Management\r\n- **Salesforce SSL Certificate:** Trust Salesforce CA certificates\r\n- **SAP SSL Certificate:** Import SAP system SSL certificate if using HTTPS\r\n- **Certificate Validation:** Enable certificate validation for production\r\n- **Certificate Renewal:** Monitor and renew certificates before expiration\r\n\r\n#### Authentication Security\r\n- **OAuth Token Security:** Secure storage of OAuth refresh tokens\r\n- **Password Encryption:** Encrypt all passwords in configuration\r\n- **Service Accounts:** Use dedicated service accounts, not personal accounts\r\n- **Permission Minimization:** Grant minimum required permissions\r\n- **Token Expiration:** Configure appropriate token expiration times\r\n\r\n#### Data Security\r\n- **Data Encryption:** Encrypt sensitive data in transit and at rest\r\n- **Audit Logging:** Enable audit logging for all system interactions\r\n- **Error Message Security:** Avoid exposing sensitive data in error messages\r\n- **Data Masking:** Mask sensitive data in logs and monitoring\r\n\r\n### Deployment Considerations\r\n\r\n#### SAP Integration Suite Cloud Deployment\r\n- **Runtime Profile:** 1 vCPU, 2GB RAM minimum for basic processing\r\n- **Scaling:** Auto-scaling enabled for variable load\r\n- **Availability:** Deploy across multiple availability zones\r\n- **Monitoring:** Enable built-in monitoring and alerting\r\n- **Backup:** Automated backup of integration artifacts\r\n\r\n#### On-Premise Deployment Requirements\r\n- **Hardware:** 4-core CPU, 8GB RAM, 100GB storage minimum\r\n- **Operating System:** Linux (preferred) or Windows Server\r\n- **Java Version:** Java 8 or higher\r\n- **Network:** Stable network connectivity with sufficient bandwidth\r\n- **High Availability:** Cluster deployment for production environments\r\n\r\n#### Network Requirements\r\n- **Bandwidth:** Minimum 10 Mbps for reliable operation\r\n- **Latency:** Less than 500ms to external systems\r\n- **Uptime:** 99.9% network availability requirement\r\n- **Monitoring:** Network performance monitoring and alerting\r\n- **Redundancy:** Multiple network paths for critical connections\r\n\r\n### Required Resources\r\n\r\n#### Memory Requirements\r\n- **Minimum:** 4GB heap size for standard processing\r\n- **Recommended:** 8GB heap size for production workloads\r\n- **Peak Usage:** 12GB during high-volume processing periods\r\n- **GC Configuration:** G1GC recommended for low latency\r\n\r\n#### CPU Requirements\r\n- **Minimum:** 2 vCPU cores for basic operation\r\n- **Recommended:** 4 vCPU cores for production workloads  \r\n- **Peak Load:** 8 vCPU cores during batch processing\r\n- **Architecture:** x64 architecture required\r\n\r\n#### Storage Requirements\r\n- **Application:** 10GB for integration runtime and artifacts\r\n- **Logs:** 50GB for log retention and audit trails\r\n- **Temporary:** 20GB for temporary file processing\r\n- **Backup:** 100GB for backup and recovery data\r\n- **IOPS:** Minimum 1000 IOPS for optimal performance\r\n\r\n#### Monitoring and Alerting\r\n\r\n#### Process Monitoring\r\n- **Execution Status:** Real-time monitoring of integration execution\r\n- **Throughput Metrics:** Records processed per hour/day\r\n- **Error Rates:** Percentage of failed vs successful executions\r\n- **Response Times:** Average response time from external systems\r\n- **Queue Depth:** Monitoring of message queues and backlogs\r\n\r\n#### Error Alerting\r\n- **Critical Failures:** Immediate alerts for system failures\r\n- **Authentication Issues:** Alerts for expired or invalid credentials\r\n- **Connectivity Problems:** Alerts for network or system unavailability\r\n- **Data Quality Issues:** Alerts for data validation failures\r\n- **Threshold Breaches:** Alerts when error rates exceed thresholds\r\n\r\n#### Performance Metrics\r\n- **Processing Time:** Average time per account processing cycle\r\n- **Memory Usage:** JVM memory utilization and garbage collection\r\n- **CPU Utilization:** Processor usage during peak and average loads\r\n- **Network Throughput:** Data transfer rates to external systems\r\n- **Disk I/O:** Read/write operations for logging and temporary files\r\n\r\n#### Audit Reporting\r\n- **Integration Logs:** Detailed logs of all integration activities\r\n- **Data Access Logs:** Audit trail of data access and modifications\r\n- **Error Logs:** Comprehensive error logging with stack traces\r\n- **Performance Logs:** Historical performance and throughput data\r\n- **Security Logs:** Authentication and authorization events\r\n\r\n## API Reference\r\n\r\n### Complete Endpoint Reference\r\n\r\n#### Salesforce Query API\r\n\r\n**Endpoint:** `GET /services/data/v52.0/query`\r\n\r\n**Purpose:** Query Salesforce accounts for processing\r\n\r\n**Authentication:** Bearer token (OAuth 2.0)\r\n\r\n**Query Parameters:**\r\n| Parameter | Type | Required | Default | Description | Example Value |\r\n|-----------|------|----------|---------|-------------|---------------|\r\n| `q` | String | Yes | None | SOQL query string | `SELECT Id, Name FROM Account WHERE CreatedDate = TODAY` |\r\n\r\n**Request Headers:**\r\n- `Authorization: Bearer <access_token>`\r\n- `Accept: application/json`\r\n- `Content-Type: application/json`\r\n\r\n**Response Schema:**\r\n```json\r\n{\r\n  \"totalSize\": \"integer\",\r\n  \"done\": \"boolean\",\r\n  \"records\": [\r\n    {\r\n      \"Id\": \"string\",\r\n      \"Name\": \"string\", \r\n      \"BillingStreet\": \"string\",\r\n      \"BillingCity\": \"string\",\r\n      \"BillingState\": \"string\",\r\n      \"BillingPostalCode\": \"string\",\r\n      \"BillingCountry\": \"string\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n**Response Status Codes:**\r\n- `200 OK`: Successful query execution\r\n- `400 Bad Request`: Invalid SOQL query\r\n- `401 Unauthorized`: Invalid or expired access token\r\n- `403 Forbidden`: Insufficient permissions\r\n- `500 Internal Server Error`: Salesforce system error\r\n\r\n#### SAP Customer Creation API\r\n\r\n**Endpoint:** `POST /sap/opu/odata/iwbep/gwsample_basic/BAPI_CUSTOMER_CREATEFROMDATA1`\r\n\r\n**Purpose:** Create new customer in SAP system\r\n\r\n**Authentication:** Basic Authentication\r\n\r\n**Request Headers:**\r\n- `Authorization: Basic <base64_credentials>`\r\n- `Content-Type: application/json`\r\n- `Accept: application/json`\r\n\r\n**Request Schema:**\r\n```json\r\n{\r\n  \"IMPORT\": {\r\n    \"I_PI_COMPANYDATA\": {\r\n      \"NAME\": \"string\",\r\n      \"STREET\": \"string\", \r\n      \"CITY\": \"string\",\r\n      \"REGION\": \"string\",\r\n      \"POSTL_COD1\": \"string\",\r\n      \"COUNTRY\": \"string\"\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n**Response Schema:**\r\n```json\r\n{\r\n  \"E_CUSTOMERNO\": \"string\",\r\n  \"RETURN\": {\r\n    \"TYPE\": \"string\",\r\n    \"MESSAGE\": \"string\",\r\n    \"MESSAGE_V1\": \"string\"\r\n  }\r\n}\r\n```\r\n\r\n**Response Status Codes:**\r\n- `200 OK`: Successful customer creation\r\n- `400 Bad Request`: Invalid request data\r\n- `401 Unauthorized`: Invalid credentials\r\n- `500 Internal Server Error`: SAP system error\r\n\r\n#### Salesforce Account Update API\r\n\r\n**Endpoint:** `PATCH /services/data/v52.0/sobjects/Account/{AccountId}`\r\n\r\n**Purpose:** Update Salesforce account with SAP customer number\r\n\r\n**Authentication:** Bearer token (OAuth 2.0)\r\n\r\n**Path Parameters:**\r\n| Parameter | Type | Required | Description | Example |\r\n|-----------|------|----------|-------------|---------|\r\n| `AccountId` | String | Yes | Salesforce Account ID | `001XX000003DHP0` |\r\n\r\n**Request Headers:**\r\n- `Authorization: Bearer <access_token>`\r\n- `Content-Type: application/json`\r\n- `Accept: application/json`\r\n\r\n**Request Schema:**\r\n```json\r\n{\r\n  \"Description\": \"string\",\r\n  \"Name\": \"string\"\r\n}\r\n```\r\n\r\n**Response Status Codes:**\r\n- `204 No Content`: Successful update (no response body)\r\n- `200 OK`: Successful update (with response body)\r\n- `400 Bad Request`: Invalid request data\r\n- `401 Unauthorized`: Invalid or expired access token\r\n- `404 Not Found`: Account ID not found\r\n- `500 Internal Server Error`: Salesforce system error\r\n\r\n### Error Codes and Meanings\r\n\r\n#### Salesforce Error Codes\r\n| Error Code | HTTP Status | Description | Resolution |\r\n|------------|-------------|-------------|------------|\r\n| `INVALID_LOGIN` | 401 | Authentication failure | Verify username, password, and security token |\r\n| `API_DISABLED_FOR_ORG` | 403 | API access disabled | Enable API access in Salesforce setup |\r\n| `REQUEST_LIMIT_EXCEEDED` | 403 | API limit exceeded | Wait for limit reset or increase API limits |\r\n| `INVALID_QUERY_LOCATOR` | 400 | Invalid query syntax | Review and correct SOQL query |\r\n| `INSUFFICIENT_ACCESS` | 403 | Missing permissions | Grant required object permissions |\r\n\r\n#### SAP Error Codes  \r\n| Error Code | HTTP Status | Description | Resolution |\r\n|------------|-------------|-------------|------------|\r\n| `RFC_ERROR_COMMUNICATION` | 500 | Communication error | Check network connectivity to SAP |\r\n| `RFC_ERROR_LOGON_FAILURE` | 401 | Authentication failure | Verify SAP username and password |\r\n| `BAPI_ERROR_MISSING_DATA` | 400 | Required field missing | Ensure all mandatory fields are provided |\r\n| `CUSTOMER_EXISTS` | 400 | Customer already exists | Check for duplicate customer data |\r\n| `AUTHORIZATION_MISSING` | 403 | Missing authorization | Grant customer creation authorization |\r\n\r\n### Rate Limiting Information\r\n\r\n#### Salesforce Rate Limits\r\n- **API Calls:** Based on license type (typically 15,000-100,000 per 24 hours)\r\n- **Concurrent Requests:** Maximum 25 concurrent API requests\r\n- **Bulk API:** Separate limits for bulk operations\r\n- **Reset Period:** 24-hour rolling window\r\n- **Monitoring:** Available in Setup → Company Information\r\n\r\n#### SAP Rate Limits\r\n- **Concurrent Connections:** Based on SAP license and configuration\r\n- **Transaction Limits:** Depends on SAP system capacity\r\n- **CPU Usage:** May be throttled during high system load\r\n- **Memory Allocation:** Limited by SAP system memory configuration\r\n- **Custom Configuration:** Configurable by SAP basis team\r\n\r\n### Versioning Information\r\n\r\n#### API Versioning Strategy\r\n- **Salesforce API:** Version-specific endpoints (v52.0 currently supported)\r\n- **SAP BAPI:** Function-based interface, version depends on SAP release\r\n- **Integration Version:** Semantic versioning (1.0.0)\r\n- **Backward Compatibility:** Maintained for at least 2 major versions\r\n- **Deprecation Notice:** 12-month notice for deprecated features\r\n\r\n#### Supported Versions\r\n- **Salesforce API:** v50.0, v51.0, v52.0 (recommended)\r\n- **SAP NetWeaver:** 7.4 and higher\r\n- **Integration Suite:** Latest supported version\r\n- **Java Runtime:** Java 8, 11 (recommended)",
  "markdown_length": 38093,
  "constructed_query": "Create a complete SAP iFlow integration package named 'IFlow_30f0abe2' with the following requirements from the documentation:\n\n# Salesforce to SAP Customer Integration API\r\n\r\n## Table of Contents\r\n\r\n- [API Overview](#api-overview)\r\n- [Endpoints](#endpoints)\r\n- [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n  - [Process Flow Overview](#process-flow-overview)\r\n  - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n- [Boomi Transformations Explained](#boomi-transformations-explained)\r\n- [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n  - [Component Mapping](#component-mapping)\r\n  - [Integration Flow Visualization](#integration-flow-visualization)\r\n  - [Configuration Details](#configuration-details)\r\n- [Environment Configuration](#environment-configuration)\r\n- [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration enables bi-directional synchronization between Salesforce accounts and SAP customer master data. The API facilitates the creation of new customers in SAP when new accounts are created in Salesforce, and updates the Salesforce account with the generated SAP customer number for reference.\r\n\r\n**Business Purpose:**\r\n- Automatically create SAP customers when new Salesforce accounts are created\r\n- Maintain data consistency between Salesforce CRM and SAP ERP systems\r\n- Enable seamless order-to-cash processes by ensuring customer data exists in both systems\r\n- Provide audit trail with SAP customer numbers stored in Salesforce\r\n\r\n**Base URL/Endpoint Pattern:**\r\n- Salesforce REST API: `https://<instance>.salesforce.com/services/data/v<version>/`\r\n- SAP BAPI Endpoint: `https://<sap-host>:<port>/sap/opu/odata/iwbep/gwsample_basic/`\r\n\r\n**Authentication Mechanisms:**\r\n- Salesforce: OAuth 2.0 or Session ID authentication\r\n- SAP: Basic Authentication or Certificate-based authentication\r\n\r\n**Rate Limiting:**\r\n- Salesforce: Standard API limits apply based on license type\r\n- SAP: Depends on SAP system configuration and licensing\r\n\r\n**General Response Format:**\r\n- Salesforce: JSON format\r\n- SAP BAPI: XML format (converted to JSON by Boo\n\nGenerate a production-ready iFlow with proper:\n1. Start and End events\n2. Required adapters and connectors\n3. Content modifiers and processing steps\n4. Proper sequence flows\n5. Error handling\n6. SAP Integration Suite compliance\n",
  "query_length": 2358,
  "markdown_truncated_at": 2000,
  "api_endpoint": "/api/generate-iflow-from-markdown",
  "request_time": "2025-10-23T18:55:23.476432"
}