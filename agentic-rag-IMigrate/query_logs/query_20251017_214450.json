{
  "timestamp": "20251017_214450",
  "job_id": "7c193b5c-0cc6-49aa-9be4-4a67fd93d071",
  "iflow_name": "IFlow_3c120013",
  "original_markdown": "# Stripe to Salesforce Opportunity Integration API\r\n\r\n## Table of Contents\r\n\r\n- [Stripe to Salesforce Opportunity Integration API](#stripe-to-salesforce-opportunity-integration-api)\r\n  - [Table of Contents](#table-of-contents)\r\n  - [API Overview](#api-overview)\r\n  - [Endpoints](#endpoints)\r\n    - [Stripe Webhook Subscription Completed Event](#stripe-webhook-subscription-completed-event)\r\n    - [Salesforce Opportunity Creation](#salesforce-opportunity-creation)\r\n  - [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n    - [Process Flow Overview](#process-flow-overview)\r\n    - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n      - [**Step 1: Start Event (shape1)**](#step-1-start-event-shape1)\r\n      - [**Step 2: Document Properties (shape6)**](#step-2-document-properties-shape6)\r\n      - [**Step 3: Transform/Map Components (shape4)**](#step-3-transformmap-components-shape4)\r\n      - [**Step 4: Connector Actions (shape3)**](#step-4-connector-actions-shape3)\r\n      - [**Step 5: End Events (shape5)**](#step-5-end-events-shape5)\r\n  - [Boomi Transformations Explained](#boomi-transformations-explained)\r\n    - [Subscription Completed JSON to SF Opportunity CREATE Request XML](#subscription-completed-json-to-sf-opportunity-create-request-xml)\r\n  - [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n    - [Component Mapping](#component-mapping)\r\n      - [Main Process Component Mapping](#main-process-component-mapping)\r\n    - [Integration Flow Visualization](#integration-flow-visualization)\r\n    - [Configuration Details](#configuration-details)\r\n  - [Environment Configuration](#environment-configuration)\r\n  - [API Reference](#api-reference)\r\n    - [Request and Response Schemas](#request-and-response-schemas)\r\n    - [Authentication Requirements](#authentication-requirements)\r\n    - [Error Handling](#error-handling)\r\n\r\n## API Overview\r\n\r\nThis integration creates Salesforce Opportunities from Stripe subscription completion events through a webhook-based real-time synchronization process. The API receives Stripe webhook notifications when subscriptions are completed and automatically creates corresponding sales opportunities in Salesforce with enriched customer and subscription data.\r\n\r\n- **Base URL/Endpoint Pattern:** Webhook receiver endpoint for Stripe subscription events\r\n- **Authentication Mechanisms:** Webhook signature verification for Stripe events, OAuth/Session authentication for Salesforce\r\n- **Rate Limiting Information:** Subject to Stripe webhook delivery limits and Salesforce API limits\r\n- **General Response Format:** JSON for webhook acknowledgment, XML for Salesforce API operations\r\n\r\n## Endpoints\r\n\r\n### Stripe Webhook Subscription Completed Event\r\n\r\n- **HTTP Method:** POST\r\n- **Purpose:** Receives Stripe webhook notifications when subscription events occur\r\n- **Request Parameters:**\r\n  - Headers: `Stripe-Signature` for webhook verification\r\n  - Content-Type: `application/json`\r\n- **Request Body Structure:** Stripe webhook event payload containing subscription completion data\r\n- **Response Format:** HTTP 200 OK for successful processing\r\n- **Error Handling:** Returns appropriate HTTP error codes for processing failures\r\n\r\n### Salesforce Opportunity Creation\r\n\r\n- **HTTP Method:** POST\r\n- **Purpose:** Creates new Opportunity records in Salesforce\r\n- **Request Parameters:**\r\n  - Authorization header with Salesforce session token\r\n  - Content-Type: `application/xml`\r\n- **Request Body Structure:** Salesforce sObject XML structure for Opportunity creation\r\n- **Response Format:** Salesforce API response with created record ID\r\n- **Error Handling:** Salesforce API error responses with detailed error messages\r\n\r\n## Current Boomi Flow Logic\r\n\r\n### Process Flow Overview\r\n\r\nThis Boomi process implements a real-time webhook-to-CRM integration pattern that:\r\n\r\n1. **Listens for Stripe Events:** Receives webhook notifications when Stripe subscriptions are completed\r\n2. **Extracts Customer Data:** Processes subscription information to extract customer and product details\r\n3. **Enriches Data:** Calculates dynamic properties including customer names, descriptions, and close dates\r\n4. **Transforms Data:** Converts JSON webhook payload to Salesforce XML format\r\n5. **Creates Opportunities:** Sends transformed data to Salesforce to create opportunity records\r\n6. **Handles Responses:** Processes Salesforce creation responses and manages error scenarios\r\n\r\n### Step-by-Step Flow Description\r\n\r\n---\r\n\r\n#### **Step 1: Start Event (shape1)**\r\n\r\n**Component Type:** Start Event\r\n\r\n**Purpose:** Webhook listener that receives Stripe subscription completion events in real-time\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** Web Services Server (webhook receiver)\r\n- **Operation:** Listen for HTTP POST requests from Stripe\r\n- **Input Profile:** JSON format containing Stripe subscription event data\r\n- **Trigger Conditions:** Stripe webhook delivery for subscription.completed events\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook JSON payload with subscription and customer information\r\n- **Processing:** Validates webhook signature and parses event data\r\n- **Output:** Structured subscription event data ready for processing\r\n\r\n---\r\n\r\n#### **Step 2: Document Properties (shape6)**\r\n\r\n**Component Type:** Document Properties\r\n\r\n**Purpose:** Calculates and sets dynamic properties for customer name, subscription details, description, and close date\r\n\r\n**Configuration Details:**\r\n\r\n- **Dynamic Properties:** 4 dynamic document properties configured\r\n  - Dynamic Document Property - DDP_CustomerName: Process property: Dynamic Document Property - DDP_CustomerName\r\n  - Dynamic Document Property - DDP_Subscription: Process property: Dynamic Document Property - DDP_Subscription\r\n  - Dynamic Document Property - DDP_SalesforceDescription: Process property: Dynamic Document Property - DDP_SalesforceDescription\r\n  - Dynamic Document Property - DDP_CloseDate: Process property: Dynamic Document Property - DDP_CloseDate\r\n- **HTTP Calls:** Potential external API calls for customer data enrichment\r\n- **Calculations:** Date calculations for opportunity close dates and string concatenations\r\n- **Parameter Mappings:** Source value configurations from incoming webhook data\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook event data from start event\r\n- **Processing:** Extracts customer information, calculates close dates, builds descriptions\r\n- **Output:** Enhanced data with calculated dynamic properties for Salesforce opportunity creation\r\n\r\n---\r\n\r\n#### **Step 3: Transform/Map Components (shape4)**\r\n\r\n**Component Type:** Map/Transform\r\n\r\n**Purpose:** Transforms Stripe subscription JSON data into Salesforce Opportunity XML format\r\n\r\n**Configuration Details:**\r\n\r\n- **Input Profile:** Subscription Completed JSON (Stripe webhook format)\r\n- **Output Profile:** SF Opportunity CREATE Request XML (Salesforce API format)\r\n- **Transformation Logic:** Field mapping from Stripe subscription data to Salesforce opportunity fields\r\n- **Function Steps:** DocumentPropertyGet functions to retrieve calculated dynamic properties\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe subscription JSON with dynamic properties\r\n- **Processing:** Maps fields and applies transformation functions\r\n- **Output:** Salesforce-compatible XML for opportunity creation\r\n\r\n---\r\n\r\n#### **Step 4: Connector Actions (shape3)**\r\n\r\n**Component Type:** Salesforce Connector\r\n\r\n**Purpose:** Creates new Opportunity records in Salesforce using the transformed data\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** Salesforce\r\n- **Operation:** Create operation on Opportunity object\r\n- **Target Object:** Salesforce Opportunity sObject\r\n- **Authentication:** Salesforce OAuth or session-based authentication\r\n- **Error Handling:** Captures Salesforce API errors and response codes\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce Opportunity XML from transformation step\r\n- **Processing:** Executes Salesforce API create operation\r\n- **Output:** Salesforce response with created opportunity ID or error details\r\n\r\n---\r\n\r\n#### **Step 5: End Events (shape5)**\r\n\r\n**Component Type:** End Event\r\n\r\n**Purpose:** Completes the integration process and returns webhook response to Stripe\r\n\r\n**Configuration Details:**\r\n\r\n- **Completion Type:** Success completion after Salesforce opportunity creation\r\n- **Final Actions:** Returns HTTP 200 response to Stripe webhook\r\n- **Continuation Settings:** Process completes after successful execution\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce creation response\r\n- **Processing:** Validates successful opportunity creation\r\n- **Output:** HTTP success response to complete webhook processing\r\n\r\n---\r\n\r\n## Boomi Transformations Explained\r\n\r\n### Subscription Completed JSON to SF Opportunity CREATE Request XML\r\n\r\n**Purpose:** This transformation converts Stripe webhook subscription data into Salesforce Opportunity creation format, enriching the data with calculated properties.\r\n\r\n**Input Profile:** Subscription Completed JSON\r\n- Stripe webhook event structure containing subscription, customer, and product information\r\n- Event type, subscription ID, customer details, and pricing information\r\n- Timestamp and metadata from Stripe event system\r\n\r\n**Output Profile:** SF Opportunity CREATE Request XML\r\n- Salesforce sObject XML structure for Opportunity creation\r\n- Required fields: Name, Description, CloseDate\r\n- Optional fields for additional opportunity details\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| Function Output (DDP_SalesforceDescription) | Opportunity/Description | String | Maps calculated description combining customer and subscription details |\r\n| Function Output (DDP_CustomerName) | Opportunity/Name | String | Maps extracted customer name as opportunity name |\r\n| Function Output (DDP_CloseDate) | Opportunity/CloseDate | Date | Maps calculated close date based on subscription timeline |\r\n\r\n**Function Steps:**\r\n\r\n1. **Get Document Property (DDP_SalesforceDescription):**\r\n   - Retrieves calculated description combining customer name and subscription details\r\n   - Used for Opportunity Description field\r\n\r\n2. **Get Document Property (DDP_CustomerName):**\r\n   - Retrieves extracted customer name from Stripe subscription data\r\n   - Used for Opportunity Name field\r\n\r\n3. **Get Document Property (DDP_CloseDate):**\r\n   - Retrieves calculated close date for the sales opportunity\r\n   - Used for Opportunity CloseDate field\r\n\r\n**Transformation Logic:**\r\n- Extracts customer information from Stripe subscription event\r\n- Applies business rules for opportunity naming and description\r\n- Calculates appropriate close dates based on subscription terms\r\n- Formats data according to Salesforce API requirements\r\n\r\n## SAP Integration Suite Implementation\r\n\r\n### Component Mapping\r\n\r\n#### Main Process Component Mapping\r\n\r\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\r\n|-----------------|----------------------------------|---------|\r\n| Start Event (shape1) | HTTPS Adapter (Sender) with Start Message Event | Receives Stripe webhook notifications for subscription events |\r\n| Document Properties (shape6) | Content Modifier (Set Properties) | Calculates dynamic properties for customer data and close dates |\r\n| Map Transform (shape4) | Message Mapping (JSON to XML) | Transforms Stripe JSON payload to Salesforce XML format |\r\n| Salesforce Connector (shape3) | HTTPS Adapter (Receiver) with Salesforce Authentication | Creates Opportunity records in Salesforce via REST API |\r\n| End Event (shape5) | End Message Event | Completes integration flow and returns webhook response |\r\n\r\n### Integration Flow Visualization\r\n\r\n```mermaid\r\nflowchart TD\r\n%% Define node styles for SAP Integration Suite components\r\nclassDef httpAdapter fill:#87CEEB,stroke:#333,stroke-width:2px\r\nclassDef contentModifier fill:#98FB98,stroke:#333,stroke-width:2px\r\nclassDef mapping fill:#DDA0DD,stroke:#333,stroke-width:2px\r\nclassDef adapter fill:#FFD700,stroke:#333,stroke-width:2px\r\nclassDef event fill:#C0C0C0,stroke:#333,stroke-width:2px\r\nclassDef errorHandler fill:#FFA07A,stroke:#333,stroke-width:2px\r\n\r\n%% Main Integration Flow\r\nStart((\"Start Event\")):::event --> StripeWebhook[\"HTTPS Adapter: Stripe Webhook Receiver\"]:::httpAdapter\r\nStripeWebhook --> SetDynamicProps[\"Content Modifier: Set Dynamic Properties\"]:::contentModifier\r\nSetDynamicProps --> TransformData[\"Message Mapping: JSON to XML Transform\"]:::mapping\r\nTransformData --> SalesforceCreate[\"HTTPS Adapter: Salesforce Opportunity Create\"]:::adapter\r\nSalesforceCreate --> End((\"End Event\")):::event\r\n\r\n%% Dynamic Properties Detail\r\nsubgraph DynamicProperties[\"Dynamic Properties Calculation\"]\r\n    ExtractCustomer[\"Extract Customer Name from Subscription\"]:::contentModifier\r\n    BuildDescription[\"Build Salesforce Description\"]:::contentModifier\r\n    CalcCloseDate[\"Calculate Close Date\"]:::contentModifier\r\n    ExtractCustomer --> BuildDescription\r\n    BuildDescription --> CalcCloseDate\r\nend\r\n\r\n%% Apply styling\r\nclass StripeWebhook,SalesforceCreate httpAdapter\r\nclass SetDynamicProps,ExtractCustomer,BuildDescription,CalcCloseDate contentModifier\r\nclass TransformData mapping\r\nclass Start,End event\r\n```\r\n\r\n### Configuration Details\r\n\r\n**HTTPS Adapter (Stripe Webhook Receiver):**\r\n- **Connection Type:** HTTPS Inbound\r\n- **Authentication:** Webhook signature verification\r\n- **Message Format:** JSON\r\n- **Security:** TLS 1.2 minimum\r\n- **Content Type:** application/json\r\n\r\n**Content Modifier (Dynamic Properties):**\r\n- **Property 1:** DDP_CustomerName - Extract from subscription.customer.name\r\n- **Property 2:** DDP_Subscription - Extract subscription ID and details\r\n- **Property 3:** DDP_SalesforceDescription - Concatenate customer and subscription information\r\n- **Property 4:** DDP_CloseDate - Calculate based on subscription start date plus standard sales cycle\r\n\r\n**Message Mapping (JSON to XML):**\r\n- **Source Message:** Stripe Subscription JSON schema\r\n- **Target Message:** Salesforce Opportunity XML schema\r\n- **Mapping Functions:** Property retrieval and field transformation\r\n\r\n**HTTPS Adapter (Salesforce):**\r\n- **Connection Type:** HTTPS Outbound\r\n- **Authentication:** OAuth 2.0 or Session-based\r\n- **Target Endpoint:** Salesforce REST API /services/data/vXX.0/sobjects/Opportunity/\r\n- **Message Format:** XML\r\n- **Operation:** POST (Create)\r\n\r\n## Environment Configuration\r\n\r\n**Required Parameters:**\r\n- **Stripe Webhook Endpoint:** Public HTTPS endpoint for receiving webhooks\r\n- **Stripe Webhook Secret:** For signature verification\r\n- **Salesforce Instance URL:** Target Salesforce organization\r\n- **Salesforce Credentials:** Username, password, and security token for authentication\r\n\r\n**Environment Variables:**\r\n- `STRIPE_WEBHOOK_SECRET`: Webhook signature verification key\r\n- `SALESFORCE_CLIENT_ID`: Connected app client ID\r\n- `SALESFORCE_CLIENT_SECRET`: Connected app client secret\r\n- `SALESFORCE_USERNAME`: Service account username\r\n- `SALESFORCE_PASSWORD`: Service account password\r\n- `SALESFORCE_SECURITY_TOKEN`: User security token\r\n\r\n**Dependencies on External Systems:**\r\n- **Stripe:** Webhook delivery system for subscription events\r\n- **Salesforce:** CRM system for opportunity record creation\r\n- **Network:** Reliable internet connectivity for real-time processing\r\n\r\n**Security Settings:**\r\n- **TLS/SSL:** All connections require TLS 1.2 or higher\r\n- **Authentication:** OAuth 2.0 for Salesforce, signature verification for Stripe\r\n- **Network Security:** Firewall rules for webhook endpoint access\r\n\r\n**Deployment Considerations:**\r\n- **High Availability:** Deploy in multiple availability zones\r\n- **Scalability:** Auto-scaling for webhook processing peaks\r\n- **Monitoring:** Real-time monitoring for webhook processing delays\r\n\r\n**Required Resources:**\r\n- **Memory:** 2GB minimum for JSON/XML processing\r\n- **CPU:** 2 cores minimum for transformation operations\r\n- **Storage:** Minimal temporary storage for message processing\r\n- **Network:** Low latency connection to Salesforce and Stripe\r\n\r\n## API Reference\r\n\r\n**Complete Endpoint List:**\r\n- `POST /stripe-webhook`: Receives Stripe subscription completion events\r\n- `POST /services/data/vXX.0/sobjects/Opportunity/`: Creates Salesforce opportunities\r\n\r\n**Request Schema (Stripe Webhook):**\r\n```json\r\n{\r\n  \"id\": \"evt_subscription_completed\",\r\n  \"object\": \"event\",\r\n  \"type\": \"subscription.completed\",\r\n  \"data\": {\r\n    \"object\": {\r\n      \"id\": \"sub_subscription_id\",\r\n      \"customer\": \"cus_customer_id\",\r\n      \"status\": \"active\"\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n**Response Schema (Salesforce):**\r\n```xml\r\n<soapenv:Envelope>\r\n  <soapenv:Body>\r\n    <createResponse>\r\n      <result>\r\n        <id>003XXXXXXXXXXXXXXX</id>\r\n        <success>true</success>\r\n      </result>\r\n    </createResponse>\r\n  </soapenv:Body>\r\n</soapenv:Envelope>\r\n```\r\n\r\n### Request and Response Schemas\r\n\r\n**Stripe Webhook Request:**\r\n- **Content-Type:** application/json\r\n- **Headers:** Stripe-Signature for verification\r\n- **Body:** Event object with subscription data\r\n\r\n**Salesforce API Response:**\r\n- **Content-Type:** application/xml\r\n- **Body:** Creation result with record ID\r\n- **Status Codes:** 200 for success, 400+ for errors\r\n\r\n### Authentication Requirements\r\n\r\n**Stripe Webhook Authentication:**\r\n- Webhook signature verification using shared secret\r\n- HMAC-SHA256 signature validation\r\n\r\n**Salesforce Authentication:**\r\n- OAuth 2.0 client credentials flow\r\n- Session-based authentication as alternative\r\n- Security token required for username/password authentication\r\n\r\n### Error Handling\r\n\r\n**HTTP Status Codes:**\r\n- `200 OK`: Successful webhook processing\r\n- `400 Bad Request`: Invalid webhook payload\r\n- `401 Unauthorized`: Authentication failure\r\n- `422 Unprocessable Entity`: Salesforce validation errors\r\n- `500 Internal Server Error`: Processing failures\r\n\r\n**Error Response Format:**\r\n```json\r\n{\r\n  \"error\": {\r\n    \"code\": \"PROCESSING_ERROR\",\r\n    \"message\": \"Failed to create Salesforce opportunity\",\r\n    \"details\": \"Validation error on required field\"\r\n  }\r\n}\r\n```\r\n\r\n**Rate Limiting:**\r\n- Stripe webhook delivery: Standard webhook limits apply\r\n- Salesforce API: Subject to organization's API limits (typically 15,000-100,000+ calls per 24 hours)",
  "markdown_length": 18329,
  "constructed_query": "Create a complete SAP iFlow integration package named 'IFlow_3c120013' with the following requirements from the documentation:\n\n# Stripe to Salesforce Opportunity Integration API\r\n\r\n## Table of Contents\r\n\r\n- [Stripe to Salesforce Opportunity Integration API](#stripe-to-salesforce-opportunity-integration-api)\r\n  - [Table of Contents](#table-of-contents)\r\n  - [API Overview](#api-overview)\r\n  - [Endpoints](#endpoints)\r\n    - [Stripe Webhook Subscription Completed Event](#stripe-webhook-subscription-completed-event)\r\n    - [Salesforce Opportunity Creation](#salesforce-opportunity-creation)\r\n  - [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n    - [Process Flow Overview](#process-flow-overview)\r\n    - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n      - [**Step 1: Start Event (shape1)**](#step-1-start-event-shape1)\r\n      - [**Step 2: Document Properties (shape6)**](#step-2-document-properties-shape6)\r\n      - [**Step 3: Transform/Map Components (shape4)**](#step-3-transformmap-components-shape4)\r\n      - [**Step 4: Connector Actions (shape3)**](#step-4-connector-actions-shape3)\r\n      - [**Step 5: End Events (shape5)**](#step-5-end-events-shape5)\r\n  - [Boomi Transformations Explained](#boomi-transformations-explained)\r\n    - [Subscription Completed JSON to SF Opportunity CREATE Request XML](#subscription-completed-json-to-sf-opportunity-create-request-xml)\r\n  - [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n    - [Component Mapping](#component-mapping)\r\n      - [Main Process Component Mapping](#main-process-component-mapping)\r\n    - [Integration Flow Visualization](#integration-flow-visualization)\r\n    - [Configuration Details](#configuration-details)\r\n  - [Environment Configuration](#environment-configuration)\r\n  - [API Reference](#api-reference)\r\n    - [Request and Response Schemas](#request-and-response-schemas)\r\n    - [Authentication Requirements](#authentication-requirements)\r\n    - [Error Handling](#error-handling)\r\n\r\n## API Overview\r\n\r\nThis integration creates Salesforce Opportunities from Stripe subscription completion events th\n\nGenerate a production-ready iFlow with proper:\n1. Start and End events\n2. Required adapters and connectors\n3. Content modifiers and processing steps\n4. Proper sequence flows\n5. Error handling\n6. SAP Integration Suite compliance\n",
  "query_length": 2358,
  "markdown_truncated_at": 2000,
  "api_endpoint": "/api/generate-iflow-from-markdown",
  "request_time": "2025-10-17T21:44:50.911764"
}