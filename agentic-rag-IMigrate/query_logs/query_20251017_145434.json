{
  "timestamp": "20251017_145434",
  "job_id": "4a1fca59-a377-4250-a7d4-ca65047ed89b",
  "iflow_name": "IFlow_e824ad28",
  "original_markdown": "# Create Salesforce Opportunities from Stripe Subscriptions Integration\r\n\r\n## Table of Contents\r\n\r\n1. [API Overview](#api-overview)\r\n2. [Endpoints](#endpoints)\r\n3. [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n   - [Process Flow Overview](#process-flow-overview)\r\n   - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n4. [Boomi Transformations Explained](#boomi-transformations-explained)\r\n5. [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n   - [Component Mapping](#component-mapping)\r\n   - [Integration Flow Visualization](#integration-flow-visualization)\r\n   - [Configuration Details](#configuration-details)\r\n6. [Environment Configuration](#environment-configuration)\r\n7. [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration creates Salesforce opportunities automatically from Stripe subscription completion events. The process listens for Stripe webhook events, transforms the subscription data into Salesforce-compatible format, and creates opportunity records in Salesforce CRM.\r\n\r\n**Base URL/Endpoint Pattern:**\r\n- Webhook Listener: Stripe webhook endpoint for subscription events\r\n- Salesforce API: Standard Salesforce REST API for opportunity creation\r\n\r\n**Authentication Mechanisms:**\r\n- Webhook Authentication: Stripe webhook signature validation\r\n- Salesforce Authentication: OAuth 2.0 or username/password authentication\r\n\r\n**General Response Format:**\r\n- Input: JSON from Stripe webhook (subscription completion events)\r\n- Output: XML request to Salesforce for opportunity creation\r\n\r\n## Endpoints\r\n\r\n### Stripe Webhook Listener\r\n- **HTTP Method:** POST\r\n- **Purpose:** Receives Stripe subscription completion webhook events\r\n- **Request Parameters:** \r\n  - Headers: Stripe-Signature for webhook validation\r\n  - Body: JSON payload containing subscription details\r\n- **Request Body Structure:** Stripe subscription completion event JSON\r\n- **Response Format:** HTTP 200 OK acknowledgment\r\n- **Error Handling:** Standard webhook error responses for invalid signatures or malformed data\r\n\r\n### Salesforce Opportunity Creation\r\n- **HTTP Method:** POST\r\n- **Purpose:** Creates new opportunity records in Salesforce\r\n- **Request Parameters:**\r\n  - Headers: Authorization, Content-Type: application/xml\r\n- **Request Body Structure:** XML format for Salesforce opportunity object\r\n- **Response Format:** Salesforce API response with created opportunity ID\r\n- **Error Handling:** Salesforce API error codes and messages\r\n\r\n## Current Boomi Flow Logic\r\n\r\n### Process Flow Overview\r\n\r\nThe Boomi process implements an event-driven integration pattern that:\r\n1. Listens for Stripe subscription completion webhook events\r\n2. Extracts customer and subscription details from the webhook payload\r\n3. Sets dynamic document properties for data enrichment\r\n4. Transforms JSON webhook data to Salesforce XML format\r\n5. Creates opportunity records in Salesforce CRM\r\n\r\n### Step-by-Step Flow Description\r\n\r\n---\r\n\r\n#### **Step 1: Start Event (shape1)**\r\n\r\n**Component Type:** Start Event\r\n\r\n**Purpose:** Initiates the integration process when Stripe webhook events are received\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** Event Listener (Webhook)\r\n- **Operation:** Listen for incoming HTTP POST requests\r\n- **Input Profile:** JSON webhook payload from Stripe\r\n- **Trigger Conditions:** Stripe subscription completion events\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook JSON containing subscription and customer data\r\n- **Processing:** Event validation and initial data capture\r\n- **Output:** Raw webhook payload passed to document properties component\r\n\r\n---\r\n\r\n#### **Step 2: Document Properties (shape6)**\r\n\r\n**Component Type:** Document Properties\r\n\r\n**Purpose:** Set dynamic properties for data enrichment and transformation logic\r\n\r\n**Configuration Details:**\r\n\r\n- **Dynamic Properties:** 4 dynamic document properties configured\r\n  - Dynamic Document Property - DDP_CustomerName: Process property: Dynamic Document Property - DDP_CustomerName\r\n  - Dynamic Document Property - DDP_Subscription: Process property: Dynamic Document Property - DDP_Subscription  \r\n  - Dynamic Document Property - DDP_SalesforceDescription: Process property: Dynamic Document Property - DDP_SalesforceDescription\r\n  - Additional dynamic property for close date calculation\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Raw Stripe webhook JSON payload\r\n- **Processing:** Extract customer name, subscription details, and calculate derived values\r\n- **Output:** Enhanced data with calculated properties for downstream transformation\r\n\r\n---\r\n\r\n#### **Step 3: Transform/Map Components (shape4)**\r\n\r\n**Component Type:** Map/Transform\r\n\r\n**Purpose:** Transform Stripe subscription JSON to Salesforce opportunity XML format\r\n\r\n**Configuration Details:**\r\n\r\n- **Input Profile:** Subscription Completed JSON\r\n- **Output Profile:** SF Opportunity CREATE Request XML\r\n- **Transformation Logic:** JSON to XML conversion with field mapping\r\n- **Function Steps:** DocumentPropertyGet functions for dynamic values\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| Dynamic Property - DDP_SalesforceDescription | Opportunity/Description | String | Maps calculated description to opportunity description field |\r\n| Dynamic Property - DDP_CustomerName | Opportunity/Name | String | Maps customer name to opportunity name field |\r\n| Dynamic Property - DDP_CloseDate | Opportunity/CloseDate | Date | Maps calculated close date to opportunity close date field |\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook JSON with dynamic properties\r\n- **Processing:** Field mapping and data type conversion from JSON to XML\r\n- **Output:** Salesforce-compatible XML for opportunity creation\r\n\r\n---\r\n\r\n#### **Step 4: Connector Actions (shape3)**\r\n\r\n**Component Type:** Salesforce Connector\r\n\r\n**Purpose:** Create opportunity records in Salesforce CRM system\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** Salesforce\r\n- **Operation:** Create\r\n- **Target Object:** Opportunity\r\n- **Authentication:** Salesforce authentication credentials\r\n- **Error Handling:** Salesforce API error processing\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** XML formatted opportunity creation request\r\n- **Processing:** Salesforce API call to create opportunity record\r\n- **Output:** Salesforce response with created opportunity ID or error details\r\n\r\n---\r\n\r\n#### **Step 5: End Events (shape5)**\r\n\r\n**Component Type:** End Event\r\n\r\n**Purpose:** Complete the integration process after successful opportunity creation\r\n\r\n**Configuration Details:**\r\n\r\n- **Completion Type:** Success completion after Salesforce record creation\r\n- **Final Actions:** Process completion and cleanup\r\n- **Continuation Settings:** Process ends after successful execution\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce API response\r\n- **Processing:** Final status validation and cleanup\r\n- **Output:** Process completion status\r\n\r\n## Boomi Transformations Explained\r\n\r\n### Subscription Completed JSON to SF Opportunity CREATE Request XML\r\n\r\n**Input Profile:** Subscription Completed JSON\r\n- Stripe webhook event structure containing subscription and customer details\r\n- JSON format with nested objects for customer, subscription, and pricing information\r\n\r\n**Output Profile:** SF Opportunity CREATE Request XML  \r\n- Salesforce opportunity object structure in XML format\r\n- Contains required fields: Name, Description, CloseDate for opportunity creation\r\n\r\n**Transformation Functions:**\r\n\r\n1. **Get Document Property (DDP_SalesforceDescription)**\r\n   - **Purpose:** Retrieves calculated description for the opportunity\r\n   - **Function Type:** DocumentPropertyGet\r\n   - **Output:** Formatted description combining customer and subscription details\r\n\r\n2. **Get Document Property (DDP_CustomerName)**\r\n   - **Purpose:** Retrieves customer name from processed webhook data\r\n   - **Function Type:** DocumentPropertyGet  \r\n   - **Output:** Customer name for opportunity naming\r\n\r\n3. **Get Document Property (DDP_CloseDate)**\r\n   - **Purpose:** Retrieves calculated close date for the opportunity\r\n   - **Function Type:** DocumentPropertyGet\r\n   - **Output:** Calculated close date based on business rules\r\n\r\n**Complete Field Mappings:**\r\n\r\n| Function Output | Target Field | Data Type | Business Purpose |\r\n|-----------------|--------------|-----------|------------------|\r\n| DDP_SalesforceDescription Function | Opportunity/Description | String | Provides detailed opportunity description from subscription data |\r\n| DDP_CustomerName Function | Opportunity/Name | String | Sets opportunity name based on customer information |\r\n| DDP_CloseDate Function | Opportunity/CloseDate | Date | Establishes opportunity close date from subscription timeline |\r\n\r\n**Transformation Logic:**\r\n- JSON subscription data is processed through document properties\r\n- Dynamic properties calculate derived values from webhook payload\r\n- Function steps retrieve calculated properties for field mapping\r\n- XML output structure matches Salesforce opportunity creation requirements\r\n\r\n## SAP Integration Suite Implementation\r\n\r\n### Component Mapping\r\n\r\n#### Main Process Component Mapping\r\n\r\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\r\n|-----------------|----------------------------------|---------|\r\n| Start Event (shape1) | Start Message Event | Initiates integration flow when webhook events are received |\r\n| Document Properties (shape6) | Content Modifier (Set Properties) | Sets dynamic properties for data enrichment and calculations |\r\n| Transform/Map (shape4) | Message Mapping | Transforms JSON webhook data to Salesforce XML format |\r\n| Salesforce Connector (shape3) | Request Reply with Salesforce Adapter | Creates opportunity records in Salesforce CRM |\r\n| End Event (shape5) | End Message Event | Completes the integration flow after successful processing |\r\n\r\n### Integration Flow Visualization\r\n\r\n```mermaid\r\nflowchart TD\r\n    %% Define node styles for SAP Integration Suite components\r\n    classDef httpAdapter fill:#87CEEB,stroke:#333,stroke-width:2px\r\n    classDef contentModifier fill:#98FB98,stroke:#333,stroke-width:2px\r\n    classDef mapping fill:#DDA0DD,stroke:#333,stroke-width:2px\r\n    classDef adapter fill:#FFD700,stroke:#333,stroke-width:2px\r\n    classDef event fill:#C0C0C0,stroke:#333,stroke-width:2px\r\n\r\n    %% Main Integration Flow\r\n    Start((Start Message Event)) --> StripeWebhook[\"HTTPS Adapter: Stripe Webhook Receiver\"]:::httpAdapter\r\n    StripeWebhook --> SetDynamicProps[\"Content Modifier: Set Dynamic Properties\"]:::contentModifier\r\n    SetDynamicProps --> TransformData[\"Message Mapping: JSON to XML Transform\"]:::mapping\r\n    TransformData --> SalesforceCreate[\"Request Reply: Salesforce Adapter\"]:::adapter\r\n    SalesforceCreate --> End((End Message Event)):::event\r\n\r\n    %% Dynamic Properties Detail\r\n    subgraph DynamicProperties[\"Dynamic Properties Calculation\"]\r\n        ExtractCustomer[Extract Customer Name from Webhook]:::contentModifier\r\n        ExtractSubscription[Extract Subscription Details]:::contentModifier\r\n        BuildDescription[Build Salesforce Description]:::contentModifier\r\n        CalcCloseDate[Calculate Close Date]:::contentModifier\r\n    end\r\n\r\n    %% Apply styling\r\n    class StripeWebhook httpAdapter\r\n    class SetDynamicProps,ExtractCustomer,ExtractSubscription,BuildDescription,CalcCloseDate contentModifier\r\n    class TransformData mapping\r\n    class SalesforceCreate adapter\r\n    class Start,End event\r\n```\r\n\r\n### Configuration Details\r\n\r\n**HTTPS Adapter (Stripe Webhook Receiver):**\r\n- **Address:** Webhook endpoint URL for Stripe events\r\n- **Method:** POST\r\n- **Authentication:** Stripe webhook signature validation\r\n- **Content Type:** application/json\r\n\r\n**Content Modifier (Set Dynamic Properties):**\r\n- **Property Name:** DDP_CustomerName\r\n- **Property Value:** ${json-unit($.data.object.customer.name)}\r\n- **Property Name:** DDP_Subscription\r\n- **Property Value:** ${json-unit($.data.object.id)}\r\n- **Property Name:** DDP_SalesforceDescription\r\n- **Property Value:** Subscription ${property.DDP_Subscription} for customer ${property.DDP_CustomerName}\r\n- **Property Name:** DDP_CloseDate\r\n- **Property Value:** ${date:now:yyyy-MM-dd}\r\n\r\n**Message Mapping Configuration:**\r\n- **Source Message Type:** JSON (Stripe webhook format)\r\n- **Target Message Type:** XML (Salesforce opportunity format)\r\n- **Mapping Functions:** Use ${property.PropertyName} for dynamic property access\r\n\r\n**Request Reply (Salesforce Adapter):**\r\n- **Operation:** Create\r\n- **Object Type:** Opportunity\r\n- **Authentication:** OAuth 2.0 or Username/Password\r\n- **Endpoint:** Salesforce REST API or SOAP API\r\n\r\n## Environment Configuration\r\n\r\n**Required Parameters:**\r\n- **Stripe Webhook Secret:** For webhook signature validation\r\n- **Salesforce Credentials:** Username, password, security token for authentication\r\n- **Salesforce Endpoint:** Production or sandbox Salesforce instance URL\r\n\r\n**Environment Variables:**\r\n| Variable | Description | Example Value |\r\n|----------|-------------|---------------|\r\n| STRIPE_WEBHOOK_SECRET | Stripe webhook signing secret | whsec_1234567890abcdef |\r\n| SF_USERNAME | Salesforce username | integration@company.com |\r\n| SF_PASSWORD | Salesforce password | SecurePassword123 |\r\n| SF_SECURITY_TOKEN | Salesforce security token | AbCdEfGhIjKlMnOpQrSt |\r\n| SF_ENDPOINT | Salesforce instance URL | https://company.my.salesforce.com |\r\n\r\n**Dependencies on External Systems:**\r\n- **Stripe:** Webhook endpoint availability and proper event configuration\r\n- **Salesforce:** API access and opportunity object permissions\r\n- **Network:** HTTPS connectivity to both Stripe and Salesforce\r\n\r\n**Security Settings:**\r\n- **TLS/SSL:** Required for all external communications\r\n- **Webhook Validation:** Stripe signature verification mandatory\r\n- **Salesforce Security:** IP restrictions and API access controls\r\n\r\n**Deployment Considerations:**\r\n- **Runtime Environment:** SAP Integration Suite Cloud\r\n- **Memory Requirements:** 2GB minimum for JSON/XML processing\r\n- **CPU Requirements:** 2 cores for concurrent webhook processing\r\n- **Network Requirements:** Stable internet connectivity for cloud services\r\n\r\n## API Reference\r\n\r\n### Stripe Webhook API\r\n\r\n**Endpoint:** POST /webhook/stripe\r\n**Purpose:** Receives Stripe subscription completion events\r\n\r\n**Request Headers:**\r\n| Header | Type | Required | Description |\r\n|--------|------|----------|-------------|\r\n| Stripe-Signature | String | Yes | Webhook signature for validation |\r\n| Content-Type | String | Yes | application/json |\r\n\r\n**Request Body Schema:**\r\n```json\r\n{\r\n  \"id\": \"evt_subscription_completed\",\r\n  \"object\": \"event\",\r\n  \"data\": {\r\n    \"object\": {\r\n      \"id\": \"sub_1234567890\",\r\n      \"customer\": {\r\n        \"id\": \"cus_1234567890\",\r\n        \"name\": \"Customer Name\",\r\n        \"email\": \"customer@example.com\"\r\n      },\r\n      \"status\": \"active\",\r\n      \"current_period_start\": 1234567890,\r\n      \"current_period_end\": 1234567890\r\n    }\r\n  },\r\n  \"type\": \"customer.subscription.created\"\r\n}\r\n```\r\n\r\n**Response Codes:**\r\n- **200 OK:** Webhook processed successfully\r\n- **400 Bad Request:** Invalid webhook signature or malformed data\r\n- **500 Internal Server Error:** Processing error\r\n\r\n### Salesforce Opportunity API\r\n\r\n**Endpoint:** POST /services/data/v58.0/sobjects/Opportunity/\r\n**Purpose:** Creates new opportunity records\r\n\r\n**Request Headers:**\r\n| Header | Type | Required | Description |\r\n|--------|------|----------|-------------|\r\n| Authorization | String | Yes | Bearer token or session ID |\r\n| Content-Type | String | Yes | application/xml |\r\n\r\n**Request Body Schema:**\r\n```xml\r\n<Opportunity>\r\n    <Name>Opportunity Name</Name>\r\n    <Description>Opportunity Description</Description>\r\n    <CloseDate>2024-12-31</CloseDate>\r\n    <StageName>Prospecting</StageName>\r\n</Opportunity>\r\n```\r\n\r\n**Response Schema:**\r\n```json\r\n{\r\n  \"id\": \"006xx000004TmiQAAS\",\r\n  \"success\": true,\r\n  \"errors\": []\r\n}\r\n```\r\n\r\n**Error Codes:**\r\n- **201 Created:** Opportunity created successfully\r\n- **400 Bad Request:** Invalid field values or missing required fields\r\n- **401 Unauthorized:** Authentication failure\r\n- **403 Forbidden:** Insufficient permissions\r\n- **500 Internal Server Error:** Salesforce internal error\r\n\r\n**Rate Limiting:**\r\n- Standard Salesforce API limits apply (typically 100,000 API calls per 24 hours for unlimited edition)\r\n\r\n**Versioning:**\r\n- Uses Salesforce REST API v58.0 or latest available version",
  "markdown_length": 16530,
  "constructed_query": "Create a complete SAP iFlow integration package named 'IFlow_e824ad28' with the following requirements from the documentation:\n\n# Create Salesforce Opportunities from Stripe Subscriptions Integration\r\n\r\n## Table of Contents\r\n\r\n1. [API Overview](#api-overview)\r\n2. [Endpoints](#endpoints)\r\n3. [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n   - [Process Flow Overview](#process-flow-overview)\r\n   - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n4. [Boomi Transformations Explained](#boomi-transformations-explained)\r\n5. [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n   - [Component Mapping](#component-mapping)\r\n   - [Integration Flow Visualization](#integration-flow-visualization)\r\n   - [Configuration Details](#configuration-details)\r\n6. [Environment Configuration](#environment-configuration)\r\n7. [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration creates Salesforce opportunities automatically from Stripe subscription completion events. The process listens for Stripe webhook events, transforms the subscription data into Salesforce-compatible format, and creates opportunity records in Salesforce CRM.\r\n\r\n**Base URL/Endpoint Pattern:**\r\n- Webhook Listener: Stripe webhook endpoint for subscription events\r\n- Salesforce API: Standard Salesforce REST API for opportunity creation\r\n\r\n**Authentication Mechanisms:**\r\n- Webhook Authentication: Stripe webhook signature validation\r\n- Salesforce Authentication: OAuth 2.0 or username/password authentication\r\n\r\n**General Response Format:**\r\n- Input: JSON from Stripe webhook (subscription completion events)\r\n- Output: XML request to Salesforce for opportunity creation\r\n\r\n## Endpoints\r\n\r\n### Stripe Webhook Listener\r\n- **HTTP Method:** POST\r\n- **Purpose:** Receives Stripe subscription completion webhook events\r\n- **Request Parameters:** \r\n  - Headers: Stripe-Signature for webhook validation\r\n  - Body: JSON payload containing subscription details\r\n- **Request Body Structure:** Stripe subscription completion event JSON\r\n- **Response Format:** HTTP 200 OK acknowledgment\r\n- **Error Handling:** S\n\nGenerate a production-ready iFlow with proper:\n1. Start and End events\n2. Required adapters and connectors\n3. Content modifiers and processing steps\n4. Proper sequence flows\n5. Error handling\n6. SAP Integration Suite compliance\n",
  "query_length": 2358,
  "markdown_truncated_at": 2000,
  "api_endpoint": "/api/generate-iflow-from-markdown",
  "request_time": "2025-10-17T14:54:34.100898"
}