{
  "timestamp": "20251017_144627",
  "job_id": "adc6f343-3e61-4255-a12d-3afd12e757f9",
  "iflow_name": "IFlow_979a8fb5",
  "original_markdown": "# Create Salesforce Opportunities from Stripe Subscriptions Integration\r\n\r\n## Table of Contents\r\n\r\n- [API Overview](#api-overview)\r\n- [Endpoints](#endpoints)\r\n- [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n  - [Process Flow Overview](#process-flow-overview)\r\n  - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n    - [Step 1: Start Event (shape1)](#step-1-start-event-shape1)\r\n    - [Step 2: Document Properties (shape6)](#step-2-document-properties-shape6)\r\n    - [Step 3: Transform/Map Component (shape4)](#step-3-transformmap-component-shape4)\r\n    - [Step 4: Connector Action (shape3)](#step-4-connector-action-shape3)\r\n    - [Step 5: End Event (shape5)](#step-5-end-event-shape5)\r\n- [Boomi Transformations Explained](#boomi-transformations-explained)\r\n- [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n  - [Component Mapping](#component-mapping)\r\n  - [Integration Flow Visualization](#integration-flow-visualization)\r\n  - [Configuration Details](#configuration-details)\r\n- [Environment Configuration](#environment-configuration)\r\n- [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration creates Salesforce Opportunities automatically based on completed Stripe subscription events. The process handles incoming Stripe webhook events, transforms the subscription data into Salesforce-compatible format, and creates new opportunity records in Salesforce.\r\n\r\n**Business Purpose:** Streamline the sales pipeline by automatically converting successful Stripe subscriptions into trackable Salesforce opportunities, ensuring no revenue opportunities are missed and maintaining data consistency between payment and CRM systems.\r\n\r\n**Integration Pattern:** Event-driven integration using webhook listeners for real-time processing.\r\n\r\n**Key Features:**\r\n- Real-time webhook processing from Stripe\r\n- Dynamic property calculation for opportunity fields\r\n- Automatic Salesforce opportunity creation\r\n- Error handling and logging\r\n\r\n## Endpoints\r\n\r\n### Stripe Webhook Listener\r\n- **HTTP Method:** POST\r\n- **Purpose:** Receives Stripe subscription completion webhook events\r\n- **Request Format:** JSON payload from Stripe webhook\r\n- **Response Format:** HTTP status codes indicating processing success/failure\r\n- **Authentication:** Webhook signature verification (implementation-dependent)\r\n\r\n### Salesforce Opportunity Creation\r\n- **API:** Salesforce REST API\r\n- **Object:** Opportunity\r\n- **Operation:** CREATE\r\n- **Purpose:** Creates new opportunity records in Salesforce\r\n- **Authentication:** OAuth 2.0 or username/password authentication\r\n\r\n## Current Boomi Flow Logic\r\n\r\n### Process Flow Overview\r\n\r\nThis Boomi process implements a webhook-driven integration that:\r\n\r\n1. **Listens for Events:** Receives Stripe subscription completion webhook events\r\n2. **Calculates Properties:** Sets dynamic document properties for opportunity fields\r\n3. **Transforms Data:** Converts Stripe JSON format to Salesforce XML format\r\n4. **Creates Records:** Sends transformed data to Salesforce to create opportunities\r\n5. **Handles Responses:** Processes Salesforce response and completes the flow\r\n\r\nThe integration follows an event-driven pattern where Stripe webhook events trigger the automatic creation of corresponding Salesforce opportunities with calculated field values.\r\n\r\n### Step-by-Step Flow Description\r\n\r\n---\r\n\r\n#### **Step 1: Start Event (shape1)**\r\n\r\n**Component Type:** Start Event\r\n\r\n**Purpose:** Initiates the integration process when triggered by incoming webhook events\r\n\r\n**Configuration Details:**\r\n\r\n- **Trigger Type:** Event Listener (webhook receiver)\r\n- **Input Format:** JSON payload from Stripe webhook\r\n- **Activation:** Triggered by external webhook calls\r\n- **Concurrent Processing:** Supports multiple simultaneous webhook events\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe subscription completion webhook JSON payload\r\n- **Processing:** Receives and validates incoming webhook data\r\n- **Output:** Raw Stripe subscription data for further processing\r\n\r\n---\r\n\r\n#### **Step 2: Document Properties (shape6)**\r\n\r\n**Component Type:** Document Properties - Set Dynamic Properties\r\n\r\n**Purpose:** Calculates and sets dynamic document properties required for Salesforce opportunity creation\r\n\r\n**Configuration Details:**\r\n\r\n- **Dynamic Properties Set:** 4 dynamic properties calculated and stored\r\n  - **Dynamic Document Property - DDP_CustomerName:** Customer name extraction and formatting\r\n  - **Dynamic Document Property - DDP_Subscription:** Subscription details processing  \r\n  - **Dynamic Document Property - DDP_SalesforceDescription:** Description field calculation\r\n  - **Additional Property:** One additional property configuration\r\n\r\n**Property Calculations:**\r\n\r\n| Property Name | Source Configuration | Business Purpose |\r\n|---------------|---------------------|------------------|\r\n| DDP_CustomerName | Process property: Dynamic Document Property - DDP_CustomerName | Customer identification for opportunity |\r\n| DDP_Subscription | Process property: Dynamic Document Property - DDP_Subscription | Subscription reference data |\r\n| DDP_SalesforceDescription | Process property: Dynamic Document Property - DDP_SalesforceDescription | Opportunity description field |\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Raw Stripe webhook JSON data\r\n- **Processing:** Extracts customer information, subscription details, and calculates derived properties\r\n- **Output:** Enhanced data with calculated dynamic properties for Salesforce mapping\r\n\r\n---\r\n\r\n#### **Step 3: Transform/Map Component (shape4)**\r\n\r\n**Component Type:** Map/Transform - Subscription Completed JSON to SF Opportunity CREATE Request XML\r\n\r\n**Purpose:** Transforms Stripe subscription JSON data into Salesforce opportunity creation XML format\r\n\r\n**Configuration Details:**\r\n\r\n- **Input Profile:** Stripe subscription completion JSON structure\r\n- **Output Profile:** Salesforce Opportunity CREATE request XML\r\n- **Transformation Type:** JSON to XML with field mapping and function processing\r\n- **Version:** 1\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| Function Output (DDP_SalesforceDescription) | Opportunity/Description | String | Maps calculated description to Salesforce opportunity description field |\r\n| Function Output (DDP_CustomerName) | Opportunity/Name | String | Maps customer name to Salesforce opportunity name field |\r\n| Function Output (DDP_CloseDate) | Opportunity/CloseDate | Date | Maps calculated close date to Salesforce opportunity close date field |\r\n\r\n**Transformation Functions:**\r\n\r\n- **Get Document Property (DDP_SalesforceDescription):** Retrieves calculated description value\r\n- **Get Document Property (DDP_CustomerName):** Retrieves formatted customer name\r\n- **Get Document Property (DDP_CloseDate):** Retrieves calculated opportunity close date\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe JSON with dynamic properties set\r\n- **Processing:** Maps Stripe fields to Salesforce opportunity structure using document properties\r\n- **Output:** Salesforce-compatible XML for opportunity creation\r\n\r\n---\r\n\r\n#### **Step 4: Connector Action (shape3)**\r\n\r\n**Component Type:** Salesforce Connector - SF Opportunity CREATE Operation\r\n\r\n**Purpose:** Creates new opportunity records in Salesforce using the transformed data\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** Salesforce\r\n- **Operation:** CREATE\r\n- **Target Object:** Opportunity\r\n- **Authentication:** Salesforce OAuth or username/password authentication\r\n- **Error Handling:** Standard Salesforce API error processing\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce opportunity creation XML request\r\n- **Processing:** Executes Salesforce API call to create opportunity record\r\n- **Output:** Salesforce API response with created opportunity details or error information\r\n\r\n---\r\n\r\n#### **Step 5: End Event (shape5)**\r\n\r\n**Component Type:** End Event\r\n\r\n**Purpose:** Completes the integration process and handles final response processing\r\n\r\n**Configuration Details:**\r\n\r\n- **Completion Type:** Process termination after successful opportunity creation\r\n- **Response Handling:** Returns appropriate HTTP response to Stripe webhook\r\n- **Logging:** Records process completion status\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce API response\r\n- **Processing:** Processes final response and completes integration\r\n- **Output:** HTTP response to webhook caller indicating success or failure\r\n\r\n## Boomi Transformations Explained\r\n\r\n### Subscription Completed JSON to SF Opportunity CREATE Request XML\r\n\r\n**Purpose:** This transformation converts incoming Stripe subscription webhook data into a properly formatted Salesforce opportunity creation request.\r\n\r\n**Input Profile:** Stripe subscription completion webhook JSON containing customer and subscription information.\r\n\r\n**Output Profile:** Salesforce Opportunity object XML structure with required fields for opportunity creation.\r\n\r\n**Transformation Logic:**\r\n\r\nThe mapping utilizes three key document properties that are calculated in the previous Document Properties step:\r\n\r\n1. **Description Mapping:** Uses `DocumentPropertyGet` function to retrieve the calculated `DDP_SalesforceDescription` value and maps it to the Salesforce `Opportunity/Description` field.\r\n\r\n2. **Name Mapping:** Uses `DocumentPropertyGet` function to retrieve the formatted `DDP_CustomerName` value and maps it to the Salesforce `Opportunity/Name` field.\r\n\r\n3. **Close Date Mapping:** Uses `DocumentPropertyGet` function to retrieve the calculated `DDP_CloseDate` value and maps it to the Salesforce `Opportunity/CloseDate` field.\r\n\r\n**Function Steps:**\r\n- **DocumentPropertyGet:** Retrieves dynamic document properties set in the previous step\r\n- **Profile-based Mapping:** Maps function outputs to specific Salesforce opportunity fields\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| DocumentPropertyGet(DDP_SalesforceDescription) | Opportunity/Description | String | Provides detailed description of the opportunity based on Stripe subscription data |\r\n| DocumentPropertyGet(DDP_CustomerName) | Opportunity/Name | String | Sets the opportunity name using formatted customer information |\r\n| DocumentPropertyGet(DDP_CloseDate) | Opportunity/CloseDate | Date | Establishes the expected close date for the opportunity |\r\n\r\n**Mapping Configuration:**\r\n- 3 field mappings from function outputs to Salesforce opportunity profile fields\r\n- All mappings use the profile-based approach for consistent data structure\r\n- Function-based source values ensure dynamic property calculation is utilized\r\n\r\n## SAP Integration Suite Implementation\r\n\r\n### Component Mapping\r\n\r\n#### Main Process Component Mapping\r\n\r\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\r\n|-----------------|----------------------------------|---------|\r\n| Start Event (shape1) | Start Message Event | Initiates the integration flow when triggered by webhook events |\r\n| Document Properties (shape6) | Content Modifier (Set Properties) | Calculates and sets dynamic properties for opportunity field mapping |\r\n| Map/Transform (shape4) | Message Mapping | Transforms Stripe JSON to Salesforce XML format with field mappings |\r\n| Salesforce Connector (shape3) | Salesforce Adapter (Request Reply) | Creates opportunity records in Salesforce using REST API |\r\n| End Event (shape5) | End Message Event | Completes the integration flow and returns response |\r\n\r\n### Integration Flow Visualization\r\n\r\n```mermaid\r\nflowchart TD\r\n%% Define node styles for SAP Integration Suite components\r\nclassDef httpAdapter fill:#87CEEB,stroke:#333,stroke-width:2px\r\nclassDef contentModifier fill:#98FB98,stroke:#333,stroke-width:2px\r\nclassDef mapping fill:#DDA0DD,stroke:#333,stroke-width:2px\r\nclassDef adapter fill:#FFD700,stroke:#333,stroke-width:2px\r\nclassDef event fill:#C0C0C0,stroke:#333,stroke-width:2px\r\n\r\n%% Main Integration Flow\r\nStart((\"Start Message Event\")) --> StripeWebhook[\"HTTPS Adapter: Stripe Webhook Receiver\"]:::httpAdapter\r\nStripeWebhook --> SetDynamicProps[\"Content Modifier: Set Dynamic Properties<br/>- DDP_CustomerName<br/>- DDP_Subscription<br/>- DDP_SalesforceDescription<br/>- DDP_CloseDate\"]:::contentModifier\r\nSetDynamicProps --> TransformData[\"Message Mapping: JSON to XML<br/>Subscription â†’ Opportunity\"]:::mapping\r\nTransformData --> SalesforceCreate[\"Salesforce Adapter: Create Opportunity<br/>Operation: CREATE<br/>Object: Opportunity\"]:::adapter\r\nSalesforceCreate --> End((\"End Message Event\")):::event\r\n\r\n%% Dynamic Properties Detail\r\nsubgraph DynamicProperties[\"Dynamic Properties Calculation\"]\r\n    ExtractCustomer[\"Extract Customer Name from Stripe Data\"]:::contentModifier\r\n    ExtractSubscription[\"Extract Subscription Details\"]:::contentModifier\r\n    FormatDescription[\"Format Salesforce Description\"]:::contentModifier\r\n    CalculateCloseDate[\"Calculate Opportunity Close Date\"]:::contentModifier\r\nend\r\n\r\n%% Apply styling\r\nclass StripeWebhook httpAdapter\r\nclass SetDynamicProps,ExtractCustomer,ExtractSubscription,FormatDescription,CalculateCloseDate contentModifier\r\nclass TransformData mapping\r\nclass SalesforceCreate adapter\r\nclass Start,End event\r\n```\r\n\r\n### Configuration Details\r\n\r\n#### HTTPS Adapter (Webhook Receiver)\r\n- **Address:** `/webhook/stripe/subscription`\r\n- **HTTP Method:** POST\r\n- **Content Type:** application/json\r\n- **Authentication:** API Key or Webhook Signature Verification\r\n- **Timeout:** 30 seconds\r\n\r\n#### Content Modifier (Dynamic Properties)\r\n**Properties to Set:**\r\n- `DDP_CustomerName`: Extract customer name from Stripe payload\r\n- `DDP_Subscription`: Extract subscription ID and details\r\n- `DDP_SalesforceDescription`: Format description combining customer and subscription info\r\n- `DDP_CloseDate`: Calculate close date (typically 30-90 days from subscription start)\r\n\r\n#### Message Mapping Configuration\r\n- **Source Message Type:** Stripe Subscription JSON\r\n- **Target Message Type:** Salesforce Opportunity XML\r\n- **Mapping Functions:** DocumentPropertyGet operations for dynamic field population\r\n\r\n#### Salesforce Adapter Configuration\r\n- **Connection Type:** HTTPS (REST API)\r\n- **Base URL:** `https://[instance].salesforce.com/services/data/v58.0/`\r\n- **Authentication:** OAuth 2.0\r\n- **Operation:** POST to `/sobjects/Opportunity/`\r\n- **Content Type:** application/json\r\n- **Timeout:** 60 seconds\r\n\r\n## Environment Configuration\r\n\r\n### Required Configuration Parameters\r\n\r\n| Parameter | Description | Example Value | Required |\r\n|-----------|-------------|---------------|----------|\r\n| Stripe Webhook Secret | Secret key for webhook signature verification | `whsec_1234567890abcdef` | Yes |\r\n| Salesforce Instance URL | Salesforce org instance URL | `https://myorg.salesforce.com` | Yes |\r\n| Salesforce Client ID | OAuth client ID for Salesforce connection | `3MVG9A2kN3Bn17hs...` | Yes |\r\n| Salesforce Client Secret | OAuth client secret | `1234567890123456789` | Yes |\r\n| Salesforce Username | Salesforce user account | `integration@company.com` | Yes |\r\n| Salesforce Password | Salesforce user password | `password123` | Yes |\r\n\r\n### Environment Variables\r\n\r\n| Variable | Description | Example Value |\r\n|----------|-------------|---------------|\r\n| `STRIPE_WEBHOOK_ENDPOINT` | Webhook listener endpoint | `/webhook/stripe/subscription` |\r\n| `SALESFORCE_API_VERSION` | Salesforce API version | `v58.0` |\r\n| `OPPORTUNITY_DEFAULT_STAGE` | Default opportunity stage | `Prospecting` |\r\n| `OPPORTUNITY_DEFAULT_PROBABILITY` | Default probability percentage | `25` |\r\n\r\n### Dependencies on External Systems\r\n\r\n- **Stripe API:** Webhook event delivery system\r\n- **Salesforce API:** Opportunity creation and management\r\n- **Network Connectivity:** HTTPS access to both Stripe and Salesforce\r\n\r\n### Security Settings\r\n\r\n- **TLS/SSL:** Required for all external communications\r\n- **Authentication:** OAuth 2.0 for Salesforce, webhook signatures for Stripe\r\n- **Data Encryption:** In-transit encryption for all API communications\r\n\r\n### Deployment Considerations\r\n\r\n- **Runtime Environment:** SAP Integration Suite Cloud\r\n- **Memory Requirements:** 2GB minimum for JSON/XML processing\r\n- **CPU Requirements:** 2 cores for concurrent webhook processing\r\n- **Network Requirements:** Outbound HTTPS access to Salesforce and Stripe\r\n- **Storage Requirements:** 1GB for temporary message processing\r\n\r\n## API Reference\r\n\r\n### Stripe Webhook API\r\n\r\n#### POST /webhook/stripe/subscription\r\n**Purpose:** Receives Stripe subscription completion events\r\n\r\n**Request Headers:**\r\n- `Content-Type: application/json`\r\n- `Stripe-Signature: [webhook signature]`\r\n\r\n**Request Body Schema:**\r\n```json\r\n{\r\n  \"id\": \"evt_1234567890\",\r\n  \"object\": \"event\",\r\n  \"type\": \"customer.subscription.created\",\r\n  \"data\": {\r\n    \"object\": {\r\n      \"id\": \"sub_1234567890\",\r\n      \"customer\": \"cus_1234567890\",\r\n      \"status\": \"active\",\r\n      \"current_period_start\": 1234567890,\r\n      \"current_period_end\": 1234567890\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n**Response Codes:**\r\n- `200 OK`: Webhook processed successfully\r\n- `400 Bad Request`: Invalid webhook payload\r\n- `401 Unauthorized`: Invalid webhook signature\r\n- `500 Internal Server Error`: Processing error\r\n\r\n### Salesforce Opportunity API\r\n\r\n#### POST /services/data/v58.0/sobjects/Opportunity/\r\n**Purpose:** Creates new opportunity records\r\n\r\n**Request Headers:**\r\n- `Content-Type: application/json`\r\n- `Authorization: Bearer [access_token]`\r\n\r\n**Request Body Schema:**\r\n```json\r\n{\r\n  \"Name\": \"Customer Name - Subscription\",\r\n  \"Description\": \"Opportunity created from Stripe subscription\",\r\n  \"CloseDate\": \"2024-12-31\",\r\n  \"StageName\": \"Prospecting\",\r\n  \"Probability\": 25\r\n}\r\n```\r\n\r\n**Response Schema:**\r\n```json\r\n{\r\n  \"id\": \"0061234567890ABC\",\r\n  \"success\": true,\r\n  \"errors\": []\r\n}\r\n```\r\n\r\n**Error Codes:**\r\n- `REQUIRED_FIELD_MISSING`: Missing required opportunity fields\r\n- `INVALID_FIELD`: Invalid field values provided\r\n- `INSUFFICIENT_ACCESS`: Insufficient permissions to create opportunities",
  "markdown_length": 18115,
  "constructed_query": "Create a complete SAP iFlow integration package named 'IFlow_979a8fb5' with the following requirements from the documentation:\n\n# Create Salesforce Opportunities from Stripe Subscriptions Integration\r\n\r\n## Table of Contents\r\n\r\n- [API Overview](#api-overview)\r\n- [Endpoints](#endpoints)\r\n- [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n  - [Process Flow Overview](#process-flow-overview)\r\n  - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n    - [Step 1: Start Event (shape1)](#step-1-start-event-shape1)\r\n    - [Step 2: Document Properties (shape6)](#step-2-document-properties-shape6)\r\n    - [Step 3: Transform/Map Component (shape4)](#step-3-transformmap-component-shape4)\r\n    - [Step 4: Connector Action (shape3)](#step-4-connector-action-shape3)\r\n    - [Step 5: End Event (shape5)](#step-5-end-event-shape5)\r\n- [Boomi Transformations Explained](#boomi-transformations-explained)\r\n- [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n  - [Component Mapping](#component-mapping)\r\n  - [Integration Flow Visualization](#integration-flow-visualization)\r\n  - [Configuration Details](#configuration-details)\r\n- [Environment Configuration](#environment-configuration)\r\n- [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration creates Salesforce Opportunities automatically based on completed Stripe subscription events. The process handles incoming Stripe webhook events, transforms the subscription data into Salesforce-compatible format, and creates new opportunity records in Salesforce.\r\n\r\n**Business Purpose:** Streamline the sales pipeline by automatically converting successful Stripe subscriptions into trackable Salesforce opportunities, ensuring no revenue opportunities are missed and maintaining data consistency between payment and CRM systems.\r\n\r\n**Integration Pattern:** Event-driven integration using webhook listeners for real-time processing.\r\n\r\n**Key Features:**\r\n- Real-time webhook processing from Stripe\r\n- Dynamic property calculation for opportunity fields\r\n- Automatic Salesforce opportunity creation\r\n- Error handling and logging\r\n\r\n#\n\nGenerate a production-ready iFlow with proper:\n1. Start and End events\n2. Required adapters and connectors\n3. Content modifiers and processing steps\n4. Proper sequence flows\n5. Error handling\n6. SAP Integration Suite compliance\n",
  "query_length": 2358,
  "markdown_truncated_at": 2000,
  "api_endpoint": "/api/generate-iflow-from-markdown",
  "request_time": "2025-10-17T14:46:27.866270"
}