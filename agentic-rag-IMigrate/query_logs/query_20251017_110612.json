{
  "timestamp": "20251017_110612",
  "job_id": "5edffc5d-0e88-41e8-8d74-41cd2b4938cc",
  "iflow_name": "BoomiFlow_673b4de9",
  "original_markdown": "# Stripe Subscription to Salesforce Opportunity Integration\n\n## Table of Contents\n\n- [API Overview](#api-overview)\n- [Endpoints](#endpoints)\n- [Current Boomi Flow Logic](#current-boomi-flow-logic)\n  - [Process Flow Overview](#process-flow-overview)\n  - [Step-by-Step Flow Description](#step-by-step-flow-description)\n- [Boomi Transformations Explained](#boomi-transformations-explained)\n- [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\n  - [Component Mapping](#component-mapping)\n  - [Integration Flow Visualization](#integration-flow-visualization)\n  - [Configuration Details](#configuration-details)\n- [Environment Configuration](#environment-configuration)\n- [API Reference](#api-reference)\n\n## API Overview\n\nThis integration creates Salesforce Opportunities from Stripe subscription events, providing automated lead-to-opportunity conversion for subscription-based business models. The integration processes Stripe webhook events and transforms subscription data into Salesforce Opportunity records.\n\n- **Base URL Pattern**: Webhook receiver endpoint for Stripe subscription events\n- **Authentication**: Webhook signature validation for Stripe events\n- **Processing Pattern**: Event-driven integration with real-time opportunity creation\n- **General Response Format**: Salesforce API responses for opportunity creation\n\n## Endpoints\n\n### Stripe Webhook Endpoint\n- **HTTP Method**: POST (webhook receiver)\n- **Purpose**: Receives Stripe subscription completion events\n- **Request Parameters**: \n  - Headers: Stripe webhook signature for validation\n  - Body: Stripe subscription event payload in JSON format\n- **Request Body Structure**: \n  - Stripe subscription object with customer details, product information, and subscription metadata\n- **Response Format**: HTTP 200 acknowledgment for successful processing\n- **Error Handling**: Exception handling for malformed webhook data\n\n### Salesforce Opportunity Creation\n- **HTTP Method**: POST (via Salesforce API)\n- **Purpose**: Creates new Opportunity records in Salesforce\n- **Request Parameters**:\n  - Salesforce session authentication\n  - Opportunity object data in XML format\n- **Response Format**: Salesforce API response with created record ID\n- **Error Handling**: Salesforce API error responses and retry logic\n\n## Current Boomi Flow Logic\n\n### Process Flow Overview\n\nThis Boomi process implements an event-driven integration pattern that:\n1. Receives Stripe webhook events for subscription completions\n2. Sets dynamic document properties for data enhancement\n3. Transforms JSON subscription data to Salesforce Opportunity XML format\n4. Creates Opportunity records in Salesforce\n5. Handles errors and provides logging for troubleshooting\n\n### Step-by-Step Flow Description\n\n---\n\n#### **Step 1: Start Event (shape1)**\n\n**Component Type:** Start Event\n\n**Purpose:** Webhook receiver that listens for incoming Stripe subscription events\n\n**Configuration Details:**\n\n- **Connector Type:** Event listener/webhook receiver\n- **Operation:** Listen for HTTP POST requests from Stripe\n- **Input Profile:** JSON payload from Stripe webhook\n- **Trigger Conditions:** Stripe subscription completion events\n\n**Data Flow:**\n\n- **Input:** Stripe webhook JSON payload containing subscription details\n- **Processing:** Validates webhook signature and parses JSON data\n- **Output:** Structured subscription data ready for processing\n\n---\n\n#### **Step 2: Document Properties (shape6)**\n\n**Component Type:** Set Dynamic Properties\n\n**Purpose:** Sets dynamic document properties for data enhancement and transformation logic\n\n**Configuration Details:**\n\n- **Dynamic Properties:** 4 dynamic properties configured\n  - Dynamic Document Property - DDP_CustomerName: Process property for customer name extraction\n  - Dynamic Document Property - DDP_Subscription: Process property for subscription details\n  - Dynamic Document Property - DDP_SalesforceDescription: Process property for opportunity description\n  - Additional property for data enhancement (1 more property)\n\n**Data Flow:**\n\n- **Input:** Raw Stripe subscription JSON data\n- **Processing:** Extracts and calculates dynamic properties for use in transformation\n- **Output:** Enhanced data with calculated properties available for mapping\n\n---\n\n#### **Step 3: Transform/Map Components (shape4)**\n\n**Component Type:** Map/Transform\n\n**Purpose:** Transforms Stripe subscription JSON data to Salesforce Opportunity XML format\n\n**Configuration Details:**\n\n- **Input Profile:** Subscription Completed JSON structure\n- **Output Profile:** SF Opportunity CREATE Request XML\n- **Transformation Logic:** Maps subscription data to Salesforce Opportunity fields\n- **Function Steps:** DocumentPropertyGet functions for dynamic property retrieval\n\n**Field Mappings:**\n\n| Source Field | Target Field | Data Type | Business Purpose |\n|--------------|--------------|-----------|------------------|\n| Dynamic Property - DDP_SalesforceDescription | Opportunity/Description | String | Maps calculated description to Salesforce opportunity description |\n| Dynamic Property - DDP_CustomerName | Opportunity/Name | String | Maps customer name to Salesforce opportunity name |\n| Dynamic Property - DDP_CloseDate | Opportunity/CloseDate | Date | Maps calculated close date to Salesforce opportunity close date |\n\n**Data Flow:**\n\n- **Input:** Stripe subscription JSON with dynamic properties\n- **Processing:** Field mapping and data type conversion for Salesforce format\n- **Output:** Salesforce Opportunity XML ready for API submission\n\n---\n\n#### **Step 4: Connector Actions (shape3)**\n\n**Component Type:** Salesforce Connector\n\n**Purpose:** Creates new Opportunity records in Salesforce using the transformed data\n\n**Configuration Details:**\n\n- **Connector Type:** Salesforce\n- **Operation:** Create\n- **Target Object:** Opportunity\n- **Authentication:** Salesforce session-based authentication\n- **Error Handling:** Salesforce API error responses and retry logic\n\n**Data Flow:**\n\n- **Input:** Salesforce Opportunity XML from transformation\n- **Processing:** Salesforce API call to create Opportunity record\n- **Output:** Salesforce API response with created record details\n\n---\n\n#### **Step 5: End Events (shape5)**\n\n**Component Type:** End Event\n\n**Purpose:** Completes the process execution and provides final status\n\n**Configuration Details:**\n\n- **Completion Type:** Success completion after Salesforce record creation\n- **Final Actions:** Process completion logging\n- **Continuation Settings:** Process stops after successful completion\n\n**Data Flow:**\n\n- **Input:** Salesforce API response\n- **Processing:** Final status logging and cleanup\n- **Output:** Process completion confirmation\n\n## Boomi Transformations Explained\n\n### Subscription Completed JSON to SF Opportunity CREATE Request XML\n\n**Transformation Purpose:** This transformation converts Stripe subscription webhook data from JSON format into Salesforce Opportunity XML format for record creation.\n\n**Input Profile:** Subscription Completed JSON\n- Contains Stripe subscription event data including customer information, product details, and subscription metadata\n- JSON structure with nested objects for customer, product, and subscription properties\n\n**Output Profile:** SF Opportunity CREATE Request XML\n- Salesforce API-compliant XML structure for Opportunity object creation\n- Contains required and optional fields for Opportunity record\n\n**Function Steps Used:**\n\n1. **DocumentPropertyGet (ProcessProperty)** - DDP_SalesforceDescription\n   - Retrieves calculated description property for opportunity description field\n   \n2. **DocumentPropertyGet (ProcessProperty)** - DDP_CustomerName  \n   - Retrieves customer name property for opportunity name field\n   \n3. **DocumentPropertyGet (ProcessProperty)** - DDP_CloseDate\n   - Retrieves calculated close date property for opportunity close date field\n\n**Complete Field Mappings:**\n\n| Source | Target Field | Transformation | Business Purpose |\n|--------|--------------|----------------|------------------|\n| Function Output (DDP_SalesforceDescription) | Opportunity/Description | Direct mapping | Populates opportunity description with enhanced subscription details |\n| Function Output (DDP_CustomerName) | Opportunity/Name | Direct mapping | Sets opportunity name based on customer information |\n| Function Output (DDP_CloseDate) | Opportunity/CloseDate | Direct mapping | Establishes opportunity close date based on subscription timing |\n\n**Mapping Configuration Details:**\n- 3 field mappings configured in transformation\n- All mappings use function outputs from DocumentPropertyGet operations\n- Profile-based mapping ensures data type compatibility between JSON input and XML output\n\n## SAP Integration Suite Implementation\n\n### Component Mapping\n\n#### Main Process Component Mapping\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\n|-----------------|----------------------------------|---------|\n| Start Event (shape1) | Start Message Event with HTTPS Adapter | Webhook receiver for Stripe subscription events |\n| Set Dynamic Properties (shape6) | Content Modifier (Set Properties) | Dynamic property calculation and data enhancement |\n| Transform/Map (shape4) | Message Mapping | JSON to XML transformation for Salesforce format |\n| Salesforce Connector (shape3) | Salesforce Adapter or HTTPS Adapter | Create Opportunity records in Salesforce |\n| End Event (shape5) | End Message Event | Process completion and status logging |\n\n### Integration Flow Visualization\n\n```mermaid\nflowchart TD\n    %% Define node styles for SAP Integration Suite components\n    classDef httpAdapter fill:#87CEEB,stroke:#333,stroke-width:2px\n    classDef contentModifier fill:#98FB98,stroke:#333,stroke-width:2px\n    classDef mapping fill:#DDA0DD,stroke:#333,stroke-width:2px\n    classDef adapter fill:#FFD700,stroke:#333,stroke-width:2px\n    classDef event fill:#C0C0C0,stroke:#333,stroke-width:2px\n    classDef errorHandler fill:#FFA07A,stroke:#333,stroke-width:2px\n\n    %% Main Integration Flow\n    Start((\"Start Message Event\")):::event --> StripeWebhook[\"HTTPS Adapter: Stripe Webhook Receiver\"]:::httpAdapter\n    StripeWebhook --> SetDynamicProps[\"Content Modifier: Set Dynamic Properties\"]:::contentModifier\n    SetDynamicProps --> TransformData[\"Message Mapping: JSON to XML Transform\"]:::mapping\n    TransformData --> SalesforceCreate[\"Salesforce Adapter: Create Opportunity\"]:::adapter\n    SalesforceCreate --> End((\"End Message Event\")):::event\n\n    %% Dynamic Properties Detail\n    subgraph DynamicProperties[\"Dynamic Properties Calculation\"]\n        direction TB\n        ExtractCustomer[\"Extract: Customer Name from Subscription\"]:::contentModifier\n        ExtractSubscription[\"Extract: Subscription Details\"]:::contentModifier\n        CalcDescription[\"Calculate: Salesforce Description\"]:::contentModifier\n        CalcCloseDate[\"Calculate: Opportunity Close Date\"]:::contentModifier\n    end\n\n    SetDynamicProps -.-> DynamicProperties\n\n    %% Apply styling\n    class Start,End event\n    class StripeWebhook httpAdapter\n    class SetDynamicProps,ExtractCustomer,ExtractSubscription,CalcDescription,CalcCloseDate contentModifier\n    class TransformData mapping\n    class SalesforceCreate adapter\n```\n\n### Configuration Details\n\n#### HTTPS Adapter (Stripe Webhook Receiver)\n- **Endpoint Pattern:** `/webhook/stripe/subscription`\n- **HTTP Method:** POST\n- **Authentication:** Stripe webhook signature validation\n- **Content Type:** application/json\n- **Timeout:** 30 seconds\n- **Error Handling:** HTTP error status codes with retry logic\n\n#### Content Modifier (Dynamic Properties)\n- **Property 1 - DDP_CustomerName:** Extract customer name from subscription data\n- **Property 2 - DDP_Subscription:** Subscription details extraction\n- **Property 3 - DDP_SalesforceDescription:** Formatted description for Salesforce\n- **Property 4 - DDP_CloseDate:** Calculated close date based on subscription terms\n\n#### Message Mapping (JSON to XML)\n- **Source Message Type:** Stripe Subscription JSON\n- **Target Message Type:** Salesforce Opportunity XML\n- **Mapping Functions:** Property retrieval and data type conversion\n- **Validation Rules:** Required field validation for Salesforce API\n\n#### Salesforce Adapter\n- **Connection Type:** Salesforce REST API or SOAP API\n- **Object:** Opportunity\n- **Operation:** CREATE\n- **Authentication:** OAuth 2.0 or session-based authentication\n- **Batch Processing:** Single record creation per webhook event\n- **Error Handling:** Salesforce API error codes with detailed logging\n\n## Environment Configuration\n\n### Required Configuration Parameters\n- **Stripe Webhook Endpoint:** Publicly accessible URL for webhook reception\n- **Stripe Webhook Secret:** Secret key for webhook signature validation\n- **Salesforce API Credentials:** Username, password, and security token\n- **Salesforce Instance URL:** Production or sandbox Salesforce instance\n- **Process Properties:** Dynamic property calculation parameters\n\n### Environment Variables\n| Variable | Description | Example Value |\n|----------|-------------|---------------|\n| STRIPE_WEBHOOK_SECRET | Stripe webhook signing secret | `whsec_1234567890abcdef` |\n| SALESFORCE_USERNAME | Salesforce API username | `integration@company.com` |\n| SALESFORCE_PASSWORD | Salesforce API password | `SecurePassword123` |\n| SALESFORCE_TOKEN | Salesforce security token | `ABCDEFGHIJKLMNOPQRSTUV` |\n| SALESFORCE_URL | Salesforce instance URL | `https://company.my.salesforce.com` |\n\n### Dependencies on External Systems\n- **Stripe Platform:** Webhook event source system\n- **Salesforce CRM:** Target system for opportunity creation\n- **Network Connectivity:** HTTPS access to both Stripe and Salesforce APIs\n- **Certificate Management:** SSL certificates for secure communication\n\n### Security Settings\n- **Webhook Signature Validation:** Stripe webhook signature verification\n- **API Authentication:** Salesforce session-based or OAuth authentication\n- **Transport Security:** TLS 1.2+ for all external communications\n- **Data Encryption:** Encrypted storage for sensitive configuration data\n\n### Deployment Considerations\n- **Runtime Environment:** SAP Integration Suite Cloud tenant\n- **Memory Requirements:** 2GB minimum for JSON/XML transformation\n- **CPU Requirements:** Standard processing capacity for webhook handling\n- **Scalability:** Auto-scaling for high-volume webhook events\n- **Monitoring:** Integration flow monitoring and alerting setup\n\n## API Reference\n\n### Stripe Webhook API\n\n#### Subscription Completed Event\n- **Event Type:** `customer.subscription.created` or `customer.subscription.updated`\n- **HTTP Method:** POST\n- **Content Type:** `application/json`\n- **Authentication:** Webhook signature validation using `Stripe-Signature` header\n\n**Request Schema:**\n```json\n{\n  \"id\": \"evt_subscription_event_id\",\n  \"object\": \"event\",\n  \"type\": \"customer.subscription.created\",\n  \"data\": {\n    \"object\": {\n      \"id\": \"sub_subscription_id\",\n      \"customer\": \"cus_customer_id\",\n      \"status\": \"active\",\n      \"items\": {\n        \"data\": [{\n          \"price\": {\n            \"product\": \"prod_product_id\"\n          }\n        }]\n      }\n    }\n  }\n}\n```\n\n### Salesforce Opportunity API\n\n#### Create Opportunity\n- **HTTP Method:** POST\n- **Endpoint:** `/services/data/v58.0/sobjects/Opportunity/`\n- **Authentication:** Bearer token or session ID\n- **Content Type:** `application/json` or `application/xml`\n\n**Request Schema (XML):**\n```xml\n<Opportunity>\n  <Name>Customer Subscription Opportunity</Name>\n  <Description>Opportunity created from Stripe subscription</Description>\n  <CloseDate>2024-12-31</CloseDate>\n  <StageName>Prospecting</StageName>\n</Opportunity>\n```\n\n**Response Schema:**\n```json\n{\n  \"id\": \"0064000000ABC123\",\n  \"success\": true,\n  \"errors\": []\n}\n```\n\n#### Standard Parameters\n| Parameter | Type | Required | Description | Example Value |\n|-----------|------|----------|-------------|---------------|\n| Name | String | Yes | Opportunity name | `Customer ABC Subscription` |\n| Description | String | No | Opportunity description | `Created from Stripe subscription event` |\n| CloseDate | Date | Yes | Expected close date | `2024-12-31` |\n| StageName | String | Yes | Opportunity stage | `Prospecting` |\n\n#### Error Codes\n| Code | Message | Description |\n|------|---------|-------------|\n| 400 | Bad Request | Invalid request data or missing required fields |\n| 401 | Unauthorized | Invalid or expired authentication credentials |\n| 403 | Forbidden | Insufficient permissions for opportunity creation |\n| 500 | Internal Server Error | Salesforce internal processing error |\n\n#### Rate Limiting\n- **Daily API Calls:** Based on Salesforce edition (Enterprise: 1,000 calls per user)\n- **Concurrent Requests:** Maximum 25 concurrent API calls\n- **Retry Logic:** Exponential backoff for rate limit exceeded responses",
  "markdown_length": 16838,
  "constructed_query": "Create a complete SAP iFlow integration package named 'BoomiFlow_673b4de9' with the following requirements from the documentation:\n\n# Stripe Subscription to Salesforce Opportunity Integration\n\n## Table of Contents\n\n- [API Overview](#api-overview)\n- [Endpoints](#endpoints)\n- [Current Boomi Flow Logic](#current-boomi-flow-logic)\n  - [Process Flow Overview](#process-flow-overview)\n  - [Step-by-Step Flow Description](#step-by-step-flow-description)\n- [Boomi Transformations Explained](#boomi-transformations-explained)\n- [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\n  - [Component Mapping](#component-mapping)\n  - [Integration Flow Visualization](#integration-flow-visualization)\n  - [Configuration Details](#configuration-details)\n- [Environment Configuration](#environment-configuration)\n- [API Reference](#api-reference)\n\n## API Overview\n\nThis integration creates Salesforce Opportunities from Stripe subscription events, providing automated lead-to-opportunity conversion for subscription-based business models. The integration processes Stripe webhook events and transforms subscription data into Salesforce Opportunity records.\n\n- **Base URL Pattern**: Webhook receiver endpoint for Stripe subscription events\n- **Authentication**: Webhook signature validation for Stripe events\n- **Processing Pattern**: Event-driven integration with real-time opportunity creation\n- **General Response Format**: Salesforce API responses for opportunity creation\n\n## Endpoints\n\n### Stripe Webhook Endpoint\n- **HTTP Method**: POST (webhook receiver)\n- **Purpose**: Receives Stripe subscription completion events\n- **Request Parameters**: \n  - Headers: Stripe webhook signature for validation\n  - Body: Stripe subscription event payload in JSON format\n- **Request Body Structure**: \n  - Stripe subscription object with customer details, product information, and subscription metadata\n- **Response Format**: HTTP 200 acknowledgment for successful processing\n- **Error Handling**: Exception handling for malformed webhook data\n\n### Salesforce Opportunity Creation\n- **HTTP Method**: POST (via Salesforce API)\n- **\n\nGenerate a production-ready iFlow with proper:\n1. Start and End events\n2. Required adapters and connectors\n3. Content modifiers and processing steps\n4. Proper sequence flows\n5. Error handling\n6. SAP Integration Suite compliance\n",
  "query_length": 2362,
  "markdown_truncated_at": 2000,
  "api_endpoint": "/api/generate-iflow-from-markdown",
  "request_time": "2025-10-17T11:06:12.070440"
}