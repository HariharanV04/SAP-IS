{
  "timestamp": "20251016_180528",
  "job_id": "d0184875-522b-427e-af62-1a66b9d9edd4",
  "iflow_name": "IFlow_4c7628e4",
  "original_markdown": "# Stripe to Salesforce Opportunity Creation Integration\r\n\r\n## Table of Contents\r\n\r\n1. [API Overview](#api-overview)\r\n2. [Endpoints](#endpoints)\r\n3. [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n   - [Process Flow Overview](#process-flow-overview)\r\n   - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n     - [Step 1: Start Event (shape1)](#step-1-start-event-shape1)\r\n     - [Step 2: Document Properties (shape6)](#step-2-document-properties-shape6)\r\n     - [Step 3: Transform/Map Components (shape4)](#step-3-transformmap-components-shape4)\r\n     - [Step 4: Connector Actions (shape3)](#step-4-connector-actions-shape3)\r\n     - [Step 5: End Events (shape5)](#step-5-end-events-shape5)\r\n4. [Boomi Transformations Explained](#boomi-transformations-explained)\r\n5. [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n   - [Component Mapping](#component-mapping)\r\n   - [Integration Flow Visualization](#integration-flow-visualization)\r\n   - [Configuration Details](#configuration-details)\r\n6. [Environment Configuration](#environment-configuration)\r\n7. [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration provides automated creation of Salesforce Opportunities based on Stripe subscription completion events. The API serves as a bridge between Stripe's webhook notifications and Salesforce's Opportunity creation process, enabling real-time synchronization of subscription data into sales opportunities for tracking and management.\r\n\r\n**Base URL Pattern:** This integration operates as a webhook receiver, processing inbound HTTP requests from Stripe\r\n**Authentication:** Webhook authentication via Stripe webhook signing\r\n**Rate Limiting:** Dependent on Stripe webhook delivery patterns and Salesforce API limits\r\n**Response Format:** JSON responses for webhook acknowledgment\r\n\r\n## Endpoints\r\n\r\n### Webhook Receiver Endpoint\r\n- **HTTP Method:** POST\r\n- **Path:** `/stripe/subscription/webhook`\r\n- **Purpose:** Receives Stripe subscription completion webhook notifications and processes them for Salesforce opportunity creation\r\n\r\n**Request Headers:**\r\n- `Content-Type`: application/json\r\n- `Stripe-Signature`: Webhook signature for authentication\r\n\r\n**Request Body Structure:**\r\n```json\r\n{\r\n  \"id\": \"evt_subscription_complete\",\r\n  \"object\": \"event\",\r\n  \"type\": \"customer.subscription.created\",\r\n  \"data\": {\r\n    \"object\": {\r\n      \"id\": \"sub_subscription_id\",\r\n      \"customer\": \"cus_customer_id\",\r\n      \"status\": \"active\",\r\n      \"current_period_start\": 1234567890,\r\n      \"current_period_end\": 1234567890\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n**Response Format:**\r\n- **Success (200):** `{\"status\": \"processed\", \"opportunity_id\": \"006XXXXXXXXXX\"}`\r\n- **Error (400):** `{\"error\": \"Invalid webhook signature\"}`\r\n- **Error (500):** `{\"error\": \"Salesforce integration failed\"}`\r\n\r\n## Current Boomi Flow Logic\r\n\r\n### Process Flow Overview\r\n\r\nThis Boomi integration processes Stripe subscription webhook events to automatically create corresponding Salesforce Opportunities. The process includes:\r\n\r\n1. **Webhook Reception:** Receives incoming Stripe subscription completion events via HTTP listener\r\n2. **Dynamic Property Calculation:** Extracts and calculates customer information, subscription details, and opportunity metadata\r\n3. **Data Transformation:** Maps Stripe subscription data to Salesforce Opportunity object structure\r\n4. **Salesforce Integration:** Creates new Opportunity records in Salesforce with derived business data\r\n5. **Response Handling:** Returns success confirmation to Stripe webhook delivery system\r\n\r\n### Step-by-Step Flow Description\r\n\r\n---\r\n\r\n#### **Step 1: Start Event (shape1)**\r\n\r\n**Component Type:** Start Event\r\n\r\n**Purpose:** Initiates the integration process when Stripe subscription webhook events are received\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** HTTP Listener/Web Services Server\r\n- **Operation:** Listen for incoming webhook POST requests\r\n- **Input Profile:** JSON webhook payload from Stripe\r\n- **Trigger Conditions:** Stripe subscription completion events\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook JSON payload containing subscription and customer data\r\n- **Processing:** Validates webhook signature and parses incoming subscription event data\r\n- **Output:** Parsed subscription event data ready for property calculation and transformation\r\n\r\n---\r\n\r\n#### **Step 2: Document Properties (shape6)**\r\n\r\n**Component Type:** Document Properties - Set Dynamic Properties\r\n\r\n**Purpose:** Extracts and calculates dynamic properties from the Stripe webhook data for use in Salesforce opportunity creation\r\n\r\n**Configuration Details:**\r\n\r\n- **Dynamic Properties:** 4 dynamic document properties configured\r\n  - Dynamic Document Property - DDP_CustomerName: Process property: Dynamic Document Property - DDP_CustomerName\r\n  - Dynamic Document Property - DDP_Subscription: Process property: Dynamic Document Property - DDP_Subscription  \r\n  - Dynamic Document Property - DDP_SalesforceDescription: Process property: Dynamic Document Property - DDP_SalesforceDescription\r\n  - Additional property configurations for opportunity metadata\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook JSON payload with subscription and customer information\r\n- **Processing:** Extracts customer name, subscription details, calculates Salesforce-specific descriptions and metadata\r\n- **Output:** Enhanced data payload with calculated dynamic properties ready for transformation\r\n\r\n---\r\n\r\n#### **Step 3: Transform/Map Components (shape4)**\r\n\r\n**Component Type:** Map/Transform - Subscription Completed JSON to SF Opportunity CREATE Request XML\r\n\r\n**Purpose:** Transforms Stripe subscription JSON data into Salesforce Opportunity XML format for creation request\r\n\r\n**Configuration Details:**\r\n\r\n- **Input Profile:** Stripe Subscription JSON format\r\n- **Output Profile:** Salesforce Opportunity CREATE Request XML\r\n- **Transformation Logic:** Maps subscription data to opportunity fields with business rule application\r\n- **Function Steps:** DocumentPropertyGet functions for dynamic property retrieval\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| Function Output (DDP_SalesforceDescription) | Opportunity/Description | String | Maps calculated description to Salesforce opportunity description field |\r\n| Function Output (DDP_CustomerName) | Opportunity/Name | String | Maps customer name to Salesforce opportunity name for identification |\r\n| Function Output (DDP_CloseDate) | Opportunity/CloseDate | Date | Maps calculated close date to Salesforce opportunity close date |\r\n\r\n**Transformation Functions:**\r\n\r\n**Get Document Property (ProcessProperty) - DDP_SalesforceDescription**\r\n- **Purpose:** Retrieves calculated Salesforce description from dynamic properties\r\n- **Output:** Formatted description string for opportunity record\r\n\r\n**Get Document Property (ProcessProperty) - DDP_CustomerName**  \r\n- **Purpose:** Retrieves customer name from dynamic properties\r\n- **Output:** Customer name string for opportunity naming\r\n\r\n**Get Document Property (ProcessProperty) - DDP_CloseDate**\r\n- **Purpose:** Retrieves calculated close date from dynamic properties  \r\n- **Output:** Date value for opportunity close date field\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe subscription JSON with dynamic properties\r\n- **Processing:** Field-by-field transformation applying business rules and data type conversions\r\n- **Output:** Salesforce Opportunity XML ready for API submission\r\n\r\n---\r\n\r\n#### **Step 4: Connector Actions (shape3)**\r\n\r\n**Component Type:** Salesforce Connector - SF Opportunity CREATE Operation\r\n\r\n**Purpose:** Creates new Opportunity records in Salesforce using the transformed subscription data\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** Salesforce\r\n- **Operation:** Create\r\n- **Target Object:** Opportunity\r\n- **Authentication:** OAuth or Username/Password authentication to Salesforce\r\n- **Error Handling:** Standard Salesforce API error responses\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce Opportunity XML with all required fields populated\r\n- **Processing:** Executes Salesforce API create operation for Opportunity object\r\n- **Output:** Salesforce response with created Opportunity ID and success status\r\n\r\n---\r\n\r\n#### **Step 5: End Events (shape5)**\r\n\r\n**Component Type:** End Event\r\n\r\n**Purpose:** Completes the integration process and returns success response to Stripe webhook\r\n\r\n**Configuration Details:**\r\n\r\n- **Completion Type:** Successful process completion\r\n- **Final Actions:** Returns HTTP response to acknowledge webhook processing\r\n- **Continuation Settings:** Process terminates after successful completion\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce creation response with opportunity details\r\n- **Processing:** Formats success response for webhook acknowledgment\r\n- **Output:** HTTP 200 response confirming successful opportunity creation\r\n\r\n---\r\n\r\n## Boomi Transformations Explained\r\n\r\n### Subscription Completed JSON to SF Opportunity CREATE Request XML\r\n\r\nThis transformation converts incoming Stripe subscription webhook data into the XML format required by Salesforce's Opportunity creation API.\r\n\r\n**Input Profile:** Stripe Subscription Webhook JSON\r\n- Contains subscription event data including customer information, subscription details, and pricing\r\n- Includes event metadata such as timestamps and event identifiers\r\n- May contain nested customer and product information\r\n\r\n**Output Profile:** Salesforce Opportunity XML\r\n- Structured XML format matching Salesforce API requirements for Opportunity object\r\n- Contains required fields: Name, Description, CloseDate\r\n- Formatted for SOAP API consumption by Salesforce connector\r\n\r\n**Transformation Process:**\r\n\r\n1. **Dynamic Property Retrieval:** Uses DocumentPropertyGet functions to access calculated properties\r\n2. **Field Assignment:** Maps function outputs to specific Opportunity XML elements\r\n3. **Data Type Conversion:** Ensures proper formatting for Salesforce field requirements\r\n4. **XML Structure Creation:** Builds properly formatted XML for Salesforce API consumption\r\n\r\n**Function Steps Used:**\r\n\r\n- **DocumentPropertyGet(DDP_SalesforceDescription):** Retrieves calculated opportunity description\r\n- **DocumentPropertyGet(DDP_CustomerName):** Retrieves customer name for opportunity naming\r\n- **DocumentPropertyGet(DDP_CloseDate):** Retrieves calculated opportunity close date\r\n\r\n**Default Values and Constants:**\r\n- No static default values are configured; all fields are populated from dynamic properties\r\n- XML structure follows Salesforce API schema requirements\r\n\r\n## SAP Integration Suite Implementation\r\n\r\n### Component Mapping\r\n\r\n#### Main Process Component Mapping\r\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\r\n|-----------------|----------------------------------|---------|\r\n| Start Event (shape1) | Start Message Event with HTTPS Adapter | Receives Stripe webhook HTTP requests |\r\n| Document Properties (shape6) | Content Modifier - Set Properties | Calculates dynamic properties from webhook data |\r\n| Transform/Map (shape4) | Message Mapping - JSON to XML | Transforms Stripe data to Salesforce format |\r\n| Salesforce Connector (shape3) | Request Reply with Salesforce Adapter | Creates Salesforce Opportunity records |\r\n| End Event (shape5) | End Message Event | Completes integration flow |\r\n\r\n### Integration Flow Visualization\r\n\r\n```mermaid\r\nflowchart TD\r\n    %% Define node styles for SAP Integration Suite components\r\n    classDef httpAdapter fill:#87CEEB,stroke:#333,stroke-width:2px\r\n    classDef contentModifier fill:#98FB98,stroke:#333,stroke-width:2px\r\n    classDef mapping fill:#DDA0DD,stroke:#333,stroke-width:2px\r\n    classDef adapter fill:#FFD700,stroke:#333,stroke-width:2px\r\n    classDef event fill:#C0C0C0,stroke:#333,stroke-width:2px\r\n\r\n    %% Main Integration Flow\r\n    Start((\"Start Event\")):::event --> StripeWebhook[\"HTTPS Adapter: Stripe Webhook Receiver\"]:::httpAdapter\r\n    StripeWebhook --> SetDynamicProps[\"Content Modifier: Set Dynamic Properties\"]:::contentModifier\r\n    SetDynamicProps --> TransformData[\"Message Mapping: JSON to XML Transformation\"]:::mapping\r\n    TransformData --> SalesforceCreate[\"Salesforce Adapter: Create Opportunity\"]:::adapter\r\n    SalesforceCreate --> End((\"End Event\")):::event\r\n\r\n    %% Dynamic Properties Detail\r\n    subgraph DynamicProperties[\"Dynamic Properties Calculation\"]\r\n        ExtractCustomer[\"Extract Customer Name from Webhook\"]:::contentModifier\r\n        ExtractSubscription[\"Extract Subscription Details\"]:::contentModifier\r\n        CalcDescription[\"Calculate Salesforce Description\"]:::contentModifier\r\n        CalcCloseDate[\"Calculate Opportunity Close Date\"]:::contentModifier\r\n    end\r\n\r\n    SetDynamicProps --> DynamicProperties\r\n    DynamicProperties --> TransformData\r\n```\r\n\r\n### Configuration Details\r\n\r\n**HTTPS Adapter Configuration (Webhook Receiver):**\r\n- Address: `/stripe/subscription/webhook`\r\n- Authentication: Basic Authentication or API Key\r\n- HTTP Method: POST\r\n- Content Type: application/json\r\n\r\n**Content Modifier Configuration (Dynamic Properties):**\r\n- Property 1: DDP_CustomerName - Extract from webhook payload\r\n- Property 2: DDP_Subscription - Extract subscription details\r\n- Property 3: DDP_SalesforceDescription - Calculate description text\r\n- Property 4: DDP_CloseDate - Calculate close date based on subscription\r\n\r\n**Message Mapping Configuration:**\r\n- Source: Stripe Webhook JSON Schema\r\n- Target: Salesforce Opportunity XML Schema\r\n- Mapping Rules: Function-based mapping using dynamic properties\r\n\r\n**Salesforce Adapter Configuration:**\r\n- Connection: Salesforce Production/Sandbox\r\n- Object: Opportunity\r\n- Operation: Create\r\n- Authentication: OAuth 2.0 or Username/Password\r\n\r\n## Environment Configuration\r\n\r\n**Required Configuration Parameters:**\r\n- Stripe Webhook Endpoint URL\r\n- Stripe Webhook Secret for signature validation\r\n- Salesforce Connection credentials (Username, Password, Security Token)\r\n- Salesforce API Version (e.g., v58.0)\r\n\r\n**Environment Variables:**\r\n- `STRIPE_WEBHOOK_SECRET`: Webhook signing secret for authentication\r\n- `SALESFORCE_USERNAME`: Salesforce integration user account\r\n- `SALESFORCE_PASSWORD`: Salesforce integration user password\r\n- `SALESFORCE_SECURITY_TOKEN`: Salesforce security token for API access\r\n- `SALESFORCE_ENDPOINT`: Salesforce instance URL (e.g., https://yourinstance.salesforce.com)\r\n\r\n**External System Dependencies:**\r\n- Stripe webhook delivery system for event notifications\r\n- Salesforce API for opportunity creation\r\n- Network connectivity to both Stripe and Salesforce cloud services\r\n\r\n**Security Settings:**\r\n- TLS 1.2+ for all external communications\r\n- Webhook signature validation for Stripe events\r\n- OAuth or secure authentication for Salesforce API access\r\n\r\n**Deployment Considerations:**\r\n- Deploy to cloud runtime for high availability\r\n- Configure appropriate memory allocation for JSON/XML processing\r\n- Set up monitoring for webhook delivery failures\r\n- Implement error handling for Salesforce API limits\r\n\r\n**Required Resources:**\r\n- Memory: 2GB minimum for JSON/XML transformation\r\n- CPU: 2 cores for concurrent webhook processing\r\n- Network: Reliable internet connectivity for cloud API access\r\n- Storage: Minimal temporary storage for message processing\r\n\r\n## API Reference\r\n\r\n### Webhook Processing Endpoint\r\n\r\n**POST** `/stripe/subscription/webhook`\r\n\r\nProcesses Stripe subscription completion webhooks and creates corresponding Salesforce opportunities.\r\n\r\n#### Request Headers\r\n| Header | Type | Required | Description |\r\n|--------|------|----------|-------------|\r\n| `Content-Type` | String | Yes | Must be `application/json` |\r\n| `Stripe-Signature` | String | Yes | Webhook signature for authentication |\r\n\r\n#### Request Body Schema\r\n```json\r\n{\r\n  \"id\": \"string\",\r\n  \"object\": \"event\",\r\n  \"type\": \"customer.subscription.created\",\r\n  \"data\": {\r\n    \"object\": {\r\n      \"id\": \"string\",\r\n      \"customer\": \"string\", \r\n      \"status\": \"string\",\r\n      \"current_period_start\": \"number\",\r\n      \"current_period_end\": \"number\"\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n#### Response Codes\r\n| Code | Description | Response Body |\r\n|------|-------------|---------------|\r\n| 200 | Success | `{\"status\": \"processed\", \"opportunity_id\": \"string\"}` |\r\n| 400 | Bad Request | `{\"error\": \"Invalid webhook signature\"}` |\r\n| 422 | Validation Error | `{\"error\": \"Missing required subscription data\"}` |\r\n| 500 | Server Error | `{\"error\": \"Salesforce integration failed\"}` |\r\n\r\n#### Authentication\r\n- **Type:** Webhook Signature Validation\r\n- **Header:** `Stripe-Signature`\r\n- **Method:** HMAC SHA256 verification using webhook secret\r\n\r\n#### Rate Limiting\r\n- Depends on Stripe webhook delivery frequency\r\n- Salesforce API limits: 15,000 calls per 24 hours (varies by license)\r\n- Recommended: Implement queuing for high-volume scenarios\r\n\r\n#### Error Handling\r\n- Invalid signatures result in 400 responses\r\n- Salesforce API failures result in 500 responses with retry logic\r\n- Webhook delivery failures are handled by Stripe's retry mechanism",
  "markdown_length": 17147,
  "constructed_query": "Create a complete SAP iFlow integration package named 'IFlow_4c7628e4' with the following requirements from the documentation:\n\n# Stripe to Salesforce Opportunity Creation Integration\r\n\r\n## Table of Contents\r\n\r\n1. [API Overview](#api-overview)\r\n2. [Endpoints](#endpoints)\r\n3. [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n   - [Process Flow Overview](#process-flow-overview)\r\n   - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n     - [Step 1: Start Event (shape1)](#step-1-start-event-shape1)\r\n     - [Step 2: Document Properties (shape6)](#step-2-document-properties-shape6)\r\n     - [Step 3: Transform/Map Components (shape4)](#step-3-transformmap-components-shape4)\r\n     - [Step 4: Connector Actions (shape3)](#step-4-connector-actions-shape3)\r\n     - [Step 5: End Events (shape5)](#step-5-end-events-shape5)\r\n4. [Boomi Transformations Explained](#boomi-transformations-explained)\r\n5. [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n   - [Component Mapping](#component-mapping)\r\n   - [Integration Flow Visualization](#integration-flow-visualization)\r\n   - [Configuration Details](#configuration-details)\r\n6. [Environment Configuration](#environment-configuration)\r\n7. [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration provides automated creation of Salesforce Opportunities based on Stripe subscription completion events. The API serves as a bridge between Stripe's webhook notifications and Salesforce's Opportunity creation process, enabling real-time synchronization of subscription data into sales opportunities for tracking and management.\r\n\r\n**Base URL Pattern:** This integration operates as a webhook receiver, processing inbound HTTP requests from Stripe\r\n**Authentication:** Webhook authentication via Stripe webhook signing\r\n**Rate Limiting:** Dependent on Stripe webhook delivery patterns and Salesforce API limits\r\n**Response Format:** JSON responses for webhook acknowledgment\r\n\r\n## Endpoints\r\n\r\n### Webhook Receiver Endpoint\r\n- **HTTP Method:** POST\r\n- **Path:** `/stripe/subscription/webhook`\r\n- **Purpose:** Receives Stripe subs\n\nGenerate a production-ready iFlow with proper:\n1. Start and End events\n2. Required adapters and connectors\n3. Content modifiers and processing steps\n4. Proper sequence flows\n5. Error handling\n6. SAP Integration Suite compliance\n",
  "query_length": 2358,
  "markdown_truncated_at": 2000,
  "api_endpoint": "/api/generate-iflow-from-markdown",
  "request_time": "2025-10-16T18:05:28.511657"
}