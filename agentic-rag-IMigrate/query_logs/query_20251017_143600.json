{
  "timestamp": "20251017_143600",
  "job_id": "812dc57e-8b26-4b43-aea5-bde24dffe031",
  "iflow_name": "IFlow_5df6710f",
  "original_markdown": "# Stripe to Salesforce Opportunity Creation Integration\r\n\r\n## Table of Contents\r\n\r\n- [API Overview](#api-overview)\r\n- [Endpoints](#endpoints)\r\n- [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n  - [Process Flow Overview](#process-flow-overview)\r\n  - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n    - [Step 1: Start Event (shape1)](#step-1-start-event-shape1)\r\n    - [Step 2: Document Properties (shape6)](#step-2-document-properties-shape6)\r\n    - [Step 3: Transform/Map Component (shape4)](#step-3-transformmap-component-shape4)\r\n    - [Step 4: Salesforce Connector Action (shape3)](#step-4-salesforce-connector-action-shape3)\r\n    - [Step 5: End Event (shape5)](#step-5-end-event-shape5)\r\n- [Boomi Transformations Explained](#boomi-transformations-explained)\r\n- [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n  - [Component Mapping](#component-mapping)\r\n  - [Integration Flow Visualization](#integration-flow-visualization)\r\n  - [Configuration Details](#configuration-details)\r\n- [Environment Configuration](#environment-configuration)\r\n- [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration creates a seamless connection between Stripe subscription events and Salesforce opportunity management. The integration automatically captures completed Stripe subscriptions and converts them into qualified sales opportunities in Salesforce, enabling sales teams to track and manage customer relationships effectively.\r\n\r\n**Base URL/Endpoint Pattern:**\r\n- Stripe Webhook Endpoint: Configurable via process properties\r\n- Salesforce API Endpoint: Standard Salesforce REST API v1\r\n\r\n**Authentication Mechanisms:**\r\n- Stripe: Webhook signature verification\r\n- Salesforce: OAuth 2.0 with refresh token support\r\n\r\n**Rate Limiting Information:**\r\n- Stripe: Standard webhook delivery with retry mechanism\r\n- Salesforce: Standard API rate limits apply (24-hour rolling limit)\r\n\r\n**General Response Format:**\r\n- Input: JSON (Stripe subscription completed event)\r\n- Output: XML (Salesforce sObject create response)\r\n\r\n## Endpoints\r\n\r\n### Stripe Webhook Receiver\r\n\r\n**HTTP Method:** POST  \r\n**Full Path:** Configurable webhook endpoint  \r\n**Purpose:** Receives subscription completed events from Stripe\r\n\r\n**Request Parameters:**\r\n- **Headers:**\r\n  - `stripe-signature`: Webhook signature for verification\r\n  - `content-type`: application/json\r\n\r\n**Request Body Structure:**\r\n- JSON payload containing Stripe subscription event data\r\n- Event type: `customer.subscription.created` or `customer.subscription.updated`\r\n- Includes customer information, subscription details, and metadata\r\n\r\n**Response Format:**\r\n- Status Code: 200 (Success)\r\n- Status Code: 400 (Bad Request - Invalid signature)\r\n- Status Code: 500 (Internal Server Error)\r\n\r\n### Salesforce Opportunity Creation\r\n\r\n**HTTP Method:** POST  \r\n**Full Path:** `/services/data/v1/sobjects/Opportunity/`  \r\n**Purpose:** Creates new Opportunity records in Salesforce\r\n\r\n**Request Body Structure:**\r\n- XML format following Salesforce sObject schema\r\n- Required fields: Name, Description, CloseDate\r\n- Optional fields: StageName, Probability, Amount\r\n\r\n**Response Format:**\r\n- Status Code: 201 (Created)\r\n- Response includes: Id, Success status, Created timestamp\r\n\r\n## Current Boomi Flow Logic\r\n\r\n### Process Flow Overview\r\n\r\nThis Boomi integration process orchestrates the conversion of Stripe subscription events into Salesforce opportunities through a streamlined five-step workflow:\r\n\r\n1. **Event Reception**: Webhook listener captures Stripe subscription completed events\r\n2. **Property Enhancement**: Dynamic document properties extract and calculate key business data\r\n3. **Data Transformation**: JSON-to-XML mapping transforms Stripe data to Salesforce format\r\n4. **Opportunity Creation**: Salesforce connector creates new opportunity records\r\n5. **Process Completion**: Successful completion with response handling\r\n\r\nThe process leverages Boomi's document property capabilities to perform complex data calculations and HTTP API calls within the integration flow, enabling real-time customer and product information enrichment.\r\n\r\n### Step-by-Step Flow Description\r\n\r\n---\r\n\r\n#### **Step 1: Start Event (shape1)**\r\n\r\n**Component Type:** Start Event\r\n\r\n**Purpose:** Initiates the integration process when Stripe webhook events are received\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** Event listener/webhook receiver\r\n- **Operation:** Listen for incoming HTTP POST requests\r\n- **Input Profile:** JSON format (Stripe webhook payload)\r\n- **Trigger Conditions:** Stripe subscription completed events\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook JSON payload with subscription event data\r\n- **Processing:** Event validation and initial data capture\r\n- **Output:** Parsed subscription event data ready for property enhancement\r\n\r\n---\r\n\r\n#### **Step 2: Document Properties (shape6)**\r\n\r\n**Component Type:** Document Properties\r\n\r\n**Purpose:** Extracts key business data and performs dynamic calculations for Salesforce opportunity creation\r\n\r\n**Configuration Details:**\r\n\r\n- **Dynamic Properties:** 4 dynamic document properties configured\r\n  - Dynamic Document Property - DDP_CustomerName: Process property mapping for customer identification\r\n  - Dynamic Document Property - DDP_Subscription: Process property mapping for subscription details  \r\n  - Dynamic Document Property - DDP_SalesforceDescription: Process property mapping for opportunity description\r\n  - Additional property for business logic enhancement\r\n- **HTTP Calls:** Potential external API calls for data enrichment (configuration-dependent)\r\n- **Calculations:** Dynamic property calculations based on subscription data\r\n- **Parameter Mappings:** Source value configurations from incoming JSON payload\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Raw Stripe subscription JSON data\r\n- **Processing:** Property extraction, calculation, and external data enrichment\r\n- **Output:** Enhanced data with calculated properties ready for transformation\r\n\r\n---\r\n\r\n#### **Step 3: Transform/Map Component (shape4)**\r\n\r\n**Component Type:** Map/Transform\r\n\r\n**Purpose:** Converts JSON subscription data to Salesforce Opportunity XML format\r\n\r\n**Configuration Details:**\r\n\r\n- **Input Profile:** JSON (Subscription Completed event structure)\r\n- **Output Profile:** XML (Salesforce Opportunity CREATE Request structure)\r\n- **Transformation Logic:** Direct field mapping with function-based data retrieval\r\n- **Function Steps:** DocumentPropertyGet functions for dynamic data insertion\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| Function Output (DDP_SalesforceDescription) | Opportunity/Description | String | Maps calculated description to Salesforce opportunity description field |\r\n| Function Output (DDP_CustomerName) | Opportunity/Name | String | Maps customer name to Salesforce opportunity name field |\r\n| Function Output (DDP_CloseDate) | Opportunity/CloseDate | Date | Maps calculated close date to Salesforce opportunity close date field |\r\n\r\n**Transformation Functions:**\r\n\r\n**Get Document Property (ProcessProperty) - Description**\r\n- **Purpose:** Retrieves calculated Salesforce description from document properties\r\n- **Output Parameters:** Dynamic Document Property - DDP_SalesforceDescription\r\n\r\n**Get Document Property (ProcessProperty) - Customer Name**\r\n- **Purpose:** Retrieves customer name from document properties  \r\n- **Output Parameters:** Dynamic Document Property - DDP_CustomerName\r\n\r\n**Get Document Property (ProcessProperty) - Close Date**\r\n- **Purpose:** Retrieves calculated close date from document properties\r\n- **Output Parameters:** Dynamic Document Property - DDP_CloseDate\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Enhanced subscription data with document properties\r\n- **Processing:** JSON to XML transformation with dynamic field population\r\n- **Output:** Salesforce-compliant Opportunity XML ready for API submission\r\n\r\n---\r\n\r\n#### **Step 4: Salesforce Connector Action (shape3)**\r\n\r\n**Component Type:** Salesforce Connector\r\n\r\n**Purpose:** Creates new Opportunity records in Salesforce using the transformed data\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** Salesforce\r\n- **Operation:** Create\r\n- **Target Object:** Opportunity\r\n- **Authentication:** OAuth 2.0 with configured credentials\r\n- **Error Handling:** Standard Salesforce API error responses\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce Opportunity XML with all required fields populated\r\n- **Processing:** API call to Salesforce to create new Opportunity record\r\n- **Output:** Salesforce create response with success status and record ID\r\n\r\n---\r\n\r\n#### **Step 5: End Event (shape5)**\r\n\r\n**Component Type:** End Event\r\n\r\n**Purpose:** Completes the integration process successfully\r\n\r\n**Configuration Details:**\r\n\r\n- **Completion Type:** Success completion\r\n- **Final Actions:** Process completion logging\r\n- **Continuation Settings:** Process stops after successful completion\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce API response confirming opportunity creation\r\n- **Processing:** Final status logging and cleanup\r\n- **Output:** Process completion confirmation with success status\r\n\r\n---\r\n\r\n## Boomi Transformations Explained\r\n\r\n### Subscription Completed JSON to SF Opportunity CREATE Request XML\r\n\r\n**Purpose:** This transformation converts Stripe subscription event data from JSON format into Salesforce-compatible XML for opportunity creation.\r\n\r\n**Input Profile:** JSON structure containing Stripe subscription completed event data including customer information, subscription details, and metadata.\r\n\r\n**Output Profile:** XML structure following Salesforce Opportunity sObject schema with fields for Name, Description, CloseDate, and other standard opportunity attributes.\r\n\r\n**Complete Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| DocumentProperty(DDP_SalesforceDescription) | Opportunity/Description | String | Populates opportunity description with calculated business context from subscription data |\r\n| DocumentProperty(DDP_CustomerName) | Opportunity/Name | String | Sets opportunity name using extracted customer information from subscription |\r\n| DocumentProperty(DDP_CloseDate) | Opportunity/CloseDate | Date | Defines opportunity close date based on subscription lifecycle calculations |\r\n\r\n**Function Steps Used:**\r\n\r\n1. **DocumentPropertyGet (DDP_SalesforceDescription)** - Retrieves calculated description text combining subscription and customer details\r\n2. **DocumentPropertyGet (DDP_CustomerName)** - Retrieves formatted customer name for opportunity identification  \r\n3. **DocumentPropertyGet (DDP_CloseDate)** - Retrieves calculated close date based on subscription terms\r\n\r\n**Default Values and Constants:**\r\n- Standard Salesforce opportunity stage and probability values may be applied via additional mappings\r\n- Timestamp functions used for audit trail fields\r\n\r\n**Complete Mapping Configuration:**\r\nThe transformation uses three primary mappings (referenced as mappings 3) that connect document property function outputs directly to Salesforce opportunity profile fields, ensuring dynamic data population based on subscription context.\r\n\r\n## SAP Integration Suite Implementation\r\n\r\n### Component Mapping\r\n\r\n#### Main Process Component Mapping\r\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\r\n|-----------------|----------------------------------|---------|\r\n| Start Event (shape1) | Start Message Event with HTTPS Adapter | Webhook receiver for Stripe subscription events |\r\n| Document Properties (shape6) | Content Modifier (Set Properties) | Calculate and set dynamic properties from subscription data |\r\n| Map/Transform (shape4) | Message Mapping | Transform JSON subscription data to Salesforce XML format |\r\n| Salesforce Connector (shape3) | HTTPS Adapter with Salesforce endpoint | Create opportunities in Salesforce via REST API |\r\n| End Event (shape5) | End Message Event | Process completion and success confirmation |\r\n\r\n### Integration Flow Visualization\r\n\r\n```mermaid\r\nflowchart TD\r\n%% Define node styles for SAP Integration Suite components\r\nclassDef httpAdapter fill:#87CEEB,stroke:#333,stroke-width:2px\r\nclassDef contentModifier fill:#98FB98,stroke:#333,stroke-width:2px\r\nclassDef mapping fill:#DDA0DD,stroke:#333,stroke-width:2px\r\nclassDef adapter fill:#FFD700,stroke:#333,stroke-width:2px\r\nclassDef event fill:#C0C0C0,stroke:#333,stroke-width:2px\r\n\r\n%% Main Integration Flow\r\nStart((\"Start Message Event\")) --> StripeWebhook[\"HTTPS Adapter:<br/>Stripe Webhook Receiver\"]:::httpAdapter\r\nStripeWebhook --> SetDynamicProps[\"Content Modifier:<br/>Set Dynamic Properties\"]:::contentModifier\r\nSetDynamicProps --> TransformData[\"Message Mapping:<br/>JSON to Salesforce XML\"]:::mapping\r\nTransformData --> SalesforceCreate[\"HTTPS Adapter:<br/>Salesforce Opportunity Create\"]:::adapter\r\nSalesforceCreate --> End((\"End Message Event\")):::event\r\n\r\n%% Dynamic Properties Detail\r\nsubgraph DynamicProperties[\"Dynamic Properties Calculation\"]\r\n    ExtractCustomer[\"Extract Customer Name<br/>from Subscription Data\"]:::contentModifier\r\n    ExtractSubscription[\"Extract Subscription Details<br/>for Description\"]:::contentModifier\r\n    CalcCloseDate[\"Calculate Close Date<br/>based on Subscription Terms\"]:::contentModifier\r\n    BuildDescription[\"Build Salesforce Description<br/>from Multiple Fields\"]:::contentModifier\r\nend\r\n\r\n%% Apply styling\r\nclass StripeWebhook,SalesforceCreate httpAdapter\r\nclass SetDynamicProps,ExtractCustomer,ExtractSubscription,CalcCloseDate,BuildDescription contentModifier\r\nclass TransformData mapping\r\nclass Start,End event\r\n```\r\n\r\n### Configuration Details\r\n\r\n**HTTPS Adapter - Stripe Webhook Receiver:**\r\n- Address: Configurable webhook endpoint URL\r\n- Method: POST\r\n- Authentication: None (signature verification in content)\r\n- Content Type: application/json\r\n- Response Format: Standard HTTP status codes\r\n\r\n**Content Modifier - Dynamic Properties:**\r\n- Property 1: DDP_CustomerName (String) - Extracted from subscription.customer\r\n- Property 2: DDP_Subscription (String) - Subscription ID and details  \r\n- Property 3: DDP_SalesforceDescription (String) - Formatted description text\r\n- Property 4: DDP_CloseDate (Date) - Calculated based on subscription lifecycle\r\n\r\n**Message Mapping - JSON to XML:**\r\n- Source Schema: Stripe subscription JSON structure\r\n- Target Schema: Salesforce Opportunity XML schema\r\n- Function Libraries: DocumentPropertyGet for dynamic field population\r\n- Mapping Type: Direct field mapping with property injection\r\n\r\n**HTTPS Adapter - Salesforce Create:**\r\n- Address: https://[salesforce-instance].salesforce.com/services/data/v1/sobjects/Opportunity/\r\n- Method: POST\r\n- Authentication: OAuth 2.0 Bearer Token\r\n- Content Type: application/xml\r\n- Response Format: Salesforce sObject create response\r\n\r\n## Environment Configuration\r\n\r\n**Important Configuration Parameters:**\r\n- Stripe webhook endpoint URL and signature verification key\r\n- Salesforce API endpoint and OAuth credentials (Client ID, Client Secret, Refresh Token)\r\n- Dynamic property calculation rules for customer name extraction\r\n- Close date calculation logic based on subscription terms\r\n\r\n**Environment Variables:**\r\n- `STRIPE_WEBHOOK_SECRET`: Webhook signature verification key\r\n- `SALESFORCE_CLIENT_ID`: OAuth application client identifier\r\n- `SALESFORCE_CLIENT_SECRET`: OAuth application client secret  \r\n- `SALESFORCE_REFRESH_TOKEN`: OAuth refresh token for API access\r\n- `SALESFORCE_INSTANCE_URL`: Target Salesforce org URL\r\n\r\n**Dependencies on External Systems:**\r\n- Stripe webhook delivery system for subscription events\r\n- Salesforce API availability and authentication services\r\n- Network connectivity to Stripe and Salesforce cloud services\r\n\r\n**Security Settings:**\r\n- HTTPS/TLS encryption for all external communications\r\n- OAuth 2.0 token management for Salesforce authentication\r\n- Webhook signature verification for Stripe event validation\r\n\r\n**Deployment Considerations:**\r\n- Cloud-based deployment recommended for webhook accessibility\r\n- High availability configuration for business-critical integrations\r\n- Monitoring and alerting for failed webhook deliveries\r\n\r\n**Required Resources:**\r\n- Memory: Minimum 2GB for JSON/XML processing\r\n- CPU: Standard multi-core processing capability\r\n- Network: Reliable internet connectivity for cloud API access\r\n- Storage: Minimal temporary storage for message processing\r\n\r\n## API Reference\r\n\r\n### Stripe Webhook Events\r\n\r\n**Endpoint:** POST /webhook/stripe\r\n**Authentication:** Webhook signature verification\r\n**Content Type:** application/json\r\n\r\n**Request Schema:**\r\n```json\r\n{\r\n  \"type\": \"customer.subscription.created\",\r\n  \"data\": {\r\n    \"object\": {\r\n      \"id\": \"sub_1234567890\",\r\n      \"customer\": \"cus_1234567890\",\r\n      \"status\": \"active\",\r\n      \"current_period_start\": 1234567890,\r\n      \"current_period_end\": 1234567890\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n**Response Codes:**\r\n- 200: Event processed successfully\r\n- 400: Invalid webhook signature\r\n- 500: Internal processing error\r\n\r\n### Salesforce Opportunity Creation\r\n\r\n**Endpoint:** POST /services/data/v1/sobjects/Opportunity/\r\n**Authentication:** OAuth 2.0 Bearer Token\r\n**Content Type:** application/xml\r\n\r\n**Request Schema:**\r\n```xml\r\n<Opportunity>\r\n    <Name>Customer Name - Subscription</Name>\r\n    <Description>Subscription details and customer information</Description>\r\n    <CloseDate>2024-12-31</CloseDate>\r\n</Opportunity>\r\n```\r\n\r\n**Response Schema:**\r\n```xml\r\n<sObjects>\r\n    <id>0061234567890ABC</id>\r\n    <success>true</success>\r\n    <created>true</created>\r\n</sObjects>\r\n```\r\n\r\n**Error Codes:**\r\n- 201: Opportunity created successfully\r\n- 400: Invalid request data or missing required fields\r\n- 401: Authentication failure\r\n- 403: Insufficient permissions\r\n- 500: Salesforce internal error\r\n\r\n**Rate Limiting:**\r\n- Standard Salesforce API limits apply\r\n- Typically 15,000-100,000+ API calls per 24-hour period depending on edition\r\n- Webhook processing should implement retry logic for rate limit scenarios\r\n\r\n**Versioning:**\r\n- Stripe API: Latest webhook API version\r\n- Salesforce API: v1 (configurable to higher versions)\r\n- Integration maintains backward compatibility with established webhook formats",
  "markdown_length": 18399,
  "constructed_query": "Create a complete SAP iFlow integration package named 'IFlow_5df6710f' with the following requirements from the documentation:\n\n# Stripe to Salesforce Opportunity Creation Integration\r\n\r\n## Table of Contents\r\n\r\n- [API Overview](#api-overview)\r\n- [Endpoints](#endpoints)\r\n- [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n  - [Process Flow Overview](#process-flow-overview)\r\n  - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n    - [Step 1: Start Event (shape1)](#step-1-start-event-shape1)\r\n    - [Step 2: Document Properties (shape6)](#step-2-document-properties-shape6)\r\n    - [Step 3: Transform/Map Component (shape4)](#step-3-transformmap-component-shape4)\r\n    - [Step 4: Salesforce Connector Action (shape3)](#step-4-salesforce-connector-action-shape3)\r\n    - [Step 5: End Event (shape5)](#step-5-end-event-shape5)\r\n- [Boomi Transformations Explained](#boomi-transformations-explained)\r\n- [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n  - [Component Mapping](#component-mapping)\r\n  - [Integration Flow Visualization](#integration-flow-visualization)\r\n  - [Configuration Details](#configuration-details)\r\n- [Environment Configuration](#environment-configuration)\r\n- [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration creates a seamless connection between Stripe subscription events and Salesforce opportunity management. The integration automatically captures completed Stripe subscriptions and converts them into qualified sales opportunities in Salesforce, enabling sales teams to track and manage customer relationships effectively.\r\n\r\n**Base URL/Endpoint Pattern:**\r\n- Stripe Webhook Endpoint: Configurable via process properties\r\n- Salesforce API Endpoint: Standard Salesforce REST API v1\r\n\r\n**Authentication Mechanisms:**\r\n- Stripe: Webhook signature verification\r\n- Salesforce: OAuth 2.0 with refresh token support\r\n\r\n**Rate Limiting Information:**\r\n- Stripe: Standard webhook delivery with retry mechanism\r\n- Salesforce: Standard API rate limits apply (24-hour rolling limit)\r\n\r\n**General Response Format:**\r\n- Input: JSON (Stripe subscr\n\nGenerate a production-ready iFlow with proper:\n1. Start and End events\n2. Required adapters and connectors\n3. Content modifiers and processing steps\n4. Proper sequence flows\n5. Error handling\n6. SAP Integration Suite compliance\n",
  "query_length": 2358,
  "markdown_truncated_at": 2000,
  "api_endpoint": "/api/generate-iflow-from-markdown",
  "request_time": "2025-10-17T14:36:00.267460"
}