{
  "timestamp": "20251022_214702",
  "job_id": null,
  "iflow_name": "IFlow_530f55fb",
  "original_markdown": "# Stripe Subscription to Salesforce Opportunity Integration\r\n\r\n## Table of Contents\r\n\r\n1. [API Overview](#api-overview)\r\n2. [Endpoints](#endpoints)\r\n3. [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n   - [Process Flow Overview](#process-flow-overview)\r\n   - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n4. [Boomi Transformations Explained](#boomi-transformations-explained)\r\n5. [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n   - [Component Mapping](#component-mapping)\r\n   - [Integration Flow Visualization](#integration-flow-visualization)\r\n   - [Configuration Details](#configuration-details)\r\n6. [Environment Configuration](#environment-configuration)\r\n7. [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration creates Salesforce Opportunities from Stripe subscription events using Dell Boomi as the integration platform. The solution processes Stripe webhook notifications for subscription completions and transforms them into Salesforce Opportunity records, enabling seamless revenue tracking from payment processing to CRM.\r\n\r\n**Key Integration Capabilities:**\r\n- Real-time webhook processing from Stripe\r\n- Dynamic data enrichment and property calculation\r\n- Automated Salesforce Opportunity creation\r\n- Error handling and exception management\r\n\r\n**Business Purpose:**\r\nThe integration ensures that completed Stripe subscriptions are automatically converted into sales opportunities within Salesforce, providing visibility into revenue pipeline and customer acquisition metrics.\r\n\r\n**Authentication Mechanisms:**\r\n- Stripe: Webhook signature validation\r\n- Salesforce: OAuth 2.0 or Username/Password authentication\r\n\r\n**Data Flow Pattern:**\r\nEvent-driven integration triggered by Stripe webhook events, with synchronous processing and Salesforce API interaction.\r\n\r\n## Endpoints\r\n\r\n### Stripe Webhook Endpoint\r\n- **HTTP Method:** POST\r\n- **Purpose:** Receives subscription completion events from Stripe\r\n- **Trigger:** Stripe webhook for subscription.completed events\r\n- **Request Body:** JSON payload containing subscription details\r\n- **Response Format:** HTTP 200 OK for successful processing\r\n\r\n### Salesforce API Endpoint\r\n- **HTTP Method:** POST\r\n- **Purpose:** Creates new Opportunity records in Salesforce\r\n- **Target Object:** Opportunity\r\n- **Operation:** Create\r\n- **Request Format:** XML-based Salesforce API request\r\n- **Response Format:** Salesforce API response with created record ID\r\n\r\n## Current Boomi Flow Logic\r\n\r\n### Process Flow Overview\r\n\r\nThe Boomi integration follows an event-driven pattern that processes Stripe subscription webhook events and creates corresponding Salesforce opportunities. The process includes:\r\n\r\n1. **Event Reception:** Webhook listener receives Stripe subscription completed events\r\n2. **Dynamic Property Calculation:** Extracts and calculates business properties from subscription data\r\n3. **Data Transformation:** Converts JSON webhook payload to Salesforce XML format\r\n4. **Opportunity Creation:** Sends transformed data to Salesforce to create new Opportunity records\r\n5. **Error Handling:** Manages exceptions and processing failures\r\n\r\n### Step-by-Step Flow Description\r\n\r\n---\r\n\r\n#### **Step 1: Start Event (shape1)**\r\n\r\n**Component Type:** Start Event\r\n\r\n**Purpose:** Receives incoming Stripe webhook notifications for subscription completion events\r\n\r\n**Configuration Details:**\r\n\r\n- **Trigger Type:** Webhook listener\r\n- **Input Format:** JSON payload from Stripe\r\n- **Event Filter:** Subscription completed events\r\n- **Authentication:** Webhook signature validation\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook JSON payload containing subscription details\r\n- **Processing:** Event validation and initial payload parsing\r\n- **Output:** Validated subscription data ready for processing\r\n\r\n---\r\n\r\n#### **Step 2: Document Properties (shape6)**\r\n\r\n**Component Type:** Document Properties - Set Dynamic Properties\r\n\r\n**Purpose:** Calculates and sets dynamic properties for customer name, subscription details, Salesforce description, and close date\r\n\r\n**Configuration Details:**\r\n\r\n- **Dynamic Properties Set:** 4 dynamic properties\r\n  - Dynamic Document Property - DDP_CustomerName\r\n  - Dynamic Document Property - DDP_Subscription  \r\n  - Dynamic Document Property - DDP_SalesforceDescription\r\n  - Dynamic Document Property - DDP_CloseDate (implied from transformation)\r\n\r\n**Property Calculations:**\r\n\r\n| Property Name | Source Calculation | Business Purpose |\r\n|---------------|-------------------|------------------|\r\n| DDP_CustomerName | Extracted from Stripe customer data | Customer identification for opportunity |\r\n| DDP_Subscription | Subscription details from webhook | Subscription reference information |\r\n| DDP_SalesforceDescription | Formatted description combining customer and subscription data | Opportunity description field |\r\n| DDP_CloseDate | Calculated close date based on subscription | Opportunity close date projection |\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Stripe webhook JSON payload\r\n- **Processing:** Dynamic property extraction and calculation from subscription data\r\n- **Output:** Enhanced data with calculated business properties\r\n\r\n---\r\n\r\n#### **Step 3: Transform/Map Component (shape4)**\r\n\r\n**Component Type:** Map/Transform - Subscription Completed JSON to SF Opportunity CREATE Request XML\r\n\r\n**Purpose:** Transforms Stripe subscription JSON data into Salesforce Opportunity XML format\r\n\r\n**Configuration Details:**\r\n\r\n- **Input Profile:** JSON subscription data from Stripe webhook\r\n- **Output Profile:** Salesforce Opportunity XML structure\r\n- **Transformation Logic:** Field mapping with dynamic property integration\r\n- **Function Steps:** DocumentPropertyGet functions for dynamic values\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** JSON subscription data with calculated dynamic properties\r\n- **Processing:** Field-by-field transformation from JSON to Salesforce XML\r\n- **Output:** Salesforce-compatible XML for Opportunity creation\r\n\r\n---\r\n\r\n#### **Step 4: Connector Action (shape3)**\r\n\r\n**Component Type:** Salesforce Connector - SF Opportunity CREATE Operation\r\n\r\n**Purpose:** Creates new Opportunity records in Salesforce using transformed subscription data\r\n\r\n**Configuration Details:**\r\n\r\n- **Connector Type:** Salesforce\r\n- **Operation:** Create\r\n- **Target Object:** Opportunity\r\n- **Authentication Method:** Salesforce API authentication\r\n- **Error Handling:** Salesforce API error management\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce Opportunity XML from transformation\r\n- **Processing:** Salesforce API call to create Opportunity record\r\n- **Output:** Salesforce response with created Opportunity ID\r\n\r\n---\r\n\r\n#### **Step 5: End Event (shape5)**\r\n\r\n**Component Type:** End Event\r\n\r\n**Purpose:** Completes the integration process successfully\r\n\r\n**Configuration Details:**\r\n\r\n- **Completion Type:** Success completion\r\n- **Final Actions:** Process completion logging\r\n- **Response Handling:** Success response to Stripe webhook\r\n\r\n**Data Flow:**\r\n\r\n- **Input:** Salesforce creation response\r\n- **Processing:** Final process completion actions\r\n- **Output:** Integration completion status\r\n\r\n## Boomi Transformations Explained\r\n\r\n### Subscription Completed JSON to SF Opportunity CREATE Request XML\r\n\r\n**Input Profile:** Stripe Subscription Webhook JSON\r\n- Contains subscription details, customer information, and payment data\r\n- Nested JSON structure with subscription, customer, and product objects\r\n- Event metadata and timestamps\r\n\r\n**Output Profile:** Salesforce Opportunity XML\r\n- Standard Salesforce API XML structure for Opportunity creation\r\n- Required fields: Name, Description, CloseDate\r\n- Follows Salesforce SOAP API format\r\n\r\n**Field Mappings:**\r\n\r\n| Source Field | Target Field | Data Type | Business Purpose |\r\n|--------------|--------------|-----------|------------------|\r\n| Dynamic Property (DDP_SalesforceDescription) | Opportunity/Description | String | Maps calculated description to Salesforce opportunity description |\r\n| Dynamic Property (DDP_CustomerName) | Opportunity/Name | String | Maps customer name to Salesforce opportunity name |\r\n| Dynamic Property (DDP_CloseDate) | Opportunity/CloseDate | Date | Maps calculated close date to Salesforce opportunity close date |\r\n\r\n**Transformation Functions:**\r\n\r\n1. **Get Document Property (ProcessProperty) - DDP_SalesforceDescription**\r\n   - **Purpose:** Retrieves calculated Salesforce description from dynamic properties\r\n   - **Output:** Formatted description combining customer and subscription details\r\n\r\n2. **Get Document Property (ProcessProperty) - DDP_CustomerName** \r\n   - **Purpose:** Retrieves customer name from dynamic properties\r\n   - **Output:** Customer name for opportunity identification\r\n\r\n3. **Get Document Property (ProcessProperty) - DDP_CloseDate**\r\n   - **Purpose:** Retrieves calculated close date from dynamic properties  \r\n   - **Output:** Projected opportunity close date\r\n\r\n**Mapping Configuration:**\r\n- **Function Output → Opportunity/Description** (profile mapping)\r\n- **Function Output → Opportunity/Name** (profile mapping)  \r\n- **Function Output → Opportunity/CloseDate** (profile mapping)\r\n\r\n## SAP Integration Suite Implementation\r\n\r\n### Component Mapping\r\n\r\n#### Main Process Component Mapping\r\n| Boomi Component | SAP Integration Suite Equivalent | Purpose |\r\n|-----------------|----------------------------------|---------|\r\n| Start Event (shape1) | Start Message Event with HTTPS Adapter | Receives Stripe webhook notifications |\r\n| Set Dynamic Properties (shape6) | Content Modifier (Set Properties) | Calculates and sets dynamic business properties |\r\n| Transform/Map (shape4) | Message Mapping | Transforms JSON to Salesforce XML format |\r\n| Salesforce Connector (shape3) | Request Reply with Salesforce Adapter | Creates Salesforce Opportunity records |\r\n| End Event (shape5) | End Message Event | Completes integration process successfully |\r\n\r\n### Integration Flow Visualization\r\n\r\n```mermaid\r\nflowchart TD\r\n    %% Define node styles for SAP Integration Suite components\r\n    classDef httpAdapter fill:#87CEEB,stroke:#333,stroke-width:2px\r\n    classDef contentModifier fill:#98FB98,stroke:#333,stroke-width:2px\r\n    classDef mapping fill:#DDA0DD,stroke:#333,stroke-width:2px\r\n    classDef adapter fill:#FFD700,stroke:#333,stroke-width:2px\r\n    classDef event fill:#C0C0C0,stroke:#333,stroke-width:2px\r\n\r\n    %% Main Integration Flow\r\n    Start((\"Start Event\")):::event --> StripeWebhook[\"HTTPS Adapter: Stripe Webhook Receiver\"]:::httpAdapter\r\n    StripeWebhook --> SetDynamicProps[\"Content Modifier: Set Dynamic Properties\"]:::contentModifier\r\n    SetDynamicProps --> TransformData[\"Message Mapping: JSON to SF Opportunity XML\"]:::mapping\r\n    TransformData --> SalesforceCreate[\"Salesforce Adapter: Create Opportunity\"]:::adapter\r\n    SalesforceCreate --> End((\"End Event\")):::event\r\n\r\n    %% Dynamic Properties Detail\r\n    subgraph DynamicProperties[\"Dynamic Properties Calculation\"]\r\n        ExtractCustomer[\"Extract: Customer Name from JSON\"]:::contentModifier\r\n        ExtractSubscription[\"Extract: Subscription Details\"]:::contentModifier\r\n        CalcDescription[\"Calculate: Salesforce Description\"]:::contentModifier\r\n        CalcCloseDate[\"Calculate: Close Date\"]:::contentModifier\r\n        \r\n        ExtractCustomer --> CalcDescription\r\n        ExtractSubscription --> CalcDescription\r\n        CalcDescription --> CalcCloseDate\r\n    end\r\n\r\n    SetDynamicProps -.-> DynamicProperties\r\n```\r\n\r\n### Configuration Details\r\n\r\n#### HTTPS Adapter (Stripe Webhook Receiver)\r\n- **Address:** Webhook endpoint URL configured in Stripe\r\n- **Method:** POST\r\n- **Content Type:** application/json\r\n- **Authentication:** Webhook signature validation\r\n- **Message Processing:** Asynchronous\r\n\r\n#### Content Modifier (Set Dynamic Properties)\r\n- **Property Operations:** Set multiple dynamic properties\r\n- **Customer Name:** Extract from JSON path `$.data.object.customer.name`\r\n- **Subscription ID:** Extract from JSON path `$.data.object.id`\r\n- **Description Calculation:** Concatenate customer and subscription details\r\n- **Close Date Calculation:** Add billing cycle to current date\r\n\r\n#### Message Mapping (JSON to SF Opportunity XML)\r\n- **Source Message Type:** JSON (Stripe webhook format)\r\n- **Target Message Type:** XML (Salesforce Opportunity)\r\n- **Mapping Functions:** Property retrieval and data type conversion\r\n- **Required Fields Mapping:** Name, Description, CloseDate\r\n\r\n#### Salesforce Adapter (Create Opportunity)\r\n- **Connection Type:** Salesforce Cloud\r\n- **Operation:** Create\r\n- **Object:** Opportunity\r\n- **Authentication:** OAuth 2.0 or Username/Password\r\n- **Error Handling:** Exception subprocess for API errors\r\n\r\n## Environment Configuration\r\n\r\n### Required Configuration Parameters\r\n\r\n| Parameter Category | Parameter Name | Description | Example Value |\r\n|-------------------|----------------|-------------|---------------|\r\n| **Stripe Configuration** | Webhook Endpoint Secret | Stripe webhook signature validation key | `whsec_...` |\r\n| **Stripe Configuration** | API Version | Stripe API version for webhook compatibility | `2020-08-27` |\r\n| **Salesforce Configuration** | Instance URL | Salesforce organization instance URL | `https://mycompany.salesforce.com` |\r\n| **Salesforce Configuration** | API Version | Salesforce API version for compatibility | `v52.0` |\r\n| **Salesforce Configuration** | Username | Salesforce integration user username | `integration@company.com` |\r\n| **Salesforce Configuration** | Password | Salesforce integration user password | `encrypted_password` |\r\n| **Salesforce Configuration** | Security Token | Salesforce security token for API access | `security_token_value` |\r\n\r\n### Environment Variables\r\n\r\n| Variable Name | Description | Example Value | Required |\r\n|---------------|-------------|---------------|----------|\r\n| `STRIPE_WEBHOOK_SECRET` | Webhook endpoint secret for signature validation | `whsec_1234567890abcdef` | Yes |\r\n| `SALESFORCE_USERNAME` | Salesforce API username | `integration@company.com` | Yes |\r\n| `SALESFORCE_PASSWORD` | Salesforce API password | `encrypted_password` | Yes |\r\n| `SALESFORCE_TOKEN` | Salesforce security token | `token_value` | Yes |\r\n| `SALESFORCE_INSTANCE_URL` | Salesforce organization URL | `https://mycompany.salesforce.com` | Yes |\r\n\r\n### Dependencies on External Systems\r\n\r\n| System | Dependency Type | Configuration Required | Description |\r\n|--------|----------------|----------------------|-------------|\r\n| **Stripe** | Webhook Source | Webhook URL configuration in Stripe dashboard | Source system for subscription events |\r\n| **Salesforce** | Target System | API user with Opportunity create permissions | Target system for opportunity creation |\r\n\r\n### Security Settings\r\n\r\n| Security Component | Requirement | Configuration |\r\n|-------------------|-------------|---------------|\r\n| **Webhook Security** | Signature validation | Stripe webhook secret configuration |\r\n| **API Authentication** | Salesforce OAuth/Username-Password | Secure credential storage |\r\n| **Data Encryption** | TLS/HTTPS | All communications over encrypted channels |\r\n| **Access Control** | Role-based permissions | Salesforce user with minimal required permissions |\r\n\r\n### Deployment Considerations\r\n\r\n| Aspect | Requirement | Details |\r\n|--------|-------------|---------|\r\n| **Runtime Environment** | SAP Integration Suite Cloud | Cloud-based integration runtime |\r\n| **Memory Requirements** | 2GB minimum | Standard integration flow requirements |\r\n| **CPU Requirements** | 2 cores minimum | Adequate for real-time webhook processing |\r\n| **Network Requirements** | Outbound HTTPS access | Connectivity to Stripe webhooks and Salesforce API |\r\n| **Storage Requirements** | 1GB temporary space | Message processing and transformation storage |\r\n\r\n## API Reference\r\n\r\n### Stripe Webhook API\r\n\r\n#### Subscription Completed Event\r\n- **Method:** POST\r\n- **Content-Type:** application/json\r\n- **Authentication:** Webhook signature (HMAC SHA256)\r\n- **Event Type:** `invoice.payment_succeeded` or `customer.subscription.created`\r\n\r\n**Request Schema:**\r\n```json\r\n{\r\n  \"id\": \"evt_subscription_completed\",\r\n  \"object\": \"event\",\r\n  \"api_version\": \"2020-08-27\",\r\n  \"created\": 1234567890,\r\n  \"data\": {\r\n    \"object\": {\r\n      \"id\": \"sub_1234567890\",\r\n      \"object\": \"subscription\",\r\n      \"customer\": {\r\n        \"id\": \"cus_1234567890\",\r\n        \"name\": \"Customer Name\",\r\n        \"email\": \"customer@example.com\"\r\n      },\r\n      \"items\": {\r\n        \"data\": [\r\n          {\r\n            \"price\": {\r\n              \"id\": \"price_1234567890\",\r\n              \"nickname\": \"Product Name\",\r\n              \"unit_amount\": 2999\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"current_period_start\": 1234567890,\r\n      \"current_period_end\": 1234567890,\r\n      \"status\": \"active\"\r\n    }\r\n  },\r\n  \"type\": \"customer.subscription.created\"\r\n}\r\n```\r\n\r\n### Salesforce API\r\n\r\n#### Create Opportunity\r\n- **Method:** POST\r\n- **Endpoint:** `/services/data/v52.0/sobjects/Opportunity`\r\n- **Authentication:** OAuth 2.0 Bearer Token or Session ID\r\n- **Content-Type:** application/json\r\n\r\n**Request Schema:**\r\n```json\r\n{\r\n  \"Name\": \"Customer Name - Subscription\",\r\n  \"Description\": \"Opportunity created from Stripe subscription completion\",\r\n  \"CloseDate\": \"2024-12-31\",\r\n  \"StageName\": \"Prospecting\",\r\n  \"Amount\": 299.99\r\n}\r\n```\r\n\r\n**Response Schema:**\r\n```json\r\n{\r\n  \"id\": \"0061234567890ABC\",\r\n  \"success\": true,\r\n  \"errors\": []\r\n}\r\n```\r\n\r\n### Error Codes and Handling\r\n\r\n| Error Code | System | Description | Resolution |\r\n|------------|--------|-------------|------------|\r\n| **400** | Salesforce | Bad Request - Invalid field values | Validate required fields and data formats |\r\n| **401** | Salesforce | Unauthorized - Authentication failure | Refresh access token or check credentials |\r\n| **403** | Stripe | Forbidden - Invalid webhook signature | Verify webhook secret configuration |\r\n| **500** | Integration | Internal Server Error | Check integration flow configuration and retry |\r\n\r\n### Rate Limiting\r\n\r\n| System | Limit Type | Limit Value | Handling Strategy |\r\n|--------|------------|-------------|-------------------|\r\n| **Salesforce** | API Calls per Day | 15,000 (varies by license) | Implement retry logic with exponential backoff |\r\n| **Stripe** | Webhook Delivery | 100 attempts over 3 days | Ensure reliable endpoint response within 30 seconds |",
  "markdown_length": 18428,
  "constructed_query": "Create a complete SAP iFlow integration package named 'IFlow_530f55fb' with the following requirements from the documentation:\n\n# Stripe Subscription to Salesforce Opportunity Integration\r\n\r\n## Table of Contents\r\n\r\n1. [API Overview](#api-overview)\r\n2. [Endpoints](#endpoints)\r\n3. [Current Boomi Flow Logic](#current-boomi-flow-logic)\r\n   - [Process Flow Overview](#process-flow-overview)\r\n   - [Step-by-Step Flow Description](#step-by-step-flow-description)\r\n4. [Boomi Transformations Explained](#boomi-transformations-explained)\r\n5. [SAP Integration Suite Implementation](#sap-integration-suite-implementation)\r\n   - [Component Mapping](#component-mapping)\r\n   - [Integration Flow Visualization](#integration-flow-visualization)\r\n   - [Configuration Details](#configuration-details)\r\n6. [Environment Configuration](#environment-configuration)\r\n7. [API Reference](#api-reference)\r\n\r\n## API Overview\r\n\r\nThis integration creates Salesforce Opportunities from Stripe subscription events using Dell Boomi as the integration platform. The solution processes Stripe webhook notifications for subscription completions and transforms them into Salesforce Opportunity records, enabling seamless revenue tracking from payment processing to CRM.\r\n\r\n**Key Integration Capabilities:**\r\n- Real-time webhook processing from Stripe\r\n- Dynamic data enrichment and property calculation\r\n- Automated Salesforce Opportunity creation\r\n- Error handling and exception management\r\n\r\n**Business Purpose:**\r\nThe integration ensures that completed Stripe subscriptions are automatically converted into sales opportunities within Salesforce, providing visibility into revenue pipeline and customer acquisition metrics.\r\n\r\n**Authentication Mechanisms:**\r\n- Stripe: Webhook signature validation\r\n- Salesforce: OAuth 2.0 or Username/Password authentication\r\n\r\n**Data Flow Pattern:**\r\nEvent-driven integration triggered by Stripe webhook events, with synchronous processing and Salesforce API interaction.\r\n\r\n## Endpoints\r\n\r\n### Stripe Webhook Endpoint\r\n- **HTTP Method:** POST\r\n- **Purpose:** Receives subscription completion events from Stripe\r\n- **Trigger:*\n\nGenerate a production-ready iFlow with proper:\n1. Start and End events\n2. Required adapters and connectors\n3. Content modifiers and processing steps\n4. Proper sequence flows\n5. Error handling\n6. SAP Integration Suite compliance\n",
  "query_length": 2358,
  "markdown_truncated_at": 2000,
  "api_endpoint": "/api/generate-iflow-from-markdown",
  "request_time": "2025-10-22T21:47:02.167918"
}